import{r as m,a as ia,u as be,L as me,b as Yt,N as we,O as Ss,d as it,R as He,e as na,f as H,B as la}from"./vendor-DYwYEH-H.js";import{j as oa,a as Le}from"./utils-DvjEGWJZ.js";import{L as vt,W as ss,a as Dt,A as et,C as nt,b as ca,d as Ht,e as as,U as Se,M as Me,B as da,F as ae,D as tt,f as rs,g as Te,S as ma,h as Kt,i as Ce,c as Nt,j as xa,k as ne,l as ha,m as pa,n as ua,o as ks,p as Cs,X as oe,q as At,r as Fe,s as lt,t as ie,P as ot,E as _e,u as Pt,T as _s,v as ga,w as fa,x as Oe,y as ba,z as st,G as ya,R as ja,H as va,I as ct,J as Xt,K as Ds,N as dt,O as Na,Q as Lt,V as wa,Y as Sa,Z as ka,_ as Rt,$ as Ca,a0 as at,a1 as As,a2 as _a,a3 as is,a4 as Ps,a5 as Da,a6 as Aa,a7 as Pa}from"./ui-CGVCq_4f.js";import{R as qe,A as La,a as Ra,B as mt,C as xt,X as ht,Y as pt,T as ut,b as gt,c as ft}from"./charts-BxGJ9Z7x.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))a(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();var Ls={exports:{}},bt={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ea=m,Ma=Symbol.for("react.element"),Ta=Symbol.for("react.fragment"),za=Object.prototype.hasOwnProperty,Ia=Ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Fa={key:!0,ref:!0,__self:!0,__source:!0};function Rs(r,t,s){var a,l={},n=null,i=null;s!==void 0&&(n=""+s),t.key!==void 0&&(n=""+t.key),t.ref!==void 0&&(i=t.ref);for(a in t)za.call(t,a)&&!Fa.hasOwnProperty(a)&&(l[a]=t[a]);if(r&&r.defaultProps)for(a in t=r.defaultProps,t)l[a]===void 0&&(l[a]=t[a]);return{$$typeof:Ma,type:r,key:n,ref:i,props:l,_owner:Ia.current}}bt.Fragment=Ta;bt.jsx=Rs;bt.jsxs=Rs;Ls.exports=bt;var e=Ls.exports,Et={},ns=ia;Et.createRoot=ns.createRoot,Et.hydrateRoot=ns.hydrateRoot;const Es=m.createContext(void 0),Oa=({children:r})=>{const[t,s]=m.useState(null),[a,l]=m.useState(!0);m.useEffect(()=>{const o=localStorage.getItem("token"),h=localStorage.getItem("user");if(o&&h)try{oa(o);const p=JSON.parse(h);s(p)}catch{localStorage.removeItem("token"),localStorage.removeItem("user")}l(!1)},[]);const n=(o,h)=>{localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(h)),s(h)},i=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),s(null)};return e.jsx(Es.Provider,{value:{user:t,login:n,logout:i,isAuthenticated:!!t,isLoading:a},children:r})},De=()=>{const r=m.useContext(Es);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r},Ba=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"http://localhost:5000/api":"/api",O=Le.create({baseURL:Ba()});O.interceptors.request.use(r=>{const t=localStorage.getItem("token");return t&&(r.headers.Authorization=`Bearer ${t}`),r});O.interceptors.response.use(r=>r,r=>{const t=r.code==="ERR_NETWORK"||r.message==="Network Error",s=r.response&&(r.response.status===500||r.response.status===503),a=window.location.pathname==="/maintenance";return(t||s)&&!a&&(window.location.href="/maintenance"),Promise.reject(r)});const Ua=()=>{const[r,t]=m.useState(""),[s,a]=m.useState(""),[l,n]=m.useState(""),[i,o]=m.useState(null),[h,p]=m.useState(null),[x,c]=m.useState("CMS Publishing RuangMusik"),[f,k]=m.useState("checking"),[y,b]=m.useState("checking"),{login:j}=De(),g=be();m.useEffect(()=>{(async()=>{b("checking"),k("checking");try{const S=await O.get("/health");b("connected"),S.status===200&&S.data.status==="connected"?k("connected"):k("disconnected")}catch(S){S.response?(b("connected"),k("disconnected")):(b("disconnected"),k("disconnected"))}})(),(async()=>{try{const S=await O.get("/settings");if(S.data){const R="http://localhost:5000/api".replace("/api","");if(S.data.logo){const w=S.data.logo.replace(/\\/g,"/"),z=w.startsWith("http")?w:w.startsWith("uploads/")?`/${w}`:`/uploads/${w}`;o(z)}if(S.data.login_background){const w=S.data.login_background.replace(/\\/g,"/"),z=w.startsWith("http")?w:w.startsWith("uploads/")?`/${w}`:`/uploads/${w}`;p(z)}S.data.company_name&&c(S.data.company_name)}}catch(S){console.error("Failed to fetch settings:",S)}})()},[]);const[C,L]=m.useState({show:!1,status:"",detail:""}),v=async P=>{var d,S;P.preventDefault();try{const N=await O.post("/auth/login",{email:r,password:s});j(N.data.token,N.data.user),N.data.user.role==="admin"?g("/admin"):N.data.user.role==="user"&&N.data.user.status!=="accepted"?g("/status"):g("/user")}catch(N){n(((S=(d=N.response)==null?void 0:d.data)==null?void 0:S.message)||"Login failed")}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center relative bg-gray-50 overflow-hidden",children:[h&&e.jsx("div",{className:"absolute inset-0 z-0 bg-black",children:e.jsx("img",{src:h,alt:"Background",className:"w-full h-full object-cover opacity-60"})}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 z-20",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/80 backdrop-blur-sm shadow-sm border border-gray-200",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Backend:"}),y==="checking"&&e.jsx(vt,{size:14,className:"animate-spin text-blue-500"}),y==="connected"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(ss,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Online"})]}),y==="disconnected"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-500",children:[e.jsx(Dt,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Offline"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/80 backdrop-blur-sm shadow-sm border border-gray-200",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Database:"}),f==="checking"&&e.jsx(vt,{size:14,className:"animate-spin text-blue-500"}),f==="connected"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(ss,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Connected"})]}),f==="disconnected"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-500",children:[e.jsx(Dt,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Disconnected"})]})]})]}),C.show&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl p-6 w-96 max-w-[90%] transform transition-all scale-100",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:`p-4 rounded-full mb-4 ${C.status==="review"?"bg-yellow-100 text-yellow-600":C.status==="rejected"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:e.jsx(vt,{size:32,className:C.status==="review"?"animate-spin-slow":""})}),e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-2 capitalize",children:["Status: ",C.status]}),e.jsx("p",{className:"text-gray-500 mb-6",children:C.detail}),e.jsx("button",{onClick:()=>L({...C,show:!1}),className:"glass-button w-full",children:"Close"})]})})}),e.jsxs("div",{className:"glass-panel p-8 w-96 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[i&&e.jsx("img",{src:i,alt:"Logo",className:"h-24 mb-4 object-contain"}),e.jsx("h1",{className:"text-lg font-bold text-[#7A4A88] text-center mb-1",children:x}),e.jsx("h3",{className:"text-xs uppercase tracking-[0.2em] text-gray-400 font-semibold mb-2 mt-1",children:"System Publishing"}),e.jsx("h2",{className:"text-2xl font-bold text-center text-[#7A4A88]",children:"Login"})]}),l&&e.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4 text-sm",children:l}),e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",value:r,onChange:P=>t(P.target.value),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("input",{type:"password",value:s,onChange:P=>a(P.target.value),className:"mt-1 block glass-input",required:!0})]}),e.jsx("button",{type:"submit",className:"glass-button w-full",children:"Sign In"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:["Don't have an account? ",e.jsx(me,{to:"/register",className:"text-[#7A4A88] hover:text-purple-600",children:"Register"})]})]})]})},$a=()=>{const[r,t]=m.useState(1),[s,a]=m.useState({name:"",email:"",whatsapp:"",password:"",address:"",country:"",province:"",city:"",district:"",subdistrict:""}),[l,n]=m.useState([]),[i,o]=m.useState([]),[h,p]=m.useState([]),[x,c]=m.useState([]),[f,k]=m.useState([]),[y,b]=m.useState({province:"",city:"",district:"",subdistrict:""}),[j,g]=m.useState(""),[C,L]=m.useState(!1),[v,P]=m.useState(!1),[d,S]=m.useState({title:"",message:""}),N=be();m.useEffect(()=>{(async()=>{try{const _=(await Le.get("https://restcountries.com/v3.1/all?fields=name")).data.map(U=>U.name.common).sort((U,$)=>U.localeCompare($));n(_)}catch(F){console.error("Error fetching countries:",F),n(["Indonesia","Malaysia","Singapore","United States","United Kingdom"])}})()},[]),m.useEffect(()=>{s.country==="Indonesia"?(async()=>{try{const F=await Le.get("https://www.emsifa.com/api-wilayah-indonesia/api/provinces.json");o(F.data)}catch(F){console.error("Error fetching provinces:",F)}})():(o([]),p([]),c([]),k([]))},[s.country]),m.useEffect(()=>{y.province?(async()=>{try{const F=await Le.get(`https://www.emsifa.com/api-wilayah-indonesia/api/regencies/${y.province}.json`);p(F.data)}catch(F){console.error("Error fetching cities:",F)}})():p([])},[y.province]),m.useEffect(()=>{y.city?(async()=>{try{const F=await Le.get(`https://www.emsifa.com/api-wilayah-indonesia/api/districts/${y.city}.json`);c(F.data)}catch(F){console.error("Error fetching districts:",F)}})():c([])},[y.city]),m.useEffect(()=>{y.district?(async()=>{try{const F=await Le.get(`https://www.emsifa.com/api-wilayah-indonesia/api/villages/${y.district}.json`);k(F.data)}catch(F){console.error("Error fetching subdistricts:",F)}})():k([])},[y.district]);const R=D=>{const{name:F,value:_}=D.target;if(F==="country"&&_!=="Indonesia"){a(U=>({...U,country:_,province:"",city:"",district:"",subdistrict:""})),b({province:"",city:"",district:"",subdistrict:""});return}a({...s,[F]:_})},w=(D,F)=>{const _=F.target.value,U=F.target.selectedIndex,$=F.target.options[U].text;D==="province"?(b(E=>({...E,province:_,city:"",district:"",subdistrict:""})),a(E=>({...E,province:$,city:"",district:"",subdistrict:""})),p([]),c([]),k([])):D==="city"?(b(E=>({...E,city:_,district:"",subdistrict:""})),a(E=>({...E,city:$,district:"",subdistrict:""})),c([]),k([])):D==="district"?(b(E=>({...E,district:_,subdistrict:""})),a(E=>({...E,district:$,subdistrict:""})),k([])):D==="subdistrict"&&(b(E=>({...E,subdistrict:_})),a(E=>({...E,subdistrict:$})))},z=async D=>{if(D.preventDefault(),r===1){if(!s.name||!s.email||!s.whatsapp||!s.password){g("Please fill in all fields");return}L(!0),g("");try{const F=await O.post("/auth/check-availability",{email:s.email,whatsapp:s.whatsapp});if(F.data.available===!1){S({title:"Data Sudah Terdaftar",message:F.data.message}),P(!0),L(!1);return}t(2)}catch(F){console.error("Check availability error:",F),g("Gagal memverifikasi data. Silakan coba lagi.")}finally{L(!1)}}},B=async D=>{var F,_;if(D.preventDefault(),!s.address||!s.country||!s.province||!s.city){g("Please fill in all address fields");return}if(s.country==="Indonesia"&&(!s.district||!s.subdistrict)){g("Please fill in all address fields");return}L(!0),g("");try{await O.post("/auth/register",s),N("/login")}catch(U){g(((_=(F=U.response)==null?void 0:F.data)==null?void 0:_.message)||"Registration failed")}finally{L(!1)}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"glass-panel w-full max-w-2xl p-8 relative",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-[#7A4A88]",children:"Register"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Create your account to get started"})]}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-fadeIn",children:e.jsx("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden transform transition-all scale-100",children:e.jsxs("div",{className:"bg-red-50 p-6 flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(et,{className:"w-6 h-6 text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:d.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:d.message}),e.jsx("button",{onClick:()=>P(!1),className:"w-full py-2.5 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors",children:"Mengerti"})]})})}),e.jsxs("div",{className:"flex items-center justify-center mb-8",children:[e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full ${r>=1?"bg-purple-600 text-white":"bg-gray-200 text-gray-600"} font-semibold text-sm`,children:r>1?e.jsx(nt,{size:16}):"1"}),e.jsx("div",{className:`w-16 h-1 mx-2 rounded ${r>=2?"bg-purple-600":"bg-gray-200"}`}),e.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full ${r>=2?"bg-purple-600 text-white":"bg-gray-200 text-gray-600"} font-semibold text-sm`,children:"2"})]}),j&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 text-red-700 p-4 mb-6 text-sm rounded",children:j}),e.jsx("form",{onSubmit:r===1?z:B,className:"space-y-6",children:r===1?e.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{name:"name",type:"text",value:s.name,onChange:R,className:"glass-input w-full",placeholder:"Enter your full name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{name:"email",type:"email",value:s.email,onChange:R,className:"glass-input w-full",placeholder:"name@example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp Number"}),e.jsx("input",{name:"whatsapp",type:"text",value:s.whatsapp,onChange:R,className:"glass-input w-full",placeholder:"e.g. 08123456789",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),e.jsx("input",{name:"password",type:"password",value:s.password,onChange:R,className:"glass-input w-full",placeholder:"Create a strong password",required:!0})]}),e.jsx("button",{type:"submit",disabled:C,className:"glass-button w-full flex items-center justify-center gap-2 mt-6 disabled:opacity-70 disabled:cursor-not-allowed",children:C?"Checking...":e.jsxs(e.Fragment,{children:["Next Step ",e.jsx(ca,{size:18})]})})]}):e.jsxs("div",{className:"space-y-4 animate-fadeIn",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Address"}),e.jsx("textarea",{name:"address",value:s.address,onChange:R,className:"glass-input w-full min-h-[80px]",placeholder:"Street name, house number, etc.",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),e.jsxs("select",{name:"country",value:s.country,onChange:R,className:"glass-input w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select Country"}),l.map(D=>e.jsx("option",{value:D,children:D},D))]})]}),s.country==="Indonesia"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Province"}),e.jsxs("select",{name:"province",value:y.province,onChange:D=>w("province",D),className:"glass-input w-full",required:!0,children:[e.jsx("option",{value:"",children:"Select Province"}),i.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City/Regency"}),e.jsxs("select",{name:"city",value:y.city,onChange:D=>w("city",D),className:"glass-input w-full",required:!0,disabled:!y.province,children:[e.jsx("option",{value:"",children:"Select City"}),h.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"District"}),e.jsxs("select",{name:"district",value:y.district,onChange:D=>w("district",D),className:"glass-input w-full",required:!0,disabled:!y.city,children:[e.jsx("option",{value:"",children:"Select District"}),x.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sub-district"}),e.jsxs("select",{name:"subdistrict",value:y.subdistrict,onChange:D=>w("subdistrict",D),className:"glass-input w-full",required:!0,disabled:!y.district,children:[e.jsx("option",{value:"",children:"Select Village"}),f.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]})]})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Province"}),e.jsx("input",{name:"province",type:"text",value:s.province,onChange:R,className:"glass-input w-full",placeholder:"Province",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"City/Regency"}),e.jsx("input",{name:"city",type:"text",value:s.city,onChange:R,className:"glass-input w-full",placeholder:"City",required:!0})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsxs("button",{type:"button",onClick:()=>t(1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center gap-2 transition-colors",children:[e.jsx(Ht,{size:18})," Back"]}),e.jsx("button",{type:"submit",disabled:C,className:"glass-button flex-1 flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:C?"Creating Account...":"Sign Up"})]})]})}),e.jsxs("div",{className:"mt-6 text-center text-sm",children:["Already have an account? ",e.jsx(me,{to:"/login",className:"text-[#7A4A88] font-medium hover:text-purple-600 hover:underline",children:"Login here"})]})]})})},Ms=()=>{const{user:r}=De(),t=Yt(),[s,a]=m.useState(!0),[l,n]=m.useState(!1),[i,o]=m.useState("Mendy"),[h,p]=m.useState(null);m.useEffect(()=>{(async()=>{try{const y=await O.get("/settings");if(y.data&&(y.data.company_name&&o(y.data.company_name),y.data.logo)){const b=y.data.logo.replace(/\\/g,"/"),j=b.startsWith("http")?b:b.startsWith("uploads/")?`/${b}`:`/uploads/${b}`;p(j)}}catch(y){console.error("Failed to fetch settings",y)}})()},[]);const x=[{path:"/admin",label:"Dashboard",icon:as},{label:"Publishing",icon:da,isGroup:!0,isOpen:s,toggle:()=>a(!s),children:[{path:"/admin/creators",label:"Data Pencipta",icon:Se},{path:"/admin/songs",label:"Data Lagu",icon:Me}]},{label:"Data Report",icon:ae,isGroup:!0,isOpen:l,toggle:()=>n(!l),children:[{path:"/admin/analytics",label:"Analitik",icon:ae},{path:"/admin/reports",label:"Report",icon:ae},{path:"/admin/reports/import",label:"Import",icon:ae}]},{path:"/admin/payments",label:"Pembayaran",icon:tt},{path:"/admin/contracts",label:"Kontrak User",icon:rs},{path:"/admin/users",label:"User Management",icon:Te},{path:"/admin/settings",label:"Setting",icon:ma}],c=[{path:"/user",label:"Dashboard",icon:as},{label:"Lagu Saya",icon:Me,isGroup:!0,isOpen:s,toggle:()=>a(!s),children:[{path:"/user/creators",label:"Data Pencipta",icon:Se},{path:"/user/songs",label:"Data Lagu",icon:Me}]},{label:"Report Saya",icon:ae,isGroup:!0,isOpen:l,toggle:()=>n(!l),children:[{path:"/user/analytics",label:"Analitik",icon:ae},{path:"/user/reports",label:"Report Lagu",icon:ae},{path:"/user/payments",label:"Pembayaran",icon:tt}]},{path:"/user/contracts",label:"Kontrak",icon:rs},{path:"/user/account",label:"Akun Saya",icon:Se}],f=(r==null?void 0:r.role)==="admin"?x:c;return e.jsxs("div",{className:"w-64 bg-sidebar h-screen shadow-xl flex flex-col fixed overflow-y-auto z-20 text-gray-400 font-sans",children:[e.jsxs("div",{className:"p-6 flex items-center space-x-3 mb-2",children:[h?e.jsx("img",{src:h,alt:"Logo",className:"w-10 h-10 object-contain rounded-lg bg-white/10 p-1"}):e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-lg",children:i.charAt(0)}),e.jsx("h1",{className:"text-2xl font-bold text-white tracking-wide",children:i})]}),e.jsx("nav",{className:"flex-1 px-4 space-y-2",children:f.map(k=>{if(k.isGroup)return e.jsxs("div",{children:[e.jsxs("button",{onClick:k.toggle,className:"w-full flex items-center justify-between px-4 py-3 text-sm font-medium rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k.icon,{className:"w-5 h-5 mr-3"}),k.label]}),k.isOpen?e.jsx(Kt,{size:16}):e.jsx(Ce,{size:16})]}),k.isOpen&&e.jsx("div",{className:"mt-1 space-y-1",children:k.children.map(j=>{const g=t.pathname===j.path;return e.jsxs(me,{to:j.path,className:Nt("flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-all ml-4 border-l border-gray-700 pl-4",g?"text-white border-l-2 border-accent-pink pl-[15px]":"text-gray-500 hover:text-gray-300"),children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current mr-3 opacity-50"}),j.label]},j.path)})})]},k.label);const y=k.icon,b=t.pathname===k.path;return e.jsxs(me,{to:k.path,className:Nt("flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all relative overflow-hidden group",b?"text-white bg-sidebar-active":"text-gray-400 hover:text-white hover:bg-white/5"),children:[b&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-accent-pink rounded-r-full"}),e.jsx(y,{className:Nt("w-5 h-5 mr-3 transition-colors",b?"text-accent-pink":"group-hover:text-white")}),k.label]},k.path)})})]})},Ts=()=>{const{user:r,logout:t}=De(),[s,a]=m.useState("offline"),[l,n]=m.useState("offline");return m.useEffect(()=>{const i=async()=>{try{const h=await O.get("/health");h.status===200&&(a("online"),h.data.status==="connected"?n("online"):n("offline"))}catch{a("offline"),n("offline")}};i();const o=setInterval(i,3e4);return()=>clearInterval(o)},[]),e.jsxs("header",{className:"bg-white h-20 flex items-center justify-between px-8 ml-64 sticky top-0 z-50 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 lg:hidden",children:e.jsx(xa,{size:24})}),e.jsxs("div",{className:"relative hidden md:block",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search...",className:"pl-10 pr-4 py-2.5 rounded-full bg-gray-50 border border-gray-100 focus:outline-none focus:bg-white focus:ring-2 focus:ring-purple-100 text-sm w-64 transition-all"})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"hidden md:flex items-center gap-4 mr-4 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",title:"Server Status",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${s==="online"?"bg-green-500 animate-pulse shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500 animate-pulse shadow-[0_0_8px_rgba(239,68,68,0.6)]"}`}),e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center gap-1",children:[e.jsx(ha,{size:12}),"Server"]})]}),e.jsx("div",{className:"w-px h-3 bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",title:"Database Status",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${l==="online"?"bg-green-500 animate-pulse shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500 animate-pulse shadow-[0_0_8px_rgba(239,68,68,0.6)]"}`}),e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center gap-1",children:[e.jsx(pa,{size:12}),"DB"]})]})]}),e.jsxs("button",{className:"relative text-gray-400 hover:text-purple-600 transition-colors",children:[e.jsx(ua,{size:20}),e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border-2 border-white"})]}),e.jsxs("button",{className:"relative text-gray-400 hover:text-purple-600 transition-colors",children:[e.jsx(ks,{size:20}),e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border-2 border-white"})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200 mx-2"}),e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer group relative",children:[e.jsx("div",{className:"text-right hidden md:block",children:e.jsxs("p",{className:"text-sm font-semibold text-gray-700 group-hover:text-purple-700 transition-colors",children:["Hello, ",r==null?void 0:r.name]})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-purple-500 to-pink-500 p-0.5",children:e.jsx("div",{className:"w-full h-full rounded-full bg-white flex items-center justify-center overflow-hidden",children:e.jsx(Se,{size:20,className:"text-gray-600"})})}),e.jsx("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-100 py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right z-50",children:e.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-red-500 flex items-center",children:[e.jsx(Cs,{size:16,className:"mr-2"}),"Logout"]})})]})]})]})},Wa=({isOpen:r,onClose:t,content:s})=>r?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-lg shadow-2xl w-full max-w-lg p-6 border border-white/40 m-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-gray-200 pb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-[#7A4A88]",children:"Data Pembaruan Aplikasi"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-red-500 transition-colors",children:e.jsx(oe,{size:24})})]}),e.jsx("div",{className:"prose max-w-none text-gray-700 whitespace-pre-wrap max-h-[60vh] overflow-y-auto",children:s||"Tidak ada data pembaruan."}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-[#7A4A88] text-white rounded-md hover:bg-purple-700 transition-colors",children:"Tutup"})})]})}):null,zs=()=>{const[r,t]=m.useState("1.0.0"),[s,a]=m.useState(""),[l,n]=m.useState(!1);m.useEffect(()=>{fetch("/ver.txt").then(o=>o.text()).then(o=>t(o.trim())).catch(o=>console.error("Failed to load version",o)),fetch("/pembaruan.txt").then(o=>o.text()).then(o=>a(o)).catch(o=>console.error("Failed to load update content",o))},[]);const i=new Date().getFullYear();return e.jsxs(e.Fragment,{children:[e.jsx("footer",{className:"bg-white/30 backdrop-blur-md border-t border-white/20 py-4 px-6 ml-64 mt-auto",children:e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("span",{children:["Copyright © ",i," RuangMusik Publishing"]}),e.jsx("span",{children:"•"}),e.jsxs("button",{onClick:()=>n(!0),className:"hover:text-[#7A4A88] hover:underline font-medium transition-colors focus:outline-none",children:["Versi ",r]})]}),e.jsxs("div",{children:["Build By ",e.jsx("span",{className:"font-semibold text-[#7A4A88]",children:"Garuda Server"})]})]})}),e.jsx(Wa,{isOpen:l,onClose:()=>n(!1),content:s})]})},Ya=()=>{const{user:r,isLoading:t}=De();return t?e.jsx("div",{children:"Loading..."}):!r||r.role!=="admin"?e.jsx(we,{to:"/login",replace:!0}):e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ms,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative z-0",children:[e.jsx(Ts,{}),e.jsx("main",{className:"flex-1 p-6 ml-64 overflow-auto",children:e.jsx(Ss,{})}),e.jsx(zs,{})]})]})},Ha=()=>{const{user:r,isLoading:t}=De();return t?e.jsx("div",{children:"Loading..."}):r?r.role==="user"&&r.status&&r.status!=="accepted"?e.jsx(we,{to:"/status",replace:!0}):r.role==="admin"?e.jsx(we,{to:"/admin",replace:!0}):e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Ms,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative z-0",children:[e.jsx(Ts,{}),e.jsx("main",{className:"flex-1 p-6 ml-64 overflow-auto",children:e.jsx(Ss,{})}),e.jsx(zs,{})]})]}):e.jsx(we,{to:"/login",replace:!0})},wt=({title:r,value:t,icon:s,trend:a,trendUp:l,chartData:n,chartColor:i="#8884d8"})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 flex flex-col justify-between h-40 relative overflow-hidden group hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-1",children:r}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:t})]}),e.jsx("div",{className:"p-2 rounded-lg bg-gray-50 text-gray-600 group-hover:bg-purple-50 group-hover:text-purple-600 transition-colors",children:s})]}),e.jsx("div",{className:"flex justify-between items-end mt-4 z-10",children:a&&e.jsxs("div",{className:`flex items-center text-xs font-semibold ${l?"text-green-500":"text-red-500"}`,children:[l?"↑":"↓"," ",a,e.jsx("span",{className:"text-gray-400 ml-1 font-normal",children:"vs last month"})]})}),n&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 opacity-20",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsx(La,{data:n,children:e.jsx(Ra,{type:"monotone",dataKey:"value",stroke:i,fill:i,strokeWidth:2})})})})]}),Ka=()=>{var n;const[r,t]=m.useState(null);m.useEffect(()=>{(async()=>{try{const o=await O.get("/dashboard/stats");t(o.data)}catch(o){console.error(o)}})()},[]);const s=((n=r==null?void 0:r.monthlyData)==null?void 0:n.map(i=>({name:`${new Date(0,i.month-1).toLocaleString("default",{month:"short"})}`,revenue:i.revenue})))||[];if(!r)return e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading dashboard data..."});const a=i=>i==null||isNaN(i)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),l=["#7A4A88","#9B5DE5","#D689FF","#F15BB5","#00BBF9","#00F5D4","#8338EC","#3A86FF","#FF006E","#FB5607","#FFBE0B","#FFD166"];return e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard Overview"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Welcome back, here's what's happening today."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx(wt,{title:"Total Songs",value:r.totalSongs,icon:e.jsx(Me,{size:20}),trend:"Total Songs",trendUp:!0,chartData:[],chartColor:"#8884d8"}),e.jsx(wt,{title:"Lagu Pending",value:r.pendingSongs,icon:e.jsx(At,{size:20}),trend:"Pending Approval",trendUp:!0,chartData:[],chartColor:"#ffc658"}),e.jsx(wt,{title:"Lagu Diterima",value:r.approvedSongs,icon:e.jsx(Fe,{size:20}),trend:"Approved Songs",trendUp:!0,chartData:[],chartColor:"#82ca9d"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsxs("div",{className:"lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Monthly Revenue Analytics"})}),e.jsx("div",{className:"h-80",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(mt,{data:s,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx(xt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(ht,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},dy:10}),e.jsx(pt,{axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},tickFormatter:i=>`Rp ${(i/1e6).toFixed(1)}M`}),e.jsx(ut,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:i=>a(i)}),e.jsx(gt,{dataKey:"revenue",radius:[4,4,0,0],children:s.map((i,o)=>e.jsx(ft,{fill:l[o%l.length]},`cell-${o}`))})]})})})]})})]})},Xa=()=>{const{user:r}=De(),[t,s]=m.useState([]),[a,l]=m.useState(!0),[n,i]=m.useState(""),[o,h]=m.useState(1),[p,x]=m.useState(20),[c,f]=m.useState(null),[k,y]=m.useState(!1),[b,j]=m.useState(""),[g,C]=m.useState(""),[L,v]=m.useState(""),[P,d]=m.useState(!1),S=m.useRef(null);m.useEffect(()=>{N()},[]);const N=async()=>{try{const A=await O.get("/songs");Array.isArray(A.data)?s(A.data):A.data&&A.data.data&&s(A.data.data)}catch(A){console.error(A),A.response&&A.response.status===401&&alert("Session expired. Please login again.")}finally{l(!1)}},R=async()=>{var A;try{const u=await O.get("/songs/export",{responseType:"blob"}),T=window.URL.createObjectURL(new Blob([u.data])),I=document.createElement("a");I.href=T,I.setAttribute("download","songs.xlsx"),document.body.appendChild(I),I.click(),(A=I.parentNode)==null||A.removeChild(I)}catch(u){console.error("Export failed",u),alert("Failed to export data")}},w=()=>{var A;(A=S.current)==null||A.click()},z=async A=>{var I,W,K,Z,he;const u=(I=A.target.files)==null?void 0:I[0];if(!u)return;const T=new FormData;T.append("file",u);try{const ce=await O.post("/songs/import",T,{headers:{"Content-Type":"multipart/form-data"}});alert(ce.data.message),ce.data.errors&&(console.warn("Import errors:",ce.data.errors),alert("Some rows failed to import. Check console for details.")),N()}catch(ce){console.error("Import failed",ce);const jt=((K=(W=ce.response)==null?void 0:W.data)==null?void 0:K.message)||ce.message||"Failed to import data",Be=((he=(Z=ce.response)==null?void 0:Z.data)==null?void 0:he.error)||"";alert(`${jt}
${Be}`)}finally{S.current&&(S.current.value="")}},B=async A=>{if(confirm("Are you sure you want to delete this song?"))try{await O.delete(`/songs/${A}`),N()}catch(u){console.error(u)}},D=A=>{f(A),j(A.status||"pending"),C(A.song_id||""),v(A.rejection_reason||""),y(!0)},F=async()=>{if(b==="accepted"&&!g.trim()){alert("Custom ID (Identitas Lagu) wajib diisi jika status Diterima.");return}if(b==="rejected"&&!L.trim()){alert("Alasan penolakan wajib diisi jika status Ditolak.");return}d(!0);try{await O.put(`/songs/${c.id}`,{status:b,song_id:g,rejection_reason:L}),y(!1),N()}catch(A){console.error(A),alert("Failed to update song status")}finally{d(!1)}},_=t.filter(A=>{var u;return A.title.toLowerCase().includes(n.toLowerCase())||((u=A.song_id)==null?void 0:u.toLowerCase().includes(n.toLowerCase()))}),U=Math.ceil(_.length/p),$=(o-1)*p,E=_.slice($,$+p);return a?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Lagu"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:R,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:[e.jsx(lt,{size:20,className:"mr-2"}),"Export Excel"]}),e.jsxs("button",{onClick:w,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[e.jsx(ie,{size:20,className:"mr-2"}),"Import Excel"]}),e.jsx("input",{type:"file",ref:S,className:"hidden",accept:".xlsx, .xls",onChange:z}),e.jsxs(me,{to:"/admin/songs/create",className:"glass-button flex items-center",children:[e.jsx(ot,{size:20,className:"mr-2"}),"Tambah Lagu"]})]})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsxs("div",{className:"p-4 border-b border-white/30 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Search songs...",className:"glass-input pl-10 w-full",value:n,onChange:A=>{i(A.target.value),h(1)}}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),e.jsxs("select",{value:p,onChange:A=>{x(Number(A.target.value)),h(1)},className:"glass-input py-1 px-2 text-sm w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Song ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pencipta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:[E.map((A,u)=>e.jsxs("tr",{className:u%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A.song_id||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:A.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A.performer||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:A.writers&&A.writers.length>0?A.writers.map(T=>T.name).join(", "):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A.user_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full uppercase
                        ${(A.status||"pending")==="accepted"?"bg-green-100 text-green-800":(A.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(A.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-orange-100 text-orange-800"}`,children:A.status||"pending"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>D(A),className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"View Details",children:e.jsx(_e,{size:18})}),e.jsx(me,{to:`/admin/songs/edit/${A.id}`,className:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50 transition-colors",title:"Edit",children:e.jsx(Pt,{size:18})}),e.jsx("button",{onClick:()=>B(A.id),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50 transition-colors",title:"Delete",children:e.jsx(_s,{size:18})})]})})]},A.id)),E.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"No songs found"})})]})]})}),U>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-white/30 flex items-center justify-between bg-white/20",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:$+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min($+p,_.length)})," of ",e.jsx("span",{className:"font-medium",children:_.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>h(A=>Math.max(A-1,1)),disabled:o===1,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,U)},(A,u)=>{let T=u+1;return U>5&&(o>3&&(T=o-2+u),T>U&&(T=U-(4-u))),e.jsx("button",{onClick:()=>h(T),className:`px-3 py-1 border rounded-md ${o===T?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:T},T)}),e.jsx("button",{onClick:()=>h(A=>Math.min(A+1,U)),disabled:o===U,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),k&&c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detail Lagu"}),e.jsx("button",{onClick:()=>y(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(oe,{size:24})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Judul Lagu"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:c.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Artis / Performer"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:c.performer||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"User Pengupload"}),e.jsx("p",{className:"text-gray-700",children:c.user_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Status Saat Ini"}),e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full mt-1
                    ${(c.status||"pending")==="accepted"?"bg-green-100 text-green-800":(c.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(c.status||"pending")==="pending"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:c.status||"pending"})]}),c.status==="rejected"&&c.rejection_reason&&e.jsxs("div",{className:"col-span-1 md:col-span-2 bg-red-50 p-3 rounded-lg border border-red-100 mt-2",children:[e.jsxs("label",{className:"text-xs font-semibold text-red-800 uppercase flex items-center mb-1",children:[e.jsx(et,{size:14,className:"mr-1"}),"Alasan Penolakan"]}),e.jsx("p",{className:"text-red-900 text-sm",children:c.rejection_reason})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Custom ID (Identitas)"}),e.jsx("p",{className:"text-gray-900 font-mono",children:c.song_id||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"ISWC / ISRC"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ISWC: ",c.iswc||"-"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ISRC: ",c.isrc||"-"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-bold text-gray-800 mb-3 border-b pb-2",children:"Writers / Pencipta"}),e.jsx("div",{className:"bg-gray-50 rounded-lg overflow-hidden border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Nama"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Share (%)"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[c.writers&&c.writers.map((A,u)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:A.name}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:A.role||"-"}),e.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:[parseFloat(A.share_percent),"%"]})]},u)),(!c.writers||c.writers.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No writers data"})})]})]})})]}),(r==null?void 0:r.role)==="admin"&&e.jsxs("div",{className:"bg-purple-50 p-6 rounded-xl border border-purple-100 mt-6",children:[e.jsxs("div",{className:"mb-6 pb-6 border-b border-purple-200",children:[e.jsxs("h4",{className:"text-sm font-bold text-purple-800 mb-3 uppercase tracking-wide flex items-center",children:[e.jsx(ae,{size:16,className:"mr-2"}),"Generate Dokumen"]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>alert("Fitur Generate Kontrak akan segera hadir!"),className:"flex items-center px-3 py-2 bg-white text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 hover:border-purple-300 transition-all text-sm font-medium shadow-sm",title:"Generate Kontrak",children:[e.jsx(ae,{size:16,className:"mr-2"}),"Generate Kontrak"]}),e.jsxs("button",{onClick:()=>alert("Fitur Generate SKP akan segera hadir!"),className:"flex items-center px-3 py-2 bg-white text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 hover:border-purple-300 transition-all text-sm font-medium shadow-sm",title:"Generate SKP",children:[e.jsx(ga,{size:16,className:"mr-2"}),"Generate SKP"]}),e.jsxs("button",{onClick:()=>alert("Fitur Generate IPL akan segera hadir!"),className:"flex items-center px-3 py-2 bg-white text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 hover:border-purple-300 transition-all text-sm font-medium shadow-sm",title:"Generate IPL",children:[e.jsx(fa,{size:16,className:"mr-2"}),"Generate IPL"]})]})]}),e.jsxs("h3",{className:"text-md font-bold text-purple-800 mb-4 flex items-center",children:[e.jsx(Pt,{size:18,className:"mr-2"}),"Update Status (Admin/Operator)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:b,onChange:A=>j(A.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-2.5 border",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"review",children:"Review"}),e.jsx("option",{value:"accepted",children:"Diterima (Accepted)"}),e.jsx("option",{value:"rejected",children:"Ditolak (Rejected)"})]})]}),b==="accepted"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Custom ID ",e.jsx("span",{className:"text-red-500 ml-1",children:"*Required"})]}),e.jsx("input",{type:"text",value:g,onChange:A=>C(A.target.value),placeholder:"Masukkan Custom ID Lagu",className:`w-full rounded-lg shadow-sm p-2.5 border ${g?"border-gray-300 focus:border-purple-500 focus:ring-purple-500":"border-red-300 focus:border-red-500 focus:ring-red-500 bg-red-50"}`}),!g&&e.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[e.jsx(et,{size:12,className:"mr-1"}),"Wajib diisi saat status Diterima"]})]}),b==="rejected"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Alasan Penolakan ",e.jsx("span",{className:"text-red-500 ml-1",children:"*Required"})]}),e.jsx("textarea",{value:L,onChange:A=>v(A.target.value),placeholder:"Masukkan alasan penolakan...",rows:1,className:`w-full rounded-lg shadow-sm p-2.5 border ${L?"border-gray-300 focus:border-purple-500 focus:ring-purple-500":"border-red-300 focus:border-red-500 focus:ring-red-500 bg-red-50"}`}),!L&&e.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[e.jsx(et,{size:12,className:"mr-1"}),"Wajib diisi saat status Ditolak"]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:F,disabled:P||b==="accepted"&&!g||b==="rejected"&&!L,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Oe,{size:18,className:"mr-2"}),P?"Saving...":"Simpan Perubahan"]})})]})]})]})})]})},Ga=["Pop","Rock","Jazz","Blues","Hip Hop","R&B","Country","Folk","Classical","Electronic","Reggae","Soul","Funk","Disco","Techno","House","Trance","Dubstep","Metal","Punk","Indie","Alternative","Gospel","Latin","K-Pop","J-Pop","Dangdut","Keroncong","Campursari"].sort(),qa=["Indonesia","Malaysia","Singapore","Thailand","Vietnam","Philippines","United States","United Kingdom","Australia","Japan","South Korea","China","India","Canada","Germany","France","Italy","Spain","Netherlands","Brazil","Argentina","Mexico"].sort(),Ve=()=>{const r=be(),{id:t}=it(),[s,a]=m.useState(""),[l,n]=m.useState(""),[i,o]=m.useState(""),[h,p]=m.useState(""),[x,c]=m.useState(""),[f,k]=m.useState(""),[y,b]=m.useState(""),[j,g]=m.useState(""),[C,L]=m.useState(""),[v,P]=m.useState(""),[d,S]=m.useState(""),[N,R]=m.useState(null),[w]=m.useState({synchronization:!0,mechanical:!0,performing:!0,print_right:!0}),[z,B]=m.useState([{name:"",role:"Author & Composer",share_percent:0}]),[D,F]=m.useState([]),[_,U]=m.useState(!1),[$,E]=m.useState([]),[A,u]=m.useState(!1),[T,I]=m.useState(null),[W,K]=m.useState("");m.useEffect(()=>{he(),t&&Z(t)},[t]);const Z=async M=>{try{const G=(await O.get(`/songs/${M}`)).data;a(G.title),n(G.other_title||""),o(G.performer);const pe=parseInt(G.duration);if(p(Math.floor(pe/60).toString()),c((pe%60).toString()),k(G.genre),b(G.language),g(G.region),L(G.iswc||""),P(G.isrc||""),S(G.note||""),G.writers&&G.writers.length>0&&B(G.writers.map(ye=>({name:ye.name,role:ye.role||"Author & Composer",share_percent:parseFloat(ye.share_percent)}))),G.authorized_rights)try{typeof G.authorized_rights=="string"&&JSON.parse(G.authorized_rights)}catch(ye){console.error("Failed to parse rights",ye)}}catch(X){console.error("Failed to fetch song",X),alert("Failed to fetch song details")}},he=async()=>{try{const M=await O.get("/creators");Array.isArray(M.data)?F(M.data):M.data&&M.data.data&&F(M.data.data)}catch(M){console.error("Failed to fetch creators",M)}},ce=()=>{B([...z,{name:"",role:"Author & Composer",share_percent:0}])},jt=M=>{const X=z.filter((G,pe)=>pe!==M);B(X)},Be=(M,X,G)=>{const pe=[...z];pe[M]={...pe[M],[X]:G},B(pe)},Zs=M=>{I(M),K(""),u(!0)},ea=M=>{T!==null&&(Be(T,"name",M.name),u(!1),I(null))},Zt=D.filter(M=>M.name.toLowerCase().includes(W.toLowerCase())),ta=z.reduce((M,X)=>M+Number(X.share_percent||0),0),sa=async M=>{var es,ts;M.preventDefault();const X=[];s.trim()||X.push("Judul Lagu"),i.trim()||X.push("Artis / Performer"),f||X.push("Genre"),y||X.push("Bahasa/Negara"),j||X.push("Region"),!h&&!x&&X.push("Durasi");const G=z.reduce((Ae,ra)=>Ae+Number(ra.share_percent||0),0);if(G!==100&&X.push(`Total Share Penulis (Saat ini: ${G}%, Wajib: 100%)`),z.some(Ae=>!Ae.name.trim())&&X.push("Nama Penulis (Semua baris penulis wajib diisi)"),X.length>0){E(X),U(!0);return}const ye=parseInt(h||"0")*60+parseInt(x||"0"),aa=JSON.stringify(w),ee=new FormData;ee.append("title",s),ee.append("other_title",l),ee.append("performer",i),ee.append("duration",ye.toString()),ee.append("genre",f),ee.append("language",y),ee.append("region",j),ee.append("iswc",C),ee.append("isrc",v),ee.append("note",d),ee.append("authorized_rights",aa),ee.append("writers",JSON.stringify(z)),N&&ee.append("lyrics",N);try{t?await O.put(`/songs/${t}`,ee,{headers:{"Content-Type":"multipart/form-data"}}):await O.post("/songs",ee,{headers:{"Content-Type":"multipart/form-data"}}),r("/admin/songs")}catch(Ae){console.error(Ae),alert(((ts=(es=Ae.response)==null?void 0:es.data)==null?void 0:ts.message)||"Failed to create song")}};return e.jsxs("div",{className:"bg-white/60 backdrop-blur-md rounded-lg shadow-xl border border-white/40 min-h-[calc(100vh-2rem)]",children:[e.jsx("div",{className:"border-b border-white/30 px-6 py-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:t?"Edit Song":"Add New Song"})}),A&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"bg-purple-50 px-6 py-4 border-b border-purple-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-800 flex items-center",children:[e.jsx(Se,{className:"mr-2",size:20}),"Pilih Pencipta (Writer)"]}),e.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(oe,{size:20})})]}),e.jsx("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Cari nama pencipta...",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:W,onChange:M=>K(M.target.value),autoFocus:!0})]})}),e.jsx("div",{className:"max-h-[300px] overflow-y-auto p-2",children:Zt.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-1",children:Zt.map(M=>e.jsxs("button",{onClick:()=>ea(M),className:"flex items-center w-full px-4 py-3 text-left hover:bg-purple-50 rounded-lg transition-colors group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold mr-3 group-hover:bg-purple-200",children:M.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:M.name}),e.jsx("p",{className:"text-xs text-gray-500",children:M.role||"Writer"})]})]},M.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"Tidak ada pencipta ditemukan."})})})]})}),_&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"bg-red-50 px-6 py-4 border-b border-red-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-red-800 flex items-center",children:[e.jsx(ba,{className:"mr-2",size:20}),"Data Belum Lengkap"]}),e.jsx("button",{onClick:()=>U(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(oe,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-4",children:"Mohon lengkapi data berikut sebelum menyimpan:"}),e.jsx("ul",{className:"space-y-2",children:$.map((M,X)=>e.jsxs("li",{className:"flex items-start text-sm text-red-600 bg-red-50 p-2 rounded border border-red-100",children:[e.jsx("span",{className:"mr-2",children:"•"}),M]},X))})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-end",children:e.jsx("button",{onClick:()=>U(!1),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium",children:"Saya Mengerti"})})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:sa,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"glass-input",value:s,onChange:M=>a(M.target.value.toUpperCase()),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other title"}),e.jsx("input",{type:"text",className:"glass-input",value:l,onChange:M=>n(M.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Authorized Rights"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Synchronization"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Mechanical"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Performing"})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Print right"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Performer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"glass-input",value:i,onChange:M=>o(M.target.value.toUpperCase()),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Duration ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"number",placeholder:"Min",className:"glass-input pr-8",value:h,onChange:M=>p(M.target.value),min:"0",required:!0}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400 text-xs",children:"m"})]}),e.jsx("span",{className:"text-gray-400",children:":"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"number",placeholder:"Sec",className:"glass-input pr-8",value:x,onChange:M=>c(M.target.value),min:"0",max:"59",required:!0}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400 text-xs",children:"s"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Genre ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"glass-input",value:f,onChange:M=>k(M.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Genre"}),Ga.map(M=>e.jsx("option",{value:M,children:M},M))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Language ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"glass-input",value:y,onChange:M=>b(M.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Country/Language"}),qa.map(M=>e.jsx("option",{value:M,children:M},M))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Region ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"glass-input",value:j,onChange:M=>g(M.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Region"}),e.jsx("option",{value:"Global",children:"Global"}),e.jsx("option",{value:"Asia",children:"Asia"}),e.jsx("option",{value:"Europe",children:"Europe"}),e.jsx("option",{value:"America",children:"America"}),e.jsx("option",{value:"Oceania",children:"Oceania"}),e.jsx("option",{value:"Africa",children:"Africa"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ISWC"}),e.jsx("input",{type:"text",className:"glass-input",value:C,onChange:M=>L(M.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ISRC"}),e.jsx("input",{type:"text",className:"glass-input",value:v,onChange:M=>P(M.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note"}),e.jsx("textarea",{className:"glass-input",rows:4,value:d,onChange:M=>S(M.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lyrics & Chord (Doc, Docx, PDF, TXT)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 flex flex-col items-center justify-center bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer relative",children:[e.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:M=>{M.target.files&&M.target.files[0]&&R(M.target.files[0])},accept:".doc,.docx,.pdf,.txt"}),e.jsx("div",{className:"text-center",children:N?e.jsx("div",{className:"flex items-center text-purple-600",children:e.jsx("span",{className:"font-medium",children:N.name})}):e.jsxs("div",{className:"text-gray-500",children:[e.jsx("p",{className:"font-medium",children:"Click or drag file to upload"}),e.jsx("p",{className:"text-xs mt-1",children:"Supported formats: .doc, .docx, .pdf, .txt"})]})})]})]}),e.jsx("div",{className:"border border-white/40 rounded-md overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/2",children:"Writer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Share"}),e.jsx("th",{className:"px-6 py-3 text-right"})]})}),e.jsxs("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:[z.map((M,X)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{onClick:()=>Zs(X),className:"cursor-pointer relative",children:[e.jsx("input",{type:"text",placeholder:"Select Writer",className:"glass-input px-4 py-3 text-base w-full cursor-pointer bg-white/50 hover:bg-white/80 transition-colors",value:M.name,readOnly:!0,required:!0}),e.jsx(ne,{size:16,className:"absolute right-3 top-3.5 text-gray-400"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{className:"glass-input px-4 py-3 text-base w-full",value:M.role,onChange:G=>Be(X,"role",G.target.value),children:[e.jsx("option",{value:"Author & Composer",children:"Author & Composer"}),e.jsx("option",{value:"Author",children:"Author"}),e.jsx("option",{value:"Composer",children:"Composer"}),e.jsx("option",{value:"Arranger",children:"Arranger"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"glass-input w-20 px-3 py-3 text-base text-right",value:M.share_percent,onChange:G=>Be(X,"share_percent",parseFloat(G.target.value)||0)}),e.jsx("span",{className:"ml-2 text-base text-gray-500",children:"%"})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:z.length>1&&e.jsx("button",{type:"button",onClick:()=>jt(X),className:"text-red-400 hover:text-red-600 transition-colors",children:e.jsx(st,{size:18})})})]},X)),e.jsxs("tr",{className:"bg-purple-50/50 font-semibold",children:[e.jsx("td",{colSpan:2,className:"px-6 py-3 text-right",children:"Share Total"}),e.jsxs("td",{className:"px-6 py-3 text-right pr-12 text-[#7A4A88]",children:[ta,"%"]}),e.jsx("td",{})]})]})]})}),e.jsx("datalist",{id:"creators-list",children:D.map(M=>e.jsx("option",{value:M.name},M.id))}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:ce,className:"glass-button bg-gray-500/50 hover:bg-gray-600/50 text-white text-sm",children:"+ Add Other Writer"})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",className:"glass-button",children:"Save"})})]})})]})},Va=({isOpen:r,onClose:t,creator:s})=>{const[a,l]=m.useState([]),[n,i]=m.useState(!1),[o,h]=m.useState(""),[p,x]=m.useState(1),c=10;m.useEffect(()=>{r&&s?(f(),h(""),x(1)):l([])},[r,s]);const f=async()=>{i(!0);try{const g=await O.get(`/songs?writer_name=${encodeURIComponent(s.name)}`);l(g.data)}catch(g){console.error("Failed to fetch songs",g)}finally{i(!1)}},k=a.filter(g=>g.title.toLowerCase().includes(o.toLowerCase())||g.performer&&g.performer.toLowerCase().includes(o.toLowerCase())),y=Math.ceil(k.length/c),b=(p-1)*c,j=k.slice(b,b+c);return!r||!s?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detail Data Pencipta"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-red-500",children:e.jsx(oe,{size:24})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-4 border-b pb-2",children:"Informasi Pribadi"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Nama"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.name]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"NIK"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.nik||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Tgl Lahir"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.birth_date?new Date(s.birth_date).toLocaleDateString("id-ID"):"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Tempat Lahir"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.birth_place||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Alamat"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.address||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Agama"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.religion||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Pekerjaan"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.occupation||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Kewarganegaraan"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.nationality||"-"]})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 mt-6 mb-4 border-b pb-2",children:"Informasi Bank"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Nama Bank"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.bank_name||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"No. Rekening"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.bank_account_number||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Nama Pemilik"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",s.bank_account_name||"-"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-4 border-b pb-2",children:"Dokumen"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-gray-600",children:"KTP"}),s.ktp_path?e.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50",children:e.jsx("img",{src:`http://localhost:5000/${s.ktp_path}`,alt:"KTP",className:"w-full h-auto object-contain max-h-64"})}):e.jsx("div",{className:"h-32 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400 text-sm",children:"Tidak ada gambar KTP"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-gray-600",children:"NPWP"}),s.npwp_path?e.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50",children:e.jsx("img",{src:`http://localhost:5000/${s.npwp_path}`,alt:"NPWP",className:"w-full h-auto object-contain max-h-64"})}):e.jsx("div",{className:"h-32 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400 text-sm",children:"Tidak ada gambar NPWP"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsxs("h3",{className:"font-semibold text-gray-700",children:["Daftar Lagu (",a.length,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari lagu...",className:"pl-8 pr-3 py-1.5 text-sm border rounded-md focus:ring-purple-500 focus:border-purple-500",value:o,onChange:g=>{h(g.target.value),x(1)}}),e.jsx(ne,{className:"absolute left-2.5 top-2 text-gray-400",size:14})]})]}),n?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Memuat lagu..."}):k.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto border rounded-lg mb-3",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Judul"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Artis"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Genre"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map(g=>{var L,v;const C=(v=(L=g.writers)==null?void 0:L.find(P=>P.name===s.name))==null?void 0:v.share_percent;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:g.title}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:g.performer}),e.jsxs("td",{className:"px-4 py-2 text-sm text-gray-500",children:[g.genre,C&&e.jsxs("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800",children:[C,"%"]})]}),e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold uppercase
                                                    ${g.status==="accepted"?"bg-green-100 text-green-800":g.status==="rejected"?"bg-red-100 text-red-800":g.status==="review"?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:g.status||"Pending"})})]},g.id)})})]})}),y>1&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"text-gray-500",children:["Showing ",b+1," to ",Math.min(b+c,k.length)," of ",k.length," entries"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>x(g=>Math.max(g-1,1)),disabled:p===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:y},(g,C)=>C+1).map(g=>e.jsx("button",{onClick:()=>x(g),className:`px-3 py-1 border rounded ${p===g?"bg-purple-600 text-white border-purple-600":"hover:bg-gray-50"}`,children:g},g)),e.jsx("button",{onClick:()=>x(g=>Math.min(g+1,y)),disabled:p===y,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}):e.jsx("div",{className:"text-center py-4 text-gray-500 bg-gray-50 rounded-lg border border-dashed",children:a.length>0?"Tidak ada lagu yang cocok dengan pencarian.":"Tidak ada lagu yang ditemukan untuk pencipta ini."})]})]}),e.jsx("div",{className:"p-6 border-t bg-gray-50 flex justify-end",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 font-medium",children:"Tutup"})})]})})},Ja=()=>{const[r,t]=m.useState([]),[s,a]=m.useState(""),[l,n]=m.useState(null),[i,o]=m.useState(!1),h=m.useRef(null);m.useEffect(()=>{p()},[]);const p=async()=>{try{const j=await O.get("/creators");Array.isArray(j.data)?t(j.data):j.data&&j.data.data&&t(j.data.data)}catch(j){console.error(j),j.response&&j.response.status===401&&alert("Session expired. Please login again.")}},x=async()=>{var j;try{const g=await O.get("/creators/export",{responseType:"blob"}),C=window.URL.createObjectURL(new Blob([g.data])),L=document.createElement("a");L.href=C,L.setAttribute("download","creators.xlsx"),document.body.appendChild(L),L.click(),(j=L.parentNode)==null||j.removeChild(L)}catch(g){console.error("Export failed",g),alert("Failed to export data")}},c=()=>{var j;(j=h.current)==null||j.click()},f=async j=>{var L;const g=(L=j.target.files)==null?void 0:L[0];if(!g)return;const C=new FormData;C.append("file",g);try{const v=await O.post("/creators/import",C,{headers:{"Content-Type":"multipart/form-data"}});alert(v.data.message),v.data.errors&&(console.warn("Import errors:",v.data.errors),alert("Some rows failed to import. Check console for details.")),p()}catch(v){console.error("Import failed",v),alert("Failed to import data")}finally{h.current&&(h.current.value="")}},k=j=>{n(j),o(!0)},y=async j=>{if(confirm("Are you sure you want to delete this creator?"))try{await O.delete(`/creators/${j}`),p()}catch(g){console.error("Failed to delete creator",g),alert("Failed to delete creator")}},b=r.filter(j=>j.name.toLowerCase().includes(s.toLowerCase())||j.nik&&j.nik.includes(s));return e.jsxs("div",{children:[e.jsx(Va,{isOpen:i,onClose:()=>o(!1),creator:l}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Pencipta"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:x,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:[e.jsx(lt,{size:20,className:"mr-2"}),"Export Excel"]}),e.jsxs("button",{onClick:c,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[e.jsx(ie,{size:20,className:"mr-2"}),"Import Excel"]}),e.jsx("input",{type:"file",ref:h,className:"hidden",accept:".xlsx, .xls",onChange:f}),e.jsxs(me,{to:"/admin/creators/add",className:"glass-button flex items-center",children:[e.jsx(ot,{size:20,className:"mr-2"}),"Add Pencipta"]})]})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"p-4 border-b border-white/30",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari nama atau NIK...",className:"glass-input pl-10",value:s,onChange:j=>a(j.target.value)}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Pemilik"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NIK"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tgl Lahir"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alamat"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:[b.map((j,g)=>e.jsxs("tr",{className:g%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:j.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.user_name?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:j.user_name}):e.jsx("span",{className:"text-gray-400 italic",children:"Unassigned"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.nik||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:j.birth_date?new Date(j.birth_date).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:j.address||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>k(j),className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"Lihat Data",children:e.jsx(_e,{size:18})}),e.jsx(me,{to:`/admin/creators/edit/${j.id}`,className:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50 transition-colors",title:"Edit Data",children:e.jsx(Pt,{size:18})}),e.jsx("button",{onClick:()=>y(j.id),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50 transition-colors",title:"Delete Data",children:e.jsx(_s,{size:18})})]})})]},j.id)),b.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No creators found"})})]})]})})]})]})};/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */function ls(r,t){var s=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);t&&(a=a.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),s.push.apply(s,a)}return s}function Is(r){for(var t=1;t<arguments.length;t++){var s=arguments[t]!=null?arguments[t]:{};t%2?ls(Object(s),!0).forEach(function(a){tr(r,a,s[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(s)):ls(Object(s)).forEach(function(a){Object.defineProperty(r,a,Object.getOwnPropertyDescriptor(s,a))})}return r}function Qa(r,t){if(typeof r!="object"||!r)return r;var s=r[Symbol.toPrimitive];if(s!==void 0){var a=s.call(r,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Fs(r){var t=Qa(r,"string");return typeof t=="symbol"?t:t+""}function Mt(r){"@babel/helpers - typeof";return Mt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mt(r)}function Za(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function os(r,t){for(var s=0;s<t.length;s++){var a=t[s];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(r,Fs(a.key),a)}}function er(r,t,s){return t&&os(r.prototype,t),s&&os(r,s),Object.defineProperty(r,"prototype",{writable:!1}),r}function tr(r,t,s){return t=Fs(t),t in r?Object.defineProperty(r,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[t]=s,r}function Os(r){return sr(r)||ar(r)||rr(r)||ir()}function sr(r){if(Array.isArray(r))return Tt(r)}function ar(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function rr(r,t){if(r){if(typeof r=="string")return Tt(r,t);var s=Object.prototype.toString.call(r).slice(8,-1);if(s==="Object"&&r.constructor&&(s=r.constructor.name),s==="Map"||s==="Set")return Array.from(r);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return Tt(r,t)}}function Tt(r,t){(t==null||t>r.length)&&(t=r.length);for(var s=0,a=new Array(t);s<t;s++)a[s]=r[s];return a}function ir(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var yt=typeof window<"u"&&typeof window.document<"u",xe=yt?window:{},Gt=yt&&xe.document.documentElement?"ontouchstart"in xe.document.documentElement:!1,qt=yt?"PointerEvent"in xe:!1,q="cropper",Vt="all",Bs="crop",Us="move",$s="zoom",je="e",ve="w",Pe="s",ue="n",Ue="ne",$e="nw",We="se",Ye="sw",zt="".concat(q,"-crop"),cs="".concat(q,"-disabled"),se="".concat(q,"-hidden"),ds="".concat(q,"-hide"),nr="".concat(q,"-invisible"),rt="".concat(q,"-modal"),It="".concat(q,"-move"),Xe="".concat(q,"Action"),Je="".concat(q,"Preview"),Jt="crop",Ws="move",Ys="none",Ft="crop",Ot="cropend",Bt="cropmove",Ut="cropstart",ms="dblclick",lr=Gt?"touchstart":"mousedown",or=Gt?"touchmove":"mousemove",cr=Gt?"touchend touchcancel":"mouseup",xs=qt?"pointerdown":lr,hs=qt?"pointermove":or,ps=qt?"pointerup pointercancel":cr,us="ready",gs="resize",fs="wheel",$t="zoom",bs="image/jpeg",dr=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,mr=/^data:/,xr=/^data:image\/jpeg;base64,/,hr=/^img|canvas$/i,Hs=200,Ks=100,ys={viewMode:0,dragMode:Jt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Hs,minContainerHeight:Ks,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},pr='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',ur=Number.isNaN||xe.isNaN;function Y(r){return typeof r=="number"&&!ur(r)}var js=function(t){return t>0&&t<1/0};function St(r){return typeof r>"u"}function ke(r){return Mt(r)==="object"&&r!==null}var gr=Object.prototype.hasOwnProperty;function Re(r){if(!ke(r))return!1;try{var t=r.constructor,s=t.prototype;return t&&s&&gr.call(s,"isPrototypeOf")}catch{return!1}}function te(r){return typeof r=="function"}var fr=Array.prototype.slice;function Xs(r){return Array.from?Array.from(r):fr.call(r)}function J(r,t){return r&&te(t)&&(Array.isArray(r)||Y(r.length)?Xs(r).forEach(function(s,a){t.call(r,s,a,r)}):ke(r)&&Object.keys(r).forEach(function(s){t.call(r,r[s],s,r)})),r}var V=Object.assign||function(t){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return ke(t)&&a.length>0&&a.forEach(function(n){ke(n)&&Object.keys(n).forEach(function(i){t[i]=n[i]})}),t},br=/\.\d*(?:0|9){12}\d*$/;function ze(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return br.test(r)?Math.round(r*t)/t:r}var yr=/^width|height|left|top|marginLeft|marginTop$/;function ge(r,t){var s=r.style;J(t,function(a,l){yr.test(l)&&Y(a)&&(a="".concat(a,"px")),s[l]=a})}function jr(r,t){return r.classList?r.classList.contains(t):r.className.indexOf(t)>-1}function Q(r,t){if(t){if(Y(r.length)){J(r,function(a){Q(a,t)});return}if(r.classList){r.classList.add(t);return}var s=r.className.trim();s?s.indexOf(t)<0&&(r.className="".concat(s," ").concat(t)):r.className=t}}function de(r,t){if(t){if(Y(r.length)){J(r,function(s){de(s,t)});return}if(r.classList){r.classList.remove(t);return}r.className.indexOf(t)>=0&&(r.className=r.className.replace(t,""))}}function Ee(r,t,s){if(t){if(Y(r.length)){J(r,function(a){Ee(a,t,s)});return}s?Q(r,t):de(r,t)}}var vr=/([a-z\d])([A-Z])/g;function Qt(r){return r.replace(vr,"$1-$2").toLowerCase()}function Wt(r,t){return ke(r[t])?r[t]:r.dataset?r.dataset[t]:r.getAttribute("data-".concat(Qt(t)))}function Ge(r,t,s){ke(s)?r[t]=s:r.dataset?r.dataset[t]=s:r.setAttribute("data-".concat(Qt(t)),s)}function Nr(r,t){if(ke(r[t]))try{delete r[t]}catch{r[t]=void 0}else if(r.dataset)try{delete r.dataset[t]}catch{r.dataset[t]=void 0}else r.removeAttribute("data-".concat(Qt(t)))}var Gs=/\s\s*/,qs=function(){var r=!1;if(yt){var t=!1,s=function(){},a=Object.defineProperty({},"once",{get:function(){return r=!0,t},set:function(n){t=n}});xe.addEventListener("test",s,a),xe.removeEventListener("test",s,a)}return r}();function le(r,t,s){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=s;t.trim().split(Gs).forEach(function(n){if(!qs){var i=r.listeners;i&&i[n]&&i[n][s]&&(l=i[n][s],delete i[n][s],Object.keys(i[n]).length===0&&delete i[n],Object.keys(i).length===0&&delete r.listeners)}r.removeEventListener(n,l,a)})}function re(r,t,s){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=s;t.trim().split(Gs).forEach(function(n){if(a.once&&!qs){var i=r.listeners,o=i===void 0?{}:i;l=function(){delete o[n][s],r.removeEventListener(n,l,a);for(var p=arguments.length,x=new Array(p),c=0;c<p;c++)x[c]=arguments[c];s.apply(r,x)},o[n]||(o[n]={}),o[n][s]&&r.removeEventListener(n,o[n][s],a),o[n][s]=l,r.listeners=o}r.addEventListener(n,l,a)})}function Ie(r,t,s){var a;return te(Event)&&te(CustomEvent)?a=new CustomEvent(t,{detail:s,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(t,!0,!0,s)),r.dispatchEvent(a)}function Vs(r){var t=r.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var kt=xe.location,wr=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function vs(r){var t=r.match(wr);return t!==null&&(t[1]!==kt.protocol||t[2]!==kt.hostname||t[3]!==kt.port)}function Ns(r){var t="timestamp=".concat(new Date().getTime());return r+(r.indexOf("?")===-1?"?":"&")+t}function Ke(r){var t=r.rotate,s=r.scaleX,a=r.scaleY,l=r.translateX,n=r.translateY,i=[];Y(l)&&l!==0&&i.push("translateX(".concat(l,"px)")),Y(n)&&n!==0&&i.push("translateY(".concat(n,"px)")),Y(t)&&t!==0&&i.push("rotate(".concat(t,"deg)")),Y(s)&&s!==1&&i.push("scaleX(".concat(s,")")),Y(a)&&a!==1&&i.push("scaleY(".concat(a,")"));var o=i.length?i.join(" "):"none";return{WebkitTransform:o,msTransform:o,transform:o}}function Sr(r){var t=Is({},r),s=0;return J(r,function(a,l){delete t[l],J(t,function(n){var i=Math.abs(a.startX-n.startX),o=Math.abs(a.startY-n.startY),h=Math.abs(a.endX-n.endX),p=Math.abs(a.endY-n.endY),x=Math.sqrt(i*i+o*o),c=Math.sqrt(h*h+p*p),f=(c-x)/x;Math.abs(f)>Math.abs(s)&&(s=f)})}),s}function Qe(r,t){var s=r.pageX,a=r.pageY,l={endX:s,endY:a};return t?l:Is({startX:s,startY:a},l)}function kr(r){var t=0,s=0,a=0;return J(r,function(l){var n=l.startX,i=l.startY;t+=n,s+=i,a+=1}),t/=a,s/=a,{pageX:t,pageY:s}}function fe(r){var t=r.aspectRatio,s=r.height,a=r.width,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",n=js(a),i=js(s);if(n&&i){var o=s*t;l==="contain"&&o>a||l==="cover"&&o<a?s=a/t:a=s*t}else n?s=a/t:i&&(a=s*t);return{width:a,height:s}}function Cr(r){var t=r.width,s=r.height,a=r.degree;if(a=Math.abs(a)%180,a===90)return{width:s,height:t};var l=a%90*Math.PI/180,n=Math.sin(l),i=Math.cos(l),o=t*i+s*n,h=t*n+s*i;return a>90?{width:h,height:o}:{width:o,height:h}}function _r(r,t,s,a){var l=t.aspectRatio,n=t.naturalWidth,i=t.naturalHeight,o=t.rotate,h=o===void 0?0:o,p=t.scaleX,x=p===void 0?1:p,c=t.scaleY,f=c===void 0?1:c,k=s.aspectRatio,y=s.naturalWidth,b=s.naturalHeight,j=a.fillColor,g=j===void 0?"transparent":j,C=a.imageSmoothingEnabled,L=C===void 0?!0:C,v=a.imageSmoothingQuality,P=v===void 0?"low":v,d=a.maxWidth,S=d===void 0?1/0:d,N=a.maxHeight,R=N===void 0?1/0:N,w=a.minWidth,z=w===void 0?0:w,B=a.minHeight,D=B===void 0?0:B,F=document.createElement("canvas"),_=F.getContext("2d"),U=fe({aspectRatio:k,width:S,height:R}),$=fe({aspectRatio:k,width:z,height:D},"cover"),E=Math.min(U.width,Math.max($.width,y)),A=Math.min(U.height,Math.max($.height,b)),u=fe({aspectRatio:l,width:S,height:R}),T=fe({aspectRatio:l,width:z,height:D},"cover"),I=Math.min(u.width,Math.max(T.width,n)),W=Math.min(u.height,Math.max(T.height,i)),K=[-I/2,-W/2,I,W];return F.width=ze(E),F.height=ze(A),_.fillStyle=g,_.fillRect(0,0,E,A),_.save(),_.translate(E/2,A/2),_.rotate(h*Math.PI/180),_.scale(x,f),_.imageSmoothingEnabled=L,_.imageSmoothingQuality=P,_.drawImage.apply(_,[r].concat(Os(K.map(function(Z){return Math.floor(ze(Z))})))),_.restore(),F}var Js=String.fromCharCode;function Dr(r,t,s){var a="";s+=t;for(var l=t;l<s;l+=1)a+=Js(r.getUint8(l));return a}var Ar=/^data:.*,/;function Pr(r){var t=r.replace(Ar,""),s=atob(t),a=new ArrayBuffer(s.length),l=new Uint8Array(a);return J(l,function(n,i){l[i]=s.charCodeAt(i)}),a}function Lr(r,t){for(var s=[],a=8192,l=new Uint8Array(r);l.length>0;)s.push(Js.apply(null,Xs(l.subarray(0,a)))),l=l.subarray(a);return"data:".concat(t,";base64,").concat(btoa(s.join("")))}function Rr(r){var t=new DataView(r),s;try{var a,l,n;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(var i=t.byteLength,o=2;o+1<i;){if(t.getUint8(o)===255&&t.getUint8(o+1)===225){l=o;break}o+=1}if(l){var h=l+4,p=l+10;if(Dr(t,h,4)==="Exif"){var x=t.getUint16(p);if(a=x===18761,(a||x===19789)&&t.getUint16(p+2,a)===42){var c=t.getUint32(p+4,a);c>=8&&(n=p+c)}}}if(n){var f=t.getUint16(n,a),k,y;for(y=0;y<f;y+=1)if(k=n+y*12+2,t.getUint16(k,a)===274){k+=8,s=t.getUint16(k,a),t.setUint16(k,1,a);break}}}catch{s=1}return s}function Er(r){var t=0,s=1,a=1;switch(r){case 2:s=-1;break;case 3:t=-180;break;case 4:a=-1;break;case 5:t=90,a=-1;break;case 6:t=90;break;case 7:t=90,s=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:s,scaleY:a}}var Mr={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,s=this.options,a=this.container,l=this.cropper,n=Number(s.minContainerWidth),i=Number(s.minContainerHeight);Q(l,se),de(t,se);var o={width:Math.max(a.offsetWidth,n>=0?n:Hs),height:Math.max(a.offsetHeight,i>=0?i:Ks)};this.containerData=o,ge(l,{width:o.width,height:o.height}),Q(t,se),de(l,se)},initCanvas:function(){var t=this.containerData,s=this.imageData,a=this.options.viewMode,l=Math.abs(s.rotate)%180===90,n=l?s.naturalHeight:s.naturalWidth,i=l?s.naturalWidth:s.naturalHeight,o=n/i,h=t.width,p=t.height;t.height*o>t.width?a===3?h=t.height*o:p=t.width/o:a===3?p=t.width/o:h=t.height*o;var x={aspectRatio:o,naturalWidth:n,naturalHeight:i,width:h,height:p};this.canvasData=x,this.limited=a===1||a===2,this.limitCanvas(!0,!0),x.width=Math.min(Math.max(x.width,x.minWidth),x.maxWidth),x.height=Math.min(Math.max(x.height,x.minHeight),x.maxHeight),x.left=(t.width-x.width)/2,x.top=(t.height-x.height)/2,x.oldLeft=x.left,x.oldTop=x.top,this.initialCanvasData=V({},x)},limitCanvas:function(t,s){var a=this.options,l=this.containerData,n=this.canvasData,i=this.cropBoxData,o=a.viewMode,h=n.aspectRatio,p=this.cropped&&i;if(t){var x=Number(a.minCanvasWidth)||0,c=Number(a.minCanvasHeight)||0;o>1?(x=Math.max(x,l.width),c=Math.max(c,l.height),o===3&&(c*h>x?x=c*h:c=x/h)):o>0&&(x?x=Math.max(x,p?i.width:0):c?c=Math.max(c,p?i.height:0):p&&(x=i.width,c=i.height,c*h>x?x=c*h:c=x/h));var f=fe({aspectRatio:h,width:x,height:c});x=f.width,c=f.height,n.minWidth=x,n.minHeight=c,n.maxWidth=1/0,n.maxHeight=1/0}if(s)if(o>(p?0:1)){var k=l.width-n.width,y=l.height-n.height;n.minLeft=Math.min(0,k),n.minTop=Math.min(0,y),n.maxLeft=Math.max(0,k),n.maxTop=Math.max(0,y),p&&this.limited&&(n.minLeft=Math.min(i.left,i.left+(i.width-n.width)),n.minTop=Math.min(i.top,i.top+(i.height-n.height)),n.maxLeft=i.left,n.maxTop=i.top,o===2&&(n.width>=l.width&&(n.minLeft=Math.min(0,k),n.maxLeft=Math.max(0,k)),n.height>=l.height&&(n.minTop=Math.min(0,y),n.maxTop=Math.max(0,y))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=l.width,n.maxTop=l.height},renderCanvas:function(t,s){var a=this.canvasData,l=this.imageData;if(s){var n=Cr({width:l.naturalWidth*Math.abs(l.scaleX||1),height:l.naturalHeight*Math.abs(l.scaleY||1),degree:l.rotate||0}),i=n.width,o=n.height,h=a.width*(i/a.naturalWidth),p=a.height*(o/a.naturalHeight);a.left-=(h-a.width)/2,a.top-=(p-a.height)/2,a.width=h,a.height=p,a.aspectRatio=i/o,a.naturalWidth=i,a.naturalHeight=o,this.limitCanvas(!0,!1)}(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,ge(this.canvas,V({width:a.width,height:a.height},Ke({translateX:a.left,translateY:a.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var s=this.canvasData,a=this.imageData,l=a.naturalWidth*(s.width/s.naturalWidth),n=a.naturalHeight*(s.height/s.naturalHeight);V(a,{width:l,height:n,left:(s.width-l)/2,top:(s.height-n)/2}),ge(this.image,V({width:a.width,height:a.height},Ke(V({translateX:a.left,translateY:a.top},a)))),t&&this.output()},initCropBox:function(){var t=this.options,s=this.canvasData,a=t.aspectRatio||t.initialAspectRatio,l=Number(t.autoCropArea)||.8,n={width:s.width,height:s.height};a&&(s.height*a>s.width?n.height=n.width/a:n.width=n.height*a),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*l),n.height=Math.max(n.minHeight,n.height*l),n.left=s.left+(s.width-n.width)/2,n.top=s.top+(s.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=V({},n)},limitCropBox:function(t,s){var a=this.options,l=this.containerData,n=this.canvasData,i=this.cropBoxData,o=this.limited,h=a.aspectRatio;if(t){var p=Number(a.minCropBoxWidth)||0,x=Number(a.minCropBoxHeight)||0,c=o?Math.min(l.width,n.width,n.width+n.left,l.width-n.left):l.width,f=o?Math.min(l.height,n.height,n.height+n.top,l.height-n.top):l.height;p=Math.min(p,l.width),x=Math.min(x,l.height),h&&(p&&x?x*h>p?x=p/h:p=x*h:p?x=p/h:x&&(p=x*h),f*h>c?f=c/h:c=f*h),i.minWidth=Math.min(p,c),i.minHeight=Math.min(x,f),i.maxWidth=c,i.maxHeight=f}s&&(o?(i.minLeft=Math.max(0,n.left),i.minTop=Math.max(0,n.top),i.maxLeft=Math.min(l.width,n.left+n.width)-i.width,i.maxTop=Math.min(l.height,n.top+n.height)-i.height):(i.minLeft=0,i.minTop=0,i.maxLeft=l.width-i.width,i.maxTop=l.height-i.height))},renderCropBox:function(){var t=this.options,s=this.containerData,a=this.cropBoxData;(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=Math.min(Math.max(a.width,a.minWidth),a.maxWidth),a.height=Math.min(Math.max(a.height,a.minHeight),a.maxHeight),this.limitCropBox(!1,!0),a.left=Math.min(Math.max(a.left,a.minLeft),a.maxLeft),a.top=Math.min(Math.max(a.top,a.minTop),a.maxTop),a.oldLeft=a.left,a.oldTop=a.top,t.movable&&t.cropBoxMovable&&Ge(this.face,Xe,a.width>=s.width&&a.height>=s.height?Us:Vt),ge(this.cropBox,V({width:a.width,height:a.height},Ke({translateX:a.left,translateY:a.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ie(this.element,Ft,this.getData())}},Tr={initPreview:function(){var t=this.element,s=this.crossOrigin,a=this.options.preview,l=s?this.crossOriginUrl:this.url,n=t.alt||"The image to preview",i=document.createElement("img");if(s&&(i.crossOrigin=s),i.src=l,i.alt=n,this.viewBox.appendChild(i),this.viewBoxImage=i,!!a){var o=a;typeof a=="string"?o=t.ownerDocument.querySelectorAll(a):a.querySelector&&(o=[a]),this.previews=o,J(o,function(h){var p=document.createElement("img");Ge(h,Je,{width:h.offsetWidth,height:h.offsetHeight,html:h.innerHTML}),s&&(p.crossOrigin=s),p.src=l,p.alt=n,p.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',h.innerHTML="",h.appendChild(p)})}},resetPreview:function(){J(this.previews,function(t){var s=Wt(t,Je);ge(t,{width:s.width,height:s.height}),t.innerHTML=s.html,Nr(t,Je)})},preview:function(){var t=this.imageData,s=this.canvasData,a=this.cropBoxData,l=a.width,n=a.height,i=t.width,o=t.height,h=a.left-s.left-t.left,p=a.top-s.top-t.top;!this.cropped||this.disabled||(ge(this.viewBoxImage,V({width:i,height:o},Ke(V({translateX:-h,translateY:-p},t)))),J(this.previews,function(x){var c=Wt(x,Je),f=c.width,k=c.height,y=f,b=k,j=1;l&&(j=f/l,b=n*j),n&&b>k&&(j=k/n,y=l*j,b=k),ge(x,{width:y,height:b}),ge(x.getElementsByTagName("img")[0],V({width:i*j,height:o*j},Ke(V({translateX:-h*j,translateY:-p*j},t))))}))}},zr={bind:function(){var t=this.element,s=this.options,a=this.cropper;te(s.cropstart)&&re(t,Ut,s.cropstart),te(s.cropmove)&&re(t,Bt,s.cropmove),te(s.cropend)&&re(t,Ot,s.cropend),te(s.crop)&&re(t,Ft,s.crop),te(s.zoom)&&re(t,$t,s.zoom),re(a,xs,this.onCropStart=this.cropStart.bind(this)),s.zoomable&&s.zoomOnWheel&&re(a,fs,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),s.toggleDragModeOnDblclick&&re(a,ms,this.onDblclick=this.dblclick.bind(this)),re(t.ownerDocument,hs,this.onCropMove=this.cropMove.bind(this)),re(t.ownerDocument,ps,this.onCropEnd=this.cropEnd.bind(this)),s.responsive&&re(window,gs,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,s=this.options,a=this.cropper;te(s.cropstart)&&le(t,Ut,s.cropstart),te(s.cropmove)&&le(t,Bt,s.cropmove),te(s.cropend)&&le(t,Ot,s.cropend),te(s.crop)&&le(t,Ft,s.crop),te(s.zoom)&&le(t,$t,s.zoom),le(a,xs,this.onCropStart),s.zoomable&&s.zoomOnWheel&&le(a,fs,this.onWheel,{passive:!1,capture:!0}),s.toggleDragModeOnDblclick&&le(a,ms,this.onDblclick),le(t.ownerDocument,hs,this.onCropMove),le(t.ownerDocument,ps,this.onCropEnd),s.responsive&&le(window,gs,this.onResize)}},Ir={resize:function(){if(!this.disabled){var t=this.options,s=this.container,a=this.containerData,l=s.offsetWidth/a.width,n=s.offsetHeight/a.height,i=Math.abs(l-1)>Math.abs(n-1)?l:n;if(i!==1){var o,h;t.restore&&(o=this.getCanvasData(),h=this.getCropBoxData()),this.render(),t.restore&&(this.setCanvasData(J(o,function(p,x){o[x]=p*i})),this.setCropBoxData(J(h,function(p,x){h[x]=p*i})))}}},dblclick:function(){this.disabled||this.options.dragMode===Ys||this.setDragMode(jr(this.dragBox,zt)?Ws:Jt)},wheel:function(t){var s=this,a=Number(this.options.wheelZoomRatio)||.1,l=1;this.disabled||(t.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){s.wheeling=!1},50),t.deltaY?l=t.deltaY>0?1:-1:t.wheelDelta?l=-t.wheelDelta/120:t.detail&&(l=t.detail>0?1:-1),this.zoom(-l*a,t)))},cropStart:function(t){var s=t.buttons,a=t.button;if(!(this.disabled||(t.type==="mousedown"||t.type==="pointerdown"&&t.pointerType==="mouse")&&(Y(s)&&s!==1||Y(a)&&a!==0||t.ctrlKey))){var l=this.options,n=this.pointers,i;t.changedTouches?J(t.changedTouches,function(o){n[o.identifier]=Qe(o)}):n[t.pointerId||0]=Qe(t),Object.keys(n).length>1&&l.zoomable&&l.zoomOnTouch?i=$s:i=Wt(t.target,Xe),dr.test(i)&&Ie(this.element,Ut,{originalEvent:t,action:i})!==!1&&(t.preventDefault(),this.action=i,this.cropping=!1,i===Bs&&(this.cropping=!0,Q(this.dragBox,rt)))}},cropMove:function(t){var s=this.action;if(!(this.disabled||!s)){var a=this.pointers;t.preventDefault(),Ie(this.element,Bt,{originalEvent:t,action:s})!==!1&&(t.changedTouches?J(t.changedTouches,function(l){V(a[l.identifier]||{},Qe(l,!0))}):V(a[t.pointerId||0]||{},Qe(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var s=this.action,a=this.pointers;t.changedTouches?J(t.changedTouches,function(l){delete a[l.identifier]}):delete a[t.pointerId||0],s&&(t.preventDefault(),Object.keys(a).length||(this.action=""),this.cropping&&(this.cropping=!1,Ee(this.dragBox,rt,this.cropped&&this.options.modal)),Ie(this.element,Ot,{originalEvent:t,action:s}))}}},Fr={change:function(t){var s=this.options,a=this.canvasData,l=this.containerData,n=this.cropBoxData,i=this.pointers,o=this.action,h=s.aspectRatio,p=n.left,x=n.top,c=n.width,f=n.height,k=p+c,y=x+f,b=0,j=0,g=l.width,C=l.height,L=!0,v;!h&&t.shiftKey&&(h=c&&f?c/f:1),this.limited&&(b=n.minLeft,j=n.minTop,g=b+Math.min(l.width,a.width,a.left+a.width),C=j+Math.min(l.height,a.height,a.top+a.height));var P=i[Object.keys(i)[0]],d={x:P.endX-P.startX,y:P.endY-P.startY},S=function(R){switch(R){case je:k+d.x>g&&(d.x=g-k);break;case ve:p+d.x<b&&(d.x=b-p);break;case ue:x+d.y<j&&(d.y=j-x);break;case Pe:y+d.y>C&&(d.y=C-y);break}};switch(o){case Vt:p+=d.x,x+=d.y;break;case je:if(d.x>=0&&(k>=g||h&&(x<=j||y>=C))){L=!1;break}S(je),c+=d.x,c<0&&(o=ve,c=-c,p-=c),h&&(f=c/h,x+=(n.height-f)/2);break;case ue:if(d.y<=0&&(x<=j||h&&(p<=b||k>=g))){L=!1;break}S(ue),f-=d.y,x+=d.y,f<0&&(o=Pe,f=-f,x-=f),h&&(c=f*h,p+=(n.width-c)/2);break;case ve:if(d.x<=0&&(p<=b||h&&(x<=j||y>=C))){L=!1;break}S(ve),c-=d.x,p+=d.x,c<0&&(o=je,c=-c,p-=c),h&&(f=c/h,x+=(n.height-f)/2);break;case Pe:if(d.y>=0&&(y>=C||h&&(p<=b||k>=g))){L=!1;break}S(Pe),f+=d.y,f<0&&(o=ue,f=-f,x-=f),h&&(c=f*h,p+=(n.width-c)/2);break;case Ue:if(h){if(d.y<=0&&(x<=j||k>=g)){L=!1;break}S(ue),f-=d.y,x+=d.y,c=f*h}else S(ue),S(je),d.x>=0?k<g?c+=d.x:d.y<=0&&x<=j&&(L=!1):c+=d.x,d.y<=0?x>j&&(f-=d.y,x+=d.y):(f-=d.y,x+=d.y);c<0&&f<0?(o=Ye,f=-f,c=-c,x-=f,p-=c):c<0?(o=$e,c=-c,p-=c):f<0&&(o=We,f=-f,x-=f);break;case $e:if(h){if(d.y<=0&&(x<=j||p<=b)){L=!1;break}S(ue),f-=d.y,x+=d.y,c=f*h,p+=n.width-c}else S(ue),S(ve),d.x<=0?p>b?(c-=d.x,p+=d.x):d.y<=0&&x<=j&&(L=!1):(c-=d.x,p+=d.x),d.y<=0?x>j&&(f-=d.y,x+=d.y):(f-=d.y,x+=d.y);c<0&&f<0?(o=We,f=-f,c=-c,x-=f,p-=c):c<0?(o=Ue,c=-c,p-=c):f<0&&(o=Ye,f=-f,x-=f);break;case Ye:if(h){if(d.x<=0&&(p<=b||y>=C)){L=!1;break}S(ve),c-=d.x,p+=d.x,f=c/h}else S(Pe),S(ve),d.x<=0?p>b?(c-=d.x,p+=d.x):d.y>=0&&y>=C&&(L=!1):(c-=d.x,p+=d.x),d.y>=0?y<C&&(f+=d.y):f+=d.y;c<0&&f<0?(o=Ue,f=-f,c=-c,x-=f,p-=c):c<0?(o=We,c=-c,p-=c):f<0&&(o=$e,f=-f,x-=f);break;case We:if(h){if(d.x>=0&&(k>=g||y>=C)){L=!1;break}S(je),c+=d.x,f=c/h}else S(Pe),S(je),d.x>=0?k<g?c+=d.x:d.y>=0&&y>=C&&(L=!1):c+=d.x,d.y>=0?y<C&&(f+=d.y):f+=d.y;c<0&&f<0?(o=$e,f=-f,c=-c,x-=f,p-=c):c<0?(o=Ye,c=-c,p-=c):f<0&&(o=Ue,f=-f,x-=f);break;case Us:this.move(d.x,d.y),L=!1;break;case $s:this.zoom(Sr(i),t),L=!1;break;case Bs:if(!d.x||!d.y){L=!1;break}v=Vs(this.cropper),p=P.startX-v.left,x=P.startY-v.top,c=n.minWidth,f=n.minHeight,d.x>0?o=d.y>0?We:Ue:d.x<0&&(p-=c,o=d.y>0?Ye:$e),d.y<0&&(x-=f),this.cropped||(de(this.cropBox,se),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}L&&(n.width=c,n.height=f,n.left=p,n.top=x,this.action=o,this.renderCropBox()),J(i,function(N){N.startX=N.endX,N.startY=N.endY})}},Or={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Q(this.dragBox,rt),de(this.cropBox,se),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=V({},this.initialImageData),this.canvasData=V({},this.initialCanvasData),this.cropBoxData=V({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(V(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),de(this.dragBox,rt),Q(this.cropBox,se)),this},replace:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&t&&(this.isImg&&(this.element.src=t),s?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,J(this.previews,function(a){a.getElementsByTagName("img")[0].src=t}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,de(this.cropper,cs)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Q(this.cropper,cs)),this},destroy:function(){var t=this.element;return t[q]?(t[q]=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.canvasData,l=a.left,n=a.top;return this.moveTo(St(t)?t:l+Number(t),St(s)?s:n+Number(s))},moveTo:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.canvasData,l=!1;return t=Number(t),s=Number(s),this.ready&&!this.disabled&&this.options.movable&&(Y(t)&&(a.left=t,l=!0),Y(s)&&(a.top=s,l=!0),l&&this.renderCanvas(!0)),this},zoom:function(t,s){var a=this.canvasData;return t=Number(t),t<0?t=1/(1-t):t=1+t,this.zoomTo(a.width*t/a.naturalWidth,null,s)},zoomTo:function(t,s,a){var l=this.options,n=this.canvasData,i=n.width,o=n.height,h=n.naturalWidth,p=n.naturalHeight;if(t=Number(t),t>=0&&this.ready&&!this.disabled&&l.zoomable){var x=h*t,c=p*t;if(Ie(this.element,$t,{ratio:t,oldRatio:i/h,originalEvent:a})===!1)return this;if(a){var f=this.pointers,k=Vs(this.cropper),y=f&&Object.keys(f).length?kr(f):{pageX:a.pageX,pageY:a.pageY};n.left-=(x-i)*((y.pageX-k.left-n.left)/i),n.top-=(c-o)*((y.pageY-k.top-n.top)/o)}else Re(s)&&Y(s.x)&&Y(s.y)?(n.left-=(x-i)*((s.x-n.left)/i),n.top-=(c-o)*((s.y-n.top)/o)):(n.left-=(x-i)/2,n.top-=(c-o)/2);n.width=x,n.height=c,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return t=Number(t),Y(t)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var s=this.imageData.scaleY;return this.scale(t,Y(s)?s:1)},scaleY:function(t){var s=this.imageData.scaleX;return this.scale(Y(s)?s:1,t)},scale:function(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,a=this.imageData,l=!1;return t=Number(t),s=Number(s),this.ready&&!this.disabled&&this.options.scalable&&(Y(t)&&(a.scaleX=t,l=!0),Y(s)&&(a.scaleY=s,l=!0),l&&this.renderCanvas(!0,!0)),this},getData:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,s=this.options,a=this.imageData,l=this.canvasData,n=this.cropBoxData,i;if(this.ready&&this.cropped){i={x:n.left-l.left,y:n.top-l.top,width:n.width,height:n.height};var o=a.width/a.naturalWidth;if(J(i,function(x,c){i[c]=x/o}),t){var h=Math.round(i.y+i.height),p=Math.round(i.x+i.width);i.x=Math.round(i.x),i.y=Math.round(i.y),i.width=p-i.x,i.height=h-i.y}}else i={x:0,y:0,width:0,height:0};return s.rotatable&&(i.rotate=a.rotate||0),s.scalable&&(i.scaleX=a.scaleX||1,i.scaleY=a.scaleY||1),i},setData:function(t){var s=this.options,a=this.imageData,l=this.canvasData,n={};if(this.ready&&!this.disabled&&Re(t)){var i=!1;s.rotatable&&Y(t.rotate)&&t.rotate!==a.rotate&&(a.rotate=t.rotate,i=!0),s.scalable&&(Y(t.scaleX)&&t.scaleX!==a.scaleX&&(a.scaleX=t.scaleX,i=!0),Y(t.scaleY)&&t.scaleY!==a.scaleY&&(a.scaleY=t.scaleY,i=!0)),i&&this.renderCanvas(!0,!0);var o=a.width/a.naturalWidth;Y(t.x)&&(n.left=t.x*o+l.left),Y(t.y)&&(n.top=t.y*o+l.top),Y(t.width)&&(n.width=t.width*o),Y(t.height)&&(n.height=t.height*o),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?V({},this.containerData):{}},getImageData:function(){return this.sized?V({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,s={};return this.ready&&J(["left","top","width","height","naturalWidth","naturalHeight"],function(a){s[a]=t[a]}),s},setCanvasData:function(t){var s=this.canvasData,a=s.aspectRatio;return this.ready&&!this.disabled&&Re(t)&&(Y(t.left)&&(s.left=t.left),Y(t.top)&&(s.top=t.top),Y(t.width)?(s.width=t.width,s.height=t.width/a):Y(t.height)&&(s.height=t.height,s.width=t.height*a),this.renderCanvas(!0)),this},getCropBoxData:function(){var t=this.cropBoxData,s;return this.ready&&this.cropped&&(s={left:t.left,top:t.top,width:t.width,height:t.height}),s||{}},setCropBoxData:function(t){var s=this.cropBoxData,a=this.options.aspectRatio,l,n;return this.ready&&this.cropped&&!this.disabled&&Re(t)&&(Y(t.left)&&(s.left=t.left),Y(t.top)&&(s.top=t.top),Y(t.width)&&t.width!==s.width&&(l=!0,s.width=t.width),Y(t.height)&&t.height!==s.height&&(n=!0,s.height=t.height),a&&(l?s.height=s.width/a:n&&(s.width=s.height*a)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var s=this.canvasData,a=_r(this.image,this.imageData,s,t);if(!this.cropped)return a;var l=this.getData(t.rounded),n=l.x,i=l.y,o=l.width,h=l.height,p=a.width/Math.floor(s.naturalWidth);p!==1&&(n*=p,i*=p,o*=p,h*=p);var x=o/h,c=fe({aspectRatio:x,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),f=fe({aspectRatio:x,width:t.minWidth||0,height:t.minHeight||0},"cover"),k=fe({aspectRatio:x,width:t.width||(p!==1?a.width:o),height:t.height||(p!==1?a.height:h)}),y=k.width,b=k.height;y=Math.min(c.width,Math.max(f.width,y)),b=Math.min(c.height,Math.max(f.height,b));var j=document.createElement("canvas"),g=j.getContext("2d");j.width=ze(y),j.height=ze(b),g.fillStyle=t.fillColor||"transparent",g.fillRect(0,0,y,b);var C=t.imageSmoothingEnabled,L=C===void 0?!0:C,v=t.imageSmoothingQuality;g.imageSmoothingEnabled=L,v&&(g.imageSmoothingQuality=v);var P=a.width,d=a.height,S=n,N=i,R,w,z,B,D,F;S<=-o||S>P?(S=0,R=0,z=0,D=0):S<=0?(z=-S,S=0,R=Math.min(P,o+S),D=R):S<=P&&(z=0,R=Math.min(o,P-S),D=R),R<=0||N<=-h||N>d?(N=0,w=0,B=0,F=0):N<=0?(B=-N,N=0,w=Math.min(d,h+N),F=w):N<=d&&(B=0,w=Math.min(h,d-N),F=w);var _=[S,N,R,w];if(D>0&&F>0){var U=y/o;_.push(z*U,B*U,D*U,F*U)}return g.drawImage.apply(g,[a].concat(Os(_.map(function($){return Math.floor(ze($))})))),j},setAspectRatio:function(t){var s=this.options;return!this.disabled&&!St(t)&&(s.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var s=this.options,a=this.dragBox,l=this.face;if(this.ready&&!this.disabled){var n=t===Jt,i=s.movable&&t===Ws;t=n||i?t:Ys,s.dragMode=t,Ge(a,Xe,t),Ee(a,zt,n),Ee(a,It,i),s.cropBoxMovable||(Ge(l,Xe,t),Ee(l,zt,n),Ee(l,It,i))}return this}},Br=xe.Cropper,Qs=function(){function r(t){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Za(this,r),!t||!hr.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=V({},ys,Re(s)&&s),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return er(r,[{key:"init",value:function(){var s=this.element,a=s.tagName.toLowerCase(),l;if(!s[q]){if(s[q]=this,a==="img"){if(this.isImg=!0,l=s.getAttribute("src")||"",this.originalUrl=l,!l)return;l=s.src}else a==="canvas"&&window.HTMLCanvasElement&&(l=s.toDataURL());this.load(l)}}},{key:"load",value:function(s){var a=this;if(s){this.url=s,this.imageData={};var l=this.element,n=this.options;if(!n.rotatable&&!n.scalable&&(n.checkOrientation=!1),!n.checkOrientation||!window.ArrayBuffer){this.clone();return}if(mr.test(s)){xr.test(s)?this.read(Pr(s)):this.clone();return}var i=new XMLHttpRequest,o=this.clone.bind(this);this.reloading=!0,this.xhr=i,i.onabort=o,i.onerror=o,i.ontimeout=o,i.onprogress=function(){i.getResponseHeader("content-type")!==bs&&i.abort()},i.onload=function(){a.read(i.response)},i.onloadend=function(){a.reloading=!1,a.xhr=null},n.checkCrossOrigin&&vs(s)&&l.crossOrigin&&(s=Ns(s)),i.open("GET",s,!0),i.responseType="arraybuffer",i.withCredentials=l.crossOrigin==="use-credentials",i.send()}}},{key:"read",value:function(s){var a=this.options,l=this.imageData,n=Rr(s),i=0,o=1,h=1;if(n>1){this.url=Lr(s,bs);var p=Er(n);i=p.rotate,o=p.scaleX,h=p.scaleY}a.rotatable&&(l.rotate=i),a.scalable&&(l.scaleX=o,l.scaleY=h),this.clone()}},{key:"clone",value:function(){var s=this.element,a=this.url,l=s.crossOrigin,n=a;this.options.checkCrossOrigin&&vs(a)&&(l||(l="anonymous"),n=Ns(a)),this.crossOrigin=l,this.crossOriginUrl=n;var i=document.createElement("img");l&&(i.crossOrigin=l),i.src=n||a,i.alt=s.alt||"The image to crop",this.image=i,i.onload=this.start.bind(this),i.onerror=this.stop.bind(this),Q(i,ds),s.parentNode.insertBefore(i,s.nextSibling)}},{key:"start",value:function(){var s=this,a=this.image;a.onload=null,a.onerror=null,this.sizing=!0;var l=xe.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(xe.navigator.userAgent),n=function(p,x){V(s.imageData,{naturalWidth:p,naturalHeight:x,aspectRatio:p/x}),s.initialImageData=V({},s.imageData),s.sizing=!1,s.sized=!0,s.build()};if(a.naturalWidth&&!l){n(a.naturalWidth,a.naturalHeight);return}var i=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=i,i.onload=function(){n(i.width,i.height),l||o.removeChild(i)},i.src=a.src,l||(i.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(i))}},{key:"stop",value:function(){var s=this.image;s.onload=null,s.onerror=null,s.parentNode.removeChild(s),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var s=this.element,a=this.options,l=this.image,n=s.parentNode,i=document.createElement("div");i.innerHTML=pr;var o=i.querySelector(".".concat(q,"-container")),h=o.querySelector(".".concat(q,"-canvas")),p=o.querySelector(".".concat(q,"-drag-box")),x=o.querySelector(".".concat(q,"-crop-box")),c=x.querySelector(".".concat(q,"-face"));this.container=n,this.cropper=o,this.canvas=h,this.dragBox=p,this.cropBox=x,this.viewBox=o.querySelector(".".concat(q,"-view-box")),this.face=c,h.appendChild(l),Q(s,se),n.insertBefore(o,s.nextSibling),de(l,ds),this.initPreview(),this.bind(),a.initialAspectRatio=Math.max(0,a.initialAspectRatio)||NaN,a.aspectRatio=Math.max(0,a.aspectRatio)||NaN,a.viewMode=Math.max(0,Math.min(3,Math.round(a.viewMode)))||0,Q(x,se),a.guides||Q(x.getElementsByClassName("".concat(q,"-dashed")),se),a.center||Q(x.getElementsByClassName("".concat(q,"-center")),se),a.background&&Q(o,"".concat(q,"-bg")),a.highlight||Q(c,nr),a.cropBoxMovable&&(Q(c,It),Ge(c,Xe,Vt)),a.cropBoxResizable||(Q(x.getElementsByClassName("".concat(q,"-line")),se),Q(x.getElementsByClassName("".concat(q,"-point")),se)),this.render(),this.ready=!0,this.setDragMode(a.dragMode),a.autoCrop&&this.crop(),this.setData(a.data),te(a.ready)&&re(s,us,a.ready,{once:!0}),Ie(s,us)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var s=this.cropper.parentNode;s&&s.removeChild(this.cropper),de(this.element,se)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Br,r}},{key:"setDefaults",value:function(s){V(ys,Re(s)&&s)}}])}();V(Qs.prototype,Mr,Tr,zr,Ir,Fr,Or);var Ne=function(){return Ne=Object.assign||function(r){for(var t,s=1,a=arguments.length;s<a;s++)for(var l in t=arguments[s])Object.prototype.hasOwnProperty.call(t,l)&&(r[l]=t[l]);return r},Ne.apply(this,arguments)};function Ct(r,t){var s={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(s[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(a=Object.getOwnPropertySymbols(r);l<a.length;l++)t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(r,a[l])&&(s[a[l]]=r[a[l]])}return s}var Ur=["aspectRatio","autoCrop","autoCropArea","background","center","checkCrossOrigin","checkOrientation","cropBoxMovable","cropBoxResizable","data","dragMode","guides","highlight","initialAspectRatio","minCanvasHeight","minCanvasWidth","minContainerHeight","minContainerWidth","minCropBoxHeight","minCropBoxWidth","modal","movable","preview","responsive","restore","rotatable","scalable","toggleDragModeOnDblclick","viewMode","wheelZoomRatio","zoomOnTouch","zoomOnWheel","zoomable","cropstart","cropmove","cropend","crop","zoom","ready"],$r={opacity:0,maxWidth:"100%"},Wr=He.forwardRef(function(r,t){var s=Ct(r,[]),a=s.dragMode,l=a===void 0?"crop":a,n=s.src,i=s.style,o=s.className,h=s.crossOrigin,p=s.scaleX,x=s.scaleY,c=s.enable,f=s.zoomTo,k=s.rotateTo,y=s.alt,b=y===void 0?"picture":y,j=s.ready,g=s.onInitialized,C=Ct(s,["dragMode","src","style","className","crossOrigin","scaleX","scaleY","enable","zoomTo","rotateTo","alt","ready","onInitialized"]),L={scaleY:x,scaleX:p,enable:c,zoomTo:f,rotateTo:k},v=function(){for(var d=[],S=0;S<arguments.length;S++)d[S]=arguments[S];var N=m.useRef(null);return He.useEffect(function(){d.forEach(function(R){R&&(typeof R=="function"?R(N.current):R.current=N.current)})},[d]),N}(t,m.useRef(null));m.useEffect(function(){var d;!((d=v.current)===null||d===void 0)&&d.cropper&&typeof f=="number"&&v.current.cropper.zoomTo(f)},[s.zoomTo]),m.useEffect(function(){var d;!((d=v.current)===null||d===void 0)&&d.cropper&&n!==void 0&&v.current.cropper.reset().clear().replace(n)},[n]),m.useEffect(function(){if(v.current!==null){var d=new Qs(v.current,Ne(Ne({dragMode:l},C),{ready:function(S){S.currentTarget!==null&&function(N,R){R===void 0&&(R={});var w=R.enable,z=w===void 0||w,B=R.scaleX,D=B===void 0?1:B,F=R.scaleY,_=F===void 0?1:F,U=R.zoomTo,$=U===void 0?0:U,E=R.rotateTo;z?N.enable():N.disable(),N.scaleX(D),N.scaleY(_),E!==void 0&&N.rotateTo(E),$>0&&N.zoomTo($)}(S.currentTarget.cropper,L),j&&j(S)}}));g&&g(d)}return function(){var S,N;(N=(S=v.current)===null||S===void 0?void 0:S.cropper)===null||N===void 0||N.destroy()}},[v]);var P=function(d){return Ur.reduce(function(S,N){var R=S,w=N;return R[w],Ct(R,[typeof w=="symbol"?w:w+""])},d)}(Ne(Ne({},C),{crossOrigin:h,src:n,alt:b}));return He.createElement("div",{style:i,className:o},He.createElement("img",Ne({},P,{style:$r,ref:v})))});const Ze=()=>{const r=be(),{id:t}=it(),[s,a]=m.useState(!1),[l,n]=m.useState(!1),[i,o]=m.useState(null),[h,p]=m.useState(null),x=m.useRef(null),[c,f]=m.useState({name:"",nik:"",birth_place:"",birth_date:"",address:"",religion:"",marital_status:"",occupation:"",nationality:"",bank_name:"",bank_account_name:"",bank_account_number:"",user_id:"",ktp_image:null,npwp_image:null}),[k,y]=m.useState(null),[b,j]=m.useState(null),[g,C]=m.useState([]);m.useEffect(()=>{L(),t&&(console.log("Editing Creator ID:",t),v(t))},[t]);const L=async()=>{try{const w=await O.get("/users");C(w.data)}catch(w){console.error("Failed to fetch users",w)}},v=async w=>{try{console.log("Fetching creator data for ID:",w);const z=await O.get(`/creators/${w}`);if(console.log("Fetched creator data:",z.data),z.data){const B=z.data,D=Array.isArray(B)?B[0]:B;console.log("Processed Creator Data:",D),f({name:D.name||"",nik:D.nik||"",birth_place:D.birth_place||"",birth_date:D.birth_date?D.birth_date.split("T")[0]:"",address:D.address||"",religion:D.religion||"",marital_status:D.marital_status||"",occupation:D.occupation||"",nationality:D.nationality||"",bank_name:D.bank_name||"",bank_account_name:D.bank_account_name||"",bank_account_number:D.bank_account_number||"",user_id:D.user_id||"",ktp_image:null,npwp_image:null}),D.ktp_path&&y(`http://localhost:5000/${D.ktp_path}`),D.npwp_path&&j(`http://localhost:5000/${D.npwp_path}`)}}catch(z){console.error("Failed to fetch creator",z)}},P=w=>{if(w.target.files&&w.target.files[0]){const z=w.target.files[0],B=new FileReader;B.onload=()=>{o(B.result),p("ktp"),n(!0)},B.readAsDataURL(z),w.target.value=""}},d=w=>{if(w.target.files&&w.target.files[0]){const z=w.target.files[0],B=new FileReader;B.onload=()=>{o(B.result),p("npwp"),n(!0)},B.readAsDataURL(z),w.target.value=""}},S=()=>{var z;const w=(z=x.current)==null?void 0:z.cropper;typeof w<"u"&&w.getCroppedCanvas().toBlob(async B=>{if(B){const D=h==="ktp"?"ktp_cropped.jpg":"npwp_cropped.jpg",F=new File([B],D,{type:"image/jpeg"});h==="ktp"?(f({...c,ktp_image:F}),y(URL.createObjectURL(B))):h==="npwp"&&(f({...c,npwp_image:F}),j(URL.createObjectURL(B))),n(!1),p(null)}},"image/jpeg")},N=w=>{var B;const z=(B=x.current)==null?void 0:B.cropper;z&&z.rotate(w)},R=async w=>{w.preventDefault(),a(!0);const z=new FormData;Object.entries(c).forEach(([B,D])=>{B==="ktp_image"?D&&z.append("ktp",D):B==="npwp_image"?D&&z.append("npwp",D):z.append(B,D)});try{t?await O.put(`/creators/${t}`,z):await O.post("/creators",z),r("/admin/creators")}catch(B){console.error(B),alert("Failed to save creator")}finally{a(!1)}};return e.jsxs("div",{className:"glass-panel min-h-[calc(100vh-2rem)]",children:[e.jsx("div",{className:"border-b border-white/30 px-6 py-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:t?"Edit Creator":"Add New Creator"})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsxs("div",{className:"glass-card p-4 text-center mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Upload KTP"}),k?e.jsx("img",{src:k,alt:"KTP Preview",className:"w-full h-auto rounded mb-4"}):e.jsxs("div",{className:"h-40 flex flex-col items-center justify-center text-gray-400",children:[e.jsx(ie,{size:40,className:"mb-2"}),e.jsx("p",{children:"Click to Upload KTP"})]}),e.jsxs("label",{className:"block w-full",children:[e.jsx("span",{className:"sr-only",children:"Choose file"}),e.jsx("input",{type:"file",accept:"image/*",onChange:P,className:`block w-full text-sm text-gray-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-purple-50 file:text-purple-700
                  hover:file:bg-purple-100`})]})]}),e.jsxs("div",{className:"glass-card p-4 text-center",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Upload NPWP"}),b?e.jsx("img",{src:b,alt:"NPWP Preview",className:"w-full h-auto rounded mb-4"}):e.jsxs("div",{className:"h-40 flex flex-col items-center justify-center text-gray-400",children:[e.jsx(ie,{size:40,className:"mb-2"}),e.jsx("p",{children:"Click to Upload NPWP"})]}),e.jsxs("label",{className:"block w-full",children:[e.jsx("span",{className:"sr-only",children:"Choose file"}),e.jsx("input",{type:"file",accept:"image/*",onChange:d,className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-full file:border-0
                    file:text-sm file:font-semibold
                    file:bg-purple-50 file:text-purple-700
                    hover:file:bg-purple-100`})]})]})]}),e.jsx("div",{className:"md:col-span-2 glass-panel p-6",children:e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NIK"}),e.jsx("input",{type:"text",value:c.nik,onChange:w=>f({...c,nik:w.target.value}),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pemilik Akun User (Opsional)"}),e.jsxs("select",{value:c.user_id,onChange:w=>f({...c,user_id:w.target.value}),className:"mt-1 block w-full glass-input",children:[e.jsx("option",{value:"",children:"Pilih User"}),g.map(w=>e.jsxs("option",{value:w.id,children:[w.name," (",w.email,")"]},w.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama"}),e.jsx("input",{type:"text",value:c.name,onChange:w=>f({...c,name:w.target.value}),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tempat Lahir"}),e.jsx("input",{type:"text",value:c.birth_place,onChange:w=>f({...c,birth_place:w.target.value}),className:"mt-1 block glass-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tanggal Lahir"}),e.jsx("input",{type:"date",value:c.birth_date,onChange:w=>f({...c,birth_date:w.target.value}),className:"mt-1 block glass-input"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Alamat"}),e.jsx("textarea",{value:c.address,onChange:w=>f({...c,address:w.target.value}),className:"mt-1 block glass-input",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Agama"}),e.jsxs("select",{value:c.religion,onChange:w=>f({...c,religion:w.target.value}),className:"mt-1 block w-full glass-input",children:[e.jsx("option",{value:"",children:"Pilih Agama"}),e.jsx("option",{value:"ISLAM",children:"Islam"}),e.jsx("option",{value:"KRISTEN",children:"Kristen"}),e.jsx("option",{value:"KATOLIK",children:"Katolik"}),e.jsx("option",{value:"HINDU",children:"Hindu"}),e.jsx("option",{value:"BUDDHA",children:"Buddha"}),e.jsx("option",{value:"KONGHUCU",children:"Konghucu"}),e.jsx("option",{value:"LAINNYA",children:"Lainnya"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status Perkawinan"}),e.jsx("input",{type:"text",value:c.marital_status,onChange:w=>f({...c,marital_status:w.target.value}),className:"mt-1 block glass-input"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pekerjaan"}),e.jsx("input",{type:"text",value:c.occupation,onChange:w=>f({...c,occupation:w.target.value}),className:"mt-1 block glass-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kewarganegaraan"}),e.jsxs("select",{value:c.nationality,onChange:w=>f({...c,nationality:w.target.value}),className:"mt-1 block w-full glass-input",children:[e.jsx("option",{value:"",children:"Pilih Kewarganegaraan"}),e.jsx("option",{value:"WNI",children:"WNI"}),e.jsx("option",{value:"WNA",children:"WNA"})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Data Rekening Bank"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama Bank"}),e.jsx("input",{type:"text",value:c.bank_name,onChange:w=>f({...c,bank_name:w.target.value}),className:"mt-1 block glass-input",placeholder:"Contoh: BCA, Mandiri"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama Pemilik Rekening"}),e.jsx("input",{type:"text",value:c.bank_account_name,onChange:w=>f({...c,bank_account_name:w.target.value}),className:"mt-1 block glass-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"No. Rekening"}),e.jsx("input",{type:"text",value:c.bank_account_number,onChange:w=>f({...c,bank_account_number:w.target.value}),className:"mt-1 block glass-input"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",disabled:s,className:"glass-button flex items-center disabled:opacity-50",children:s?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Oe,{size:20,className:"mr-2"})," Simpan Pencipta"]})})})]})})]}),l&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx(ya,{className:"mr-2",size:20})," Crop & Rotate KTP"]}),e.jsx("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(oe,{size:24})})]}),e.jsx("div",{className:"flex-1 bg-gray-900 p-4 overflow-hidden flex items-center justify-center",children:e.jsx(Wr,{ref:x,style:{height:"100%",maxHeight:"60vh",width:"100%"},initialAspectRatio:1.58,src:i||"",viewMode:1,guides:!0,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t flex flex-wrap gap-4 justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>N(-90),className:"flex items-center px-3 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 text-gray-700",title:"Rotate Left",children:[e.jsx(ja,{size:18,className:"mr-1"})," -90°"]}),e.jsxs("button",{type:"button",onClick:()=>N(90),className:"flex items-center px-3 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 text-gray-700",title:"Rotate Right",children:[e.jsx(va,{size:18,className:"mr-1"})," +90°"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:S,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center shadow-sm",children:[e.jsx(nt,{size:18,className:"mr-2"})," Crop & Save"]})]})]})]})})]})},Yr=()=>{const[r,t]=m.useState(null),[s,a]=m.useState([]);m.useEffect(()=>{(async()=>{try{const o=await O.get("/dashboard/stats");if(t(o.data),o.data.monthlyData)a(o.data.monthlyData);else{const h=await O.get("/reports/analytics");a(h.data)}}catch(o){console.error(o)}})()},[]);const l=i=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),n=["#7A4A88","#9B5DE5","#D689FF","#F15BB5","#00BBF9","#00F5D4","#8338EC","#3A86FF","#FF006E","#FB5607","#FFBE0B","#FFD166"];return r?e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Revenue Analytics"}),e.jsx("div",{className:"h-80",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(mt,{data:s,children:[e.jsx(xt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(ht,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},dy:10,tickFormatter:i=>new Date(0,i-1).toLocaleString("default",{month:"short"})}),e.jsx(pt,{axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12}}),e.jsx(ut,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:i=>l(i)}),e.jsx(gt,{dataKey:"revenue",radius:[4,4,0,0],children:s.map((i,o)=>e.jsx(ft,{fill:n[o%n.length]},`cell-${o}`))})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Top 5 Songs"}),e.jsxs("div",{className:"space-y-4",children:[r.topSongs&&r.topSongs.map((i,o)=>e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-50 pb-3 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold text-sm",children:o+1}),e.jsx("div",{className:"overflow-hidden",children:e.jsx("p",{className:"font-medium text-gray-800 text-sm truncate max-w-[150px]",title:i.title,children:i.title})})]}),e.jsx("span",{className:"font-bold text-green-600 text-sm",children:l(i.revenue)})]},o)),(!r.topSongs||r.topSongs.length===0)&&e.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"Belum ada data"})]})]})]})]}):e.jsx("div",{children:"Loading..."})},Hr=({isOpen:r,onClose:t,title:s="Berhasil",message:a})=>r?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-lg shadow-2xl w-full max-w-sm p-6 border border-white/40 m-4 relative animate-in fade-in zoom-in duration-200",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(oe,{size:20})}),e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4 text-green-600",children:e.jsx(nt,{size:32,strokeWidth:3})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:s}),e.jsx("p",{className:"text-gray-600 mb-6",children:a}),e.jsx("button",{onClick:t,className:"w-full px-4 py-2 bg-[#7A4A88] text-white rounded-md hover:bg-[#6a3d77] transition-colors font-medium",children:"OK"})]})]})}):null,Kr=()=>{const[r,t]=m.useState(""),[s,a]=m.useState(""),[l,n]=m.useState(""),[i,o]=m.useState(null),[h,p]=m.useState(null),[x,c]=m.useState(null),[f,k]=m.useState(null),[y,b]=m.useState(null),[j,g]=m.useState(null),[C,L]=m.useState(null),[v,P]=m.useState(null),[d,S]=m.useState(!1),[N,R]=m.useState(!1),[w,z]=m.useState("");m.useEffect(()=>{B()},[]);const B=async()=>{try{const E=await O.get("/settings");if(E.data){t(E.data.company_name||""),a(E.data.seo_title||""),n(E.data.seo_description||"");const u="/api".replace("/api",""),T=I=>{if(!I)return null;const W=I.replace(/\\/g,"/");if(W.startsWith("http")||!u&&W.startsWith("/"))return W;const K=u.endsWith("/")?u.slice(0,-1):u,Z=W.startsWith("/")?W:`/${W}`;return`${K}${Z}`};E.data.logo&&p(T(E.data.logo)),E.data.login_background&&k(T(E.data.login_background)),E.data.app_icon&&g(T(E.data.app_icon)),E.data.social_image&&P(T(E.data.social_image))}}catch(E){console.error("Failed to fetch settings",E)}},D=E=>{if(E.target.files&&E.target.files[0]){const A=E.target.files[0];o(A),p(URL.createObjectURL(A))}},F=E=>{if(E.target.files&&E.target.files[0]){const A=E.target.files[0];c(A),k(URL.createObjectURL(A))}},_=E=>{if(E.target.files&&E.target.files[0]){const A=E.target.files[0];b(A),g(URL.createObjectURL(A))}},U=E=>{if(E.target.files&&E.target.files[0]){const A=E.target.files[0];L(A),P(URL.createObjectURL(A))}},$=async E=>{var u,T;E.preventDefault(),R(!0),z("");const A=new FormData;A.append("company_name",r),A.append("seo_title",s),A.append("seo_description",l),i&&A.append("logo",i),x&&A.append("login_background",x),y&&A.append("app_icon",y),C&&A.append("social_image",C);try{await O.put("/settings",A,{headers:{"Content-Type":"multipart/form-data"}}),S(!0)}catch(I){console.error("Failed to update settings",I);const W=((T=(u=I.response)==null?void 0:u.data)==null?void 0:T.message)||I.message||"Failed to update settings";z(`Error: ${W}`)}finally{R(!1)}};return e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx(Hr,{isOpen:d,onClose:()=>S(!1),title:"Berhasil Disimpan",message:"Pengaturan aplikasi telah berhasil diperbarui."}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-[#7A4A88]",children:"Settings"}),w&&e.jsx("div",{className:`p-4 rounded-md mb-4 ${w.includes("Error")?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:w}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:r,onChange:E=>t(E.target.value),className:"glass-input",placeholder:"Enter company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SEO Title"}),e.jsx("input",{type:"text",value:s,onChange:E=>a(E.target.value),className:"glass-input",placeholder:"Enter SEO title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SEO Description"}),e.jsx("textarea",{value:l,onChange:E=>n(E.target.value),className:"glass-input h-24 resize-none",placeholder:"Enter SEO description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Social Share Image (OG Image)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-full sm:w-64 h-32 border border-white/40 rounded-md overflow-hidden flex items-center justify-center bg-white/50 relative shrink-0",children:v?e.jsx("img",{src:v,alt:"Social Preview",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-gray-400 text-xs",children:"No Social Image"})}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("label",{className:"cursor-pointer bg-[#7A4A88] text-white px-4 py-2 rounded-md hover:bg-[#6a3d77] transition-colors flex items-center text-sm w-full sm:w-auto justify-center",children:[e.jsx(ie,{size:16,className:"mr-2"}),e.jsx("span",{children:"Upload Image"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:U})]}),e.jsx("span",{className:"text-xs text-gray-500",children:"Recommended size: 1200x630 pixels"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logo"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 border border-white/40 rounded-md overflow-hidden flex items-center justify-center bg-white/50 shrink-0",children:h?e.jsx("img",{src:h,alt:"Logo Preview",className:"w-full h-full object-contain"}):e.jsx("span",{className:"text-gray-400 text-xs",children:"No Logo"})}),e.jsxs("label",{className:"cursor-pointer bg-[#7A4A88] text-white px-4 py-2 rounded-md hover:bg-[#6a3d77] transition-colors flex items-center text-sm w-full sm:w-auto justify-center",children:[e.jsx(ie,{size:16,className:"mr-2"}),e.jsx("span",{children:"Upload Logo"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:D})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"App Icon (Favicon)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border border-white/40 rounded-md overflow-hidden flex items-center justify-center bg-white/50 shrink-0",children:j?e.jsx("img",{src:j,alt:"Icon Preview",className:"w-full h-full object-contain"}):e.jsx("span",{className:"text-gray-400 text-[10px]",children:"No Icon"})}),e.jsxs("label",{className:"cursor-pointer bg-[#7A4A88] text-white px-4 py-2 rounded-md hover:bg-[#6a3d77] transition-colors flex items-center text-sm w-full sm:w-auto justify-center",children:[e.jsx(ie,{size:16,className:"mr-2"}),e.jsx("span",{children:"Upload Icon"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:_})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Login Background (Opacity 60%)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-full sm:w-64 h-32 border border-white/40 rounded-md overflow-hidden flex items-center justify-center bg-white/50 relative shrink-0",children:f?e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx("img",{src:f,alt:"Bg Preview",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black opacity-40"})]}):e.jsx("span",{className:"text-gray-400 text-xs",children:"No Background"})}),e.jsxs("label",{className:"cursor-pointer bg-[#7A4A88] text-white px-4 py-2 rounded-md hover:bg-[#6a3d77] transition-colors flex items-center text-sm w-full sm:w-auto justify-center",children:[e.jsx(ie,{size:16,className:"mr-2"}),e.jsx("span",{children:"Upload Background"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:F})]})]})]}),e.jsxs("button",{type:"submit",disabled:N,className:"glass-button flex items-center disabled:opacity-50",children:[e.jsx(Oe,{size:18,className:"mr-2"}),N?"Saving...":"Save Settings"]})]})]})},Xr=()=>{const[r,t]=m.useState([]),[s,a]=m.useState({total_net_revenue:0,total_sub_pub_share:0,total_tbw_share:0}),[l,n]=m.useState(!0),[i,o]=m.useState(""),[h,p]=m.useState(1),[x,c]=m.useState(20),[f,k]=m.useState(""),[y,b]=m.useState("");m.useEffect(()=>{j()},[f,y]);const j=async()=>{n(!0);try{const d={};f&&(d.month=f),y&&(d.year=y);const S=await O.get("/reports",{params:d});t(S.data.reports),a(S.data.summary||{total_net_revenue:0,total_sub_pub_share:0,total_tbw_share:0,total_admin_share:0,total_client_share:0})}catch(d){console.error("Failed to fetch reports",d)}finally{n(!1)}},g=r.filter(d=>d.title&&d.title.toLowerCase().includes(i.toLowerCase())||d.custom_id&&d.custom_id.toLowerCase().includes(i.toLowerCase())||d.writer&&d.writer.toLowerCase().includes(i.toLowerCase())),C=Math.ceil(g.length/x),L=(h-1)*x,v=g.slice(L,L+x),P=d=>d==null||isNaN(d)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Report"}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-white p-2 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 text-gray-500",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),e.jsxs("select",{value:f,onChange:d=>k(d.target.value?Number(d.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"All Months"}),Array.from({length:12},(d,S)=>e.jsx("option",{value:S+1,children:new Date(0,S).toLocaleString("default",{month:"long"})},S+1))]}),e.jsxs("select",{value:y,onChange:d=>b(d.target.value?Number(d.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"All Years"}),Array.from({length:5},(d,S)=>{const N=new Date().getFullYear()-2+S;return e.jsx("option",{value:N,children:N},N)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"glass-panel p-6 flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600 mr-4",children:e.jsx(Xt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Revenue"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:P(s.total_sub_pub_share)})]})]}),e.jsxs("div",{className:"glass-panel p-6 flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600 mr-4",children:e.jsx(Ds,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Revenue saya"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:P(s.total_client_share||s.total_net_revenue)})]})]}),e.jsxs("div",{className:"glass-panel p-6 flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-600 mr-4",children:e.jsx(dt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Share To Ruang Musik"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:P(s.total_admin_share||s.total_tbw_share)})]})]})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"p-4 border-b border-white/30 flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 md:max-w-md relative",children:[e.jsx("input",{type:"text",placeholder:"Search by Custom ID, Title, or Writer...",className:"glass-input pl-10 w-full",value:i,onChange:d=>{o(d.target.value),p(1)}}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),e.jsxs("select",{value:x,onChange:d=>{c(Number(d.target.value)),p(1)},className:"glass-input py-1 px-2 text-sm w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Periode"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Custom ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pencipta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Asal Report"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center",children:"Loading..."})}):v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"No reports found"})}):v.map((d,S)=>e.jsxs("tr",{className:S%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.month&&d.year?`${new Date(0,d.month-1).toLocaleString("default",{month:"short"})} ${d.year}`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d.custom_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.writer}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.source}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:P(d.sub_pub_share)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:d.is_matched?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:"Matched"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800",children:"Unmatched"})})]},S))})]})}),C>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-white/30 flex items-center justify-between bg-white/20",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:L+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(L+x,g.length)})," of ",e.jsx("span",{className:"font-medium",children:g.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>p(d=>Math.max(d-1,1)),disabled:h===1,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,C)},(d,S)=>{let N=S+1;return C>5&&(h>3&&(N=h-2+S),N>C&&(N=C-(4-S))),e.jsx("button",{onClick:()=>p(N),className:`px-3 py-1 border rounded-md ${h===N?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:N},N)}),e.jsx("button",{onClick:()=>p(d=>Math.min(d+1,C)),disabled:h===C,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},Gr=()=>{const[r,t]=m.useState(!1),[s,a]=m.useState(1),[l,n]=m.useState(new Date().getMonth()+1),[i,o]=m.useState(new Date().getFullYear()),[h,p]=m.useState(""),[x,c]=m.useState(null),[f,k]=m.useState([]),[y,b]=m.useState(""),[j,g]=m.useState(1),C=10,L=m.useRef(null);m.useEffect(()=>{v()},[]);const v=async()=>{try{const _=await O.get("/reports/history");k(_.data)}catch(_){console.error("Failed to fetch import history",_)}},P=async _=>{if(confirm("Apakah Anda yakin ingin menghapus riwayat import ini? Data laporan terkait TIDAK akan terhapus, hanya riwayat import saja."))try{await O.delete(`/reports/history/${_}`),k(U=>U.filter($=>$.id!==_))}catch(U){console.error("Failed to delete history",U),alert("Gagal menghapus riwayat")}},d=()=>{s<3&&a(s+1)},S=()=>{s>1&&a(s-1)},N=_=>{var $;const U=($=_.target.files)==null?void 0:$[0];U&&c(U)},R=async()=>{var U,$;if(!x)return;t(!0);const _=new FormData;_.append("report",x),_.append("month",l.toString()),_.append("year",i.toString()),_.append("period",h||"");try{const E=await O.post("/reports/import",_,{headers:{"Content-Type":"multipart/form-data"}});alert(`Import successful! Inserted: ${E.data.inserted} records.`),E.data.errors&&E.data.errors.length>0&&alert(`Some warnings:
${E.data.errors.join(`
`)}`),v(),c(null),p(""),a(1),L.current&&(L.current.value="")}catch(E){console.error("Import failed",E),alert(`Import failed: ${(($=(U=E.response)==null?void 0:U.data)==null?void 0:$.message)||E.message}`)}finally{t(!1)}},w=[{id:1,title:"Bulan Laporan",icon:Na},{id:2,title:"Periode Pelaporan",icon:ae},{id:3,title:"Upload Dokumen",icon:ie}],z=f.filter(_=>_.file_name&&_.file_name.toLowerCase().includes(y.toLowerCase())||_.status&&_.status.toLowerCase().includes(y.toLowerCase())),B=Math.ceil(z.length/C),D=(j-1)*C,F=z.slice(D,D+C);return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Import Report"}),e.jsxs("div",{className:"glass-panel p-8 mb-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-8",children:w.map((_,U)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center relative z-10",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-colors duration-300 ${s>=_.id?"bg-purple-600 text-white shadow-lg":"bg-gray-200 text-gray-500"}`,children:s>_.id?e.jsx(nt,{size:20}):e.jsx(_.icon,{size:18})}),e.jsx("span",{className:`text-xs mt-2 font-medium ${s>=_.id?"text-purple-600":"text-gray-400"}`,children:_.title})]}),U<w.length-1&&e.jsx("div",{className:`w-24 h-1 mx-2 rounded -mt-6 transition-colors duration-300 ${s>_.id?"bg-purple-600":"bg-gray-200"}`})]},_.id))}),e.jsxs("div",{className:"max-w-md mx-auto min-h-[200px]",children:[s===1&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-gray-700",children:"Detail Bulan Laporan"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),e.jsx("select",{value:l,onChange:_=>n(Number(_.target.value)),className:"glass-input w-full",children:Array.from({length:12},(_,U)=>e.jsx("option",{value:U+1,children:new Date(0,U).toLocaleString("default",{month:"long"})},U+1))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),e.jsx("select",{value:i,onChange:_=>o(Number(_.target.value)),className:"glass-input w-full",children:Array.from({length:5},(_,U)=>{const $=new Date().getFullYear()-2+U;return e.jsx("option",{value:$,children:$},$)})})]})]})]}),s===2&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-gray-700",children:"Detail Periode Pelaporan"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keterangan Periode (Opsional)"}),e.jsx("input",{type:"text",value:h,onChange:_=>p(_.target.value),placeholder:"Contoh: Q1 2025, Semester 1",className:"glass-input w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tambahkan catatan khusus untuk periode import ini."})]})]}),s===3&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-gray-700",children:"Upload Dokumen Laporan"}),e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-colors ${x?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-purple-400 hover:bg-gray-50"}`,onClick:()=>{var _;return(_=L.current)==null?void 0:_.click()},children:[e.jsx("input",{type:"file",ref:L,onChange:N,className:"hidden",accept:".xlsx, .xls, .csv"}),x?e.jsxs("div",{className:"flex flex-col items-center text-purple-700",children:[e.jsx(ae,{size:48,className:"mb-2"}),e.jsx("span",{className:"font-medium truncate max-w-full",children:x.name}),e.jsxs("span",{className:"text-xs text-purple-500 mt-1",children:[(x.size/1024).toFixed(2)," KB"]}),e.jsx("button",{className:"mt-4 text-xs bg-white border border-purple-200 px-3 py-1 rounded-full hover:bg-purple-100",children:"Ganti File"})]}):e.jsxs("div",{className:"flex flex-col items-center text-gray-500 cursor-pointer",children:[e.jsx(ie,{size:48,className:"mb-2 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"Klik untuk upload file"}),e.jsx("span",{className:"text-xs mt-1",children:"Format: .xlsx, .xls, .csv"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8 max-w-md mx-auto border-t border-gray-100 pt-6",children:[e.jsx("button",{onClick:S,disabled:s===1||r,className:`px-6 py-2 rounded-lg text-sm font-medium transition-colors ${s===1?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:bg-gray-100"}`,children:"Kembali"}),s<3?e.jsxs("button",{onClick:d,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2 text-sm font-medium shadow-md transition-transform hover:scale-105",children:["Lanjut ",e.jsx(Ce,{size:16})]}):e.jsx("button",{onClick:R,disabled:!x||r,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 text-sm font-medium shadow-md transition-transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"animate-spin",size:16})," Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{size:16})," Mulai Import"]})})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Riwayat Import"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Search file name...",className:"pl-10 w-full border rounded-lg py-2 px-3 focus:ring-purple-500 focus:border-purple-500 text-sm",value:y,onChange:_=>{b(_.target.value),g(1)}}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:18})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"File Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Periode"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Records"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Uploaded"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"No import history found"})}):F.map(_=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:_.file_name}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[new Date(0,_.month-1).toLocaleString("default",{month:"long"})," ",_.year,_.period&&e.jsx("span",{className:"block text-xs text-gray-400",children:_.period})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:_.total_records}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${_.status==="Success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(_.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>P(_.id),className:"text-red-600 hover:text-red-900 hover:bg-red-50 p-2 rounded-full transition-colors",title:"Hapus Riwayat",children:e.jsx(st,{size:18})})})]},_.id))})]})}),B>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:D+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(D+C,z.length)})," of ",e.jsx("span",{className:"font-medium",children:z.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>g(_=>Math.max(_-1,1)),disabled:j===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 text-sm",children:"Previous"}),Array.from({length:Math.min(5,B)},(_,U)=>{let $=U+1;return B>5&&(j>3&&($=j-2+U),$>B&&($=B-(4-U))),e.jsx("button",{onClick:()=>g($),className:`px-3 py-1 border rounded text-sm ${j===$?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:$},$)}),e.jsx("button",{onClick:()=>g(_=>Math.min(_+1,B)),disabled:j===B,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 text-sm",children:"Next"})]})]})]})]})},_t=({title:r,type:t,icon:s,month:a,year:l})=>{const[n,i]=m.useState([]),[o,h]=m.useState(1),[p,x]=m.useState(!1),c=5;m.useEffect(()=>{f()},[o,a,l]);const f=async()=>{x(!0);try{const y={type:t,page:o,limit:c};a&&(y.month=a),l&&(y.year=l);const b=await O.get("/reports/top-stats",{params:y});i(b.data)}catch(y){console.error("Failed to fetch top stats",y)}finally{x(!1)}},k=y=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(y);return e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg text-purple-600",children:s}),e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:r})]}),e.jsx("div",{className:"flex-1",children:p?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600"})}):e.jsxs("div",{className:"space-y-3",children:[n.map((y,b)=>e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-50 pb-2 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-gray-100 rounded text-xs font-bold text-gray-500",children:(o-1)*c+b+1}),e.jsx("span",{className:"font-medium text-gray-700 text-sm truncate max-w-[150px]",title:y.name,children:y.name||"Unknown"})]}),e.jsx("span",{className:"font-bold text-green-600 text-sm",children:k(y.revenue)})]},b)),n.length===0&&e.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Tidak ada data"})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsx("button",{onClick:()=>h(y=>Math.max(1,y-1)),disabled:o===1||p,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Sa,{size:20})}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Halaman ",o]}),e.jsx("button",{onClick:()=>h(y=>y+1),disabled:n.length<c||p,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Ce,{size:20})})]})]})},qr=()=>{const[r,t]=m.useState([]),[s,a]=m.useState(null),[l,n]=m.useState(!0),[i,o]=m.useState(""),[h,p]=m.useState("");m.useEffect(()=>{x()},[i,h]);const x=async()=>{n(!0);try{const b={};i&&(b.month=i),h&&(b.year=h);const j=await O.get("/reports/analytics",{params:b});t(j.data);const g={};i&&(g.month=i),h&&(g.year=h);const C=await O.get("/reports",{params:g});C.data&&C.data.summary&&a(C.data.summary)}catch(b){console.error("Failed to fetch analytics",b)}finally{n(!1)}},c=b=>b==null||isNaN(b)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),f=["#7A4A88","#9B5DE5","#D689FF","#F15BB5","#00BBF9","#00F5D4","#8338EC","#3A86FF","#FF006E","#FB5607","#FFBE0B","#FFD166"],k=[{value:1,label:"Januari"},{value:2,label:"Februari"},{value:3,label:"Maret"},{value:4,label:"April"},{value:5,label:"Mei"},{value:6,label:"Juni"},{value:7,label:"Juli"},{value:8,label:"Agustus"},{value:9,label:"September"},{value:10,label:"Oktober"},{value:11,label:"November"},{value:12,label:"Desember"}],y=Array.from({length:5},(b,j)=>new Date().getFullYear()-j);return l&&!s?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(s&&(Number(s.total_client_share||0),Number(s.total_admin_share||0)),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Analitik (Analytics)"}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-white p-2 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 text-gray-500",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),e.jsxs("select",{value:i,onChange:b=>o(b.target.value?Number(b.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),k.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))]}),e.jsxs("select",{value:h,onChange:b=>p(b.target.value?Number(b.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),y.map(b=>e.jsx("option",{value:b,children:b},b))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-full mr-4",children:e.jsx(wa,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Revenue"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((s==null?void 0:s.total_sub_pub_share)||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-full mr-4",children:e.jsx(Te,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Revenue saya"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((s==null?void 0:s.total_client_share)||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-full mr-4",children:e.jsx(Me,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Share To Ruang Musik"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((s==null?void 0:s.total_admin_share)||0)})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:e.jsxs("div",{className:"lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Revenue Trend (Bulanan)"}),e.jsx("div",{className:"h-80",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(mt,{data:r,barGap:0,barCategoryGap:"20%",children:[e.jsx("defs",{children:f.map((b,j)=>e.jsxs("linearGradient",{id:`gradient-${j}`,x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:b,stopOpacity:.8}),e.jsx("stop",{offset:"100%",stopColor:b,stopOpacity:1})]},`gradient-${j}`))}),e.jsx(xt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(ht,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},dy:10,tickFormatter:b=>new Date(0,b-1).toLocaleString("default",{month:"short"})}),e.jsx(pt,{axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12}}),e.jsx(ut,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:b=>c(b)}),e.jsx(gt,{dataKey:"revenue",radius:[4,4,0,0],children:r.map((b,j)=>e.jsx(ft,{fill:`url(#gradient-${j%f.length})`,stroke:f[j%f.length],strokeWidth:1},`cell-${j}`))})]})})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(_t,{title:"Top User Revenue",type:"users",icon:e.jsx(Te,{size:20}),month:i,year:h}),e.jsx(_t,{title:"Top Creator Revenue",type:"creators",icon:e.jsx(Te,{size:20}),month:i,year:h}),e.jsx(_t,{title:"Top Song Revenue",type:"songs",icon:e.jsx(Me,{size:20}),month:i,year:h})]})]}))},Vr=()=>{const[r,t]=m.useState([]),[s,a]=m.useState(""),[l,n]=m.useState(!0),[i,o]=m.useState(null),[h,p]=m.useState(!1),[x,c]=m.useState(!1),[f,k]=m.useState(!1),[y,b]=m.useState("user"),[j,g]=m.useState(null),[C,L]=m.useState(null),[v,P]=m.useState(0),[d,S]=m.useState(""),[N,R]=m.useState({name:"",email:"",whatsapp:"",status:"",percentage_share:0,role:"user"});m.useEffect(()=>{w()},[]);const w=async()=>{n(!0);try{const u=await O.get("/users");t(u.data)}catch(u){console.error("Failed to fetch users",u)}finally{n(!1)}},z=r.filter(u=>{const T=u.name&&u.name.toLowerCase().includes(s.toLowerCase())||u.email&&u.email.toLowerCase().includes(s.toLowerCase()),I=(u.role||"user")===y;return T&&I}),B=(u,T)=>{T==="accepted"?(g(u),L("accept"),P(u.percentage_share||0)):T==="rejected"?(g(u),L("reject"),S("")):F(u.id,{status:T})},D=async()=>{if(!(!j||!C))try{C==="accept"?await O.put(`/users/${j.id}`,{status:"accepted",percentage_share:v}):await O.put(`/users/${j.id}`,{status:"rejected",rejected_reason:d}),g(null),L(null),w()}catch(u){console.error("Failed to update status",u),alert("Failed to update status")}},F=async(u,T)=>{try{await O.put(`/users/${u}`,T),w()}catch(I){console.error("Failed to update user",I),alert("Failed to update user status")}},_=async u=>{try{const T=await O.get(`/users/${u.id}`);o(T.data),c(!0)}catch(T){console.error("Failed to fetch user details",T),alert("Failed to load user details")}},U=async u=>{try{const I=(await O.get(`/users/${u.id}`)).data;o(I),R({name:I.name||"",email:I.email||"",whatsapp:I.whatsapp||"",status:I.status||"pending",percentage_share:Math.floor(I.percentage_share||0),role:I.role||"user"}),p(!0)}catch(T){console.error("Failed to fetch user details for edit",T),o(u),R({name:u.name||"",email:u.email||"",whatsapp:u.whatsapp||"",status:u.status||"pending",percentage_share:Math.floor(u.percentage_share||0),role:u.role||"user"}),p(!0)}},$=u=>{o(u),k(!0)},E=async()=>{if(i)try{await O.delete(`/users/${i.id}`),k(!1),w()}catch(u){console.error("Failed to delete user",u),alert("Failed to delete user")}},A=async()=>{if(i)try{await O.put(`/users/${i.id}`,N),p(!1),w()}catch(u){console.error("Failed to update user",u),alert("Failed to update user status")}};return e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Manajemen User"})}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"flex border-b border-gray-200",children:["user","admin","operator"].map(u=>e.jsxs("button",{onClick:()=>b(u),className:`px-6 py-3 text-sm font-medium capitalize transition-colors
                        ${y===u?"border-b-2 border-purple-600 text-purple-600 bg-purple-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[u,"s"]},u))}),e.jsx("div",{className:"p-4 border-b border-white/30",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx("input",{type:"text",placeholder:`Cari ${y}...`,className:"glass-input pl-10 w-full",value:s,onChange:u=>a(u.target.value)}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),y==="user"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Share (%)"})]}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:y==="user"?7:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):z.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:y==="user"?7:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:["No ",y,"s found"]})}):z.map((u,T)=>e.jsxs("tr",{className:T%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:u.role||"user"}),y==="user"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:u.status||"pending",onChange:I=>B(u,I.target.value),className:`px-2 py-1 text-xs font-semibold rounded-full border-0 cursor-pointer outline-none focus:ring-2 focus:ring-purple-500/50
                                        ${(u.status||"pending")==="accepted"?"bg-green-100 text-green-800":(u.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(u.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:[e.jsx("option",{value:"pending",children:"Waiting"}),e.jsx("option",{value:"review",children:"Review"}),e.jsx("option",{value:"accepted",children:"Accepted"}),e.jsx("option",{value:"rejected",children:"Blocked"})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[Math.floor(u.percentage_share||0),"%"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.created_at?new Date(u.created_at).toLocaleDateString():"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>_(u),className:"p-2 text-blue-600 hover:text-blue-900 hover:bg-blue-50 rounded-lg transition-colors",title:"View Details",children:e.jsx(_e,{size:18})}),e.jsx("button",{onClick:()=>U(u),className:"p-2 text-purple-600 hover:text-purple-900 hover:bg-purple-50 rounded-lg transition-colors",title:"Edit User",children:e.jsx(ka,{size:18})}),e.jsx("button",{onClick:()=>$(u),className:"p-2 text-red-600 hover:text-red-900 hover:bg-red-50 rounded-lg transition-colors",title:"Delete User",children:e.jsx(st,{size:18})})]})})]},u.id))})]})})]}),j&&C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-[400px] max-w-[90%]",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:C==="accept"?"Accept User":"Block User"}),C==="accept"?e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Percentage Share (%) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",value:v,onChange:u=>P(Math.floor(Number(u.target.value))),className:"glass-input w-full p-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g. 70",min:"0",max:"100",step:"1",onKeyDown:u=>{(u.key==="."||u.key===",")&&u.preventDefault()},autoFocus:!0}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Wajib diisi untuk pembagian hasil."})]}):e.jsxs("div",{className:"mb-6",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Reason for Blocking ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:d,onChange:u=>S(u.target.value),className:"glass-input w-full h-24 p-2 border border-gray-300 rounded-md resize-none focus:ring-red-500 focus:border-red-500",placeholder:"Please provide a reason...",autoFocus:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{g(null),L(null)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:C==="accept"&&(!v||v<=0)||C==="reject"&&!d.trim(),className:`flex-1 px-4 py-2 text-white rounded-lg font-medium transition-colors
                              ${C==="accept"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"}
                              disabled:opacity-50 disabled:cursor-not-allowed`,children:"Confirm"})]})]})}),h&&i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-[500px] max-w-[90%] max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Edit User"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Rt,{size:24})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:N.name,onChange:u=>R({...N,name:u.target.value}),className:"glass-input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:N.email,onChange:u=>R({...N,email:u.target.value}),className:"glass-input w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"WhatsApp"}),e.jsx("input",{type:"text",value:N.whatsapp,onChange:u=>R({...N,whatsapp:u.target.value}),className:"glass-input w-full"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsx("div",{className:"flex gap-3",children:["user","operator","admin"].map(u=>e.jsx("button",{onClick:()=>R({...N,role:u}),className:`flex-1 px-4 py-2 rounded-lg text-sm font-medium border transition-all capitalize
                                          ${N.role===u?"border-purple-600 bg-purple-50 text-purple-700 ring-1 ring-purple-600":"border-gray-200 hover:bg-gray-50 text-gray-600"}`,children:u},u))})]}),N.role==="user"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Status"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"accepted",label:"Accepted",icon:Fe,color:"text-green-700 bg-green-50 border-green-600"},{value:"rejected",label:"Block User",icon:Ca,color:"text-red-700 bg-red-50 border-red-600"}].map(u=>e.jsxs("button",{onClick:()=>R({...N,status:u.value}),className:`px-4 py-3 rounded-lg text-sm font-medium border transition-all flex items-center justify-center gap-2
                                              ${N.status===u.value?`${u.color} ring-1 ring-offset-1`:"border-gray-200 hover:bg-gray-50 text-gray-600"}`,children:[e.jsx(u.icon,{size:18}),e.jsx("span",{className:"capitalize",children:u.label})]},u.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Percentage Share (%)"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"number",value:N.percentage_share,onChange:u=>R({...N,percentage_share:Math.floor(Number(u.target.value))}),className:"glass-input w-full pr-8",placeholder:"e.g. 70",min:"0",max:"100",step:"1",onKeyDown:u=>{(u.key==="."||u.key===",")&&u.preventDefault()}}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400 text-sm",children:"%"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Share pendapatan untuk user ini."})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx("button",{onClick:()=>p(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 font-medium",children:"Cancel"}),e.jsx("button",{onClick:A,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 font-medium",children:"Save Changes"})]})]})]})}),x&&i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-[600px] max-w-[90%] max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"User Details"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Rt,{size:24})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Full Name"}),e.jsx("p",{className:"text-gray-900 font-medium",children:i.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Email"}),e.jsx("p",{className:"text-gray-900 font-medium",children:i.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"WhatsApp"}),e.jsx("p",{className:"text-gray-900 font-medium",children:i.whatsapp||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Role"}),e.jsx("p",{className:"text-gray-900 font-medium capitalize",children:i.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Status"}),e.jsx("span",{className:`px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full mt-1
                                ${(i.status||"pending")==="accepted"?"bg-green-100 text-green-800":(i.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(i.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:i.status||"pending"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Percentage Share"}),e.jsxs("p",{className:"text-gray-900 font-medium",children:[Math.floor(i.percentage_share||0),"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Joined Date"}),e.jsx("p",{className:"text-gray-900 font-medium",children:i.created_at?new Date(i.created_at).toLocaleDateString():"-"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Address Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Address"}),e.jsx("p",{className:"text-gray-900",children:i.address||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Country"}),e.jsx("p",{className:"text-gray-900",children:i.country||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Province"}),e.jsx("p",{className:"text-gray-900",children:i.province||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"City"}),e.jsx("p",{className:"text-gray-900",children:i.city||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-semibold",children:"District"}),e.jsx("p",{className:"text-gray-900",children:i.district||"-"})]})]})]})]})]})}),f&&i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-[400px] max-w-[90%] text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(st,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Delete User?"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Are you sure you want to delete ",e.jsx("span",{className:"font-semibold",children:i.name}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>k(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium",children:"Cancel"}),e.jsx("button",{onClick:E,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 font-medium",children:"Delete"})]})]})})]})},Jr=()=>{const r=be(),[t,s]=m.useState([]),[a,l]=m.useState(!1),[n,i]=m.useState("all"),[o,h]=m.useState("all"),[p,x]=m.useState("all");m.useEffect(()=>{c()},[n,o]);const c=async()=>{l(!0);try{const v={};n!=="all"&&(v.month=n),o!=="all"&&(v.year=o);const P=await O.get("/payments/calculate",{params:v});s(P.data)}catch(v){console.error("Failed to fetch payment calculations",v)}finally{l(!1)}},f=t.filter(v=>p==="all"?!0:(v.payment_status||"pending")===p),k=f.reduce((v,P)=>v+(Number(P.total_revenue)||0),0),y=f.reduce((v,P)=>v+(Number(P.admin_share)||0),0),b=f.reduce((v,P)=>v+(Number(P.net_share)||0),0),j=(v,P,d)=>{r(`/admin/payments/${v}`,{state:{month:P||n,year:d||o}})},g=v=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(v),C=v=>{switch(v){case"success":return e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold border border-green-200",children:"SUDAH DITRANSFER"});case"process":return e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-bold border border-yellow-200",children:"PROSES"});default:return e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-bold border border-gray-200",children:"BELUM DITRANSFER"})}},L=v=>new Date(0,v-1).toLocaleString("default",{month:"long"});return e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(at,{size:24}),"Perhitungan Pembayaran (Payment Calculation)"]}),e.jsxs("div",{className:"glass-panel p-6 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 border-b border-gray-100 pb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-purple-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-full mr-4",children:e.jsx(tt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Pendapatan Sub Publisher"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g(k)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-red-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-full mr-4",children:e.jsx(dt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Pendapatan (Sub Pub - Client)"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g(y)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-green-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-full mr-4",children:e.jsx(Te,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Share ke Pencipta (Net)"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g(b)})]})]})]}),e.jsxs("div",{className:"flex gap-4 items-end mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),e.jsxs("select",{value:n,onChange:v=>i(v.target.value==="all"?"all":Number(v.target.value)),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),Array.from({length:12},(v,P)=>e.jsx("option",{value:P+1,children:new Date(0,P).toLocaleString("default",{month:"long"})},P+1))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),e.jsxs("select",{value:o,onChange:v=>h(v.target.value==="all"?"all":Number(v.target.value)),className:"glass-input w-32",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),Array.from({length:5},(v,P)=>{const d=new Date().getFullYear()-2+P;return e.jsx("option",{value:d,children:d},d)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:p,onChange:v=>x(v.target.value),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsxs("button",{onClick:c,className:"btn-primary flex items-center gap-2",children:[e.jsx(at,{size:18})," Hitung Ulang"]})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Menghitung data pembayaran..."})]}):f.length===0?e.jsx("div",{className:"text-center py-12 bg-white/50 rounded-lg border border-dashed border-gray-300",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada data transaksi untuk kriteria ini."})}):e.jsx("div",{className:"space-y-4",children:f.map((v,P)=>e.jsxs("div",{onClick:()=>j(v.user_id,v.month,v.year),className:"glass-panel p-6 flex flex-col md:flex-row items-center justify-between gap-4 cursor-pointer hover:border-purple-300 transition-all group hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold text-xl group-hover:bg-purple-600 group-hover:text-white transition-colors",children:v.user_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg group-hover:text-purple-700 transition-colors",children:v.user_name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["Potongan Admin: ",e.jsxs("span",{className:"text-purple-600 font-medium",children:[v.user_percentage,"%"]})]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{className:"font-medium text-gray-700",children:[L(v.month)," ",v.year]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-8 text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Total Revenue"}),e.jsx("p",{className:"text-lg font-bold text-gray-800",children:g(v.total_revenue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Admin Share"}),e.jsxs("p",{className:"text-lg font-bold text-red-500",children:["-",g(v.admin_share)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Net Payable"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:g(v.net_share)})]}),e.jsxs("div",{className:"pl-4 border-l border-gray-100 flex flex-col items-center justify-center gap-2",children:[C(v.payment_status),e.jsxs("button",{className:"px-4 py-1.5 bg-purple-50 hover:bg-purple-100 text-purple-600 rounded-md text-xs font-semibold border border-purple-200 transition-colors flex items-center gap-1 group-hover:bg-purple-600 group-hover:text-white group-hover:border-purple-600",children:["Lihat ",e.jsx(Ce,{size:14})]})]})]})]},`${v.user_id}-${v.month}-${v.year}-${P}`))})]})]})},Qr=()=>{var E,A;const{userId:r}=it(),t=Yt(),s=be(),[a,l]=m.useState(null),[n,i]=m.useState(!0),[o,h]=m.useState([]),[p,x]=m.useState("pending"),[c,f]=m.useState(!1),[k,y]=m.useState({}),[b,j]=m.useState({}),[g,C]=m.useState(null),[L,v]=m.useState(!1),[P,d]=m.useState(null),S=new URLSearchParams(t.search),N=(u,T)=>{if(T!==void 0)return T;const I=S.get(u);return I==="all"?"all":I?Number(I):u==="year"?new Date().getFullYear():new Date().getMonth()+1},R=N("month",(E=t.state)==null?void 0:E.month)??"all",w=N("year",(A=t.state)==null?void 0:A.year)??"all";m.useEffect(()=>{z()},[r,R,w]);const z=async()=>{var u;i(!0);try{const T={};R!=="all"&&(T.month=R),w!=="all"&&(T.year=w);const W=(await O.get("/payments/calculate",{params:T})).data.find(Z=>Z.user_id===Number(r));l(W),W&&W.payment_status&&x(W.payment_status);const K={};(u=W==null?void 0:W.songs)==null||u.forEach(Z=>{Z.writers.forEach(he=>{he.payment_status?K[he.name]=he.payment_status:K[he.name]="pending"})}),y(K)}catch(T){console.error("Failed to fetch payment details",T)}finally{i(!1)}},B=async()=>{if(p==="success"){const u=$.filter(T=>(k[T.name]||T.payment_status||"pending")!=="success");if(u.length>0){const T=u.map(I=>I.name).join(", ");alert(`Tidak dapat mengubah status menjadi "Sudah Ditransfer".

Masih ada pencipta yang belum ditransfer:
${T}

Mohon selesaikan pembayaran ke semua pencipta terlebih dahulu.`);return}}f(!0);try{const u=new FormData;u.append("user_id",r),R!=="all"&&u.append("month",R.toString()),w!=="all"&&u.append("year",w.toString()),u.append("status",p),await O.post("/payments/status",u,{headers:{"Content-Type":"multipart/form-data"}}),alert("Status berhasil diperbarui"),z()}catch(u){console.error("Failed to update status",u),alert("Gagal memperbarui status")}finally{f(!1)}},D=async u=>{const T=k[u]||"pending",I=b[u],W=$.find(K=>K.name===u);if(T==="success"&&!I&&!(W!=null&&W.payment_proof)){alert("Mohon upload bukti transfer untuk status Success");return}C(u);try{const K=new FormData;K.append("user_id",r),R!=="all"&&K.append("month",R.toString()),w!=="all"&&K.append("year",w.toString()),K.append("writer_name",u),K.append("status",T),I&&K.append("proof",I),await O.post("/payments/writer-status",K,{headers:{"Content-Type":"multipart/form-data"}}),alert(`Status pembayaran untuk ${u} berhasil diperbarui`),j(Z=>({...Z,[u]:null})),y(Z=>({...Z,[u]:T})),z()}catch(K){console.error("Failed to update writer status",K),alert("Gagal memperbarui status")}finally{C(null)}},F=u=>{h(T=>T.includes(u)?T.filter(I=>I!==u):[...T,u])},_=u=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(u),$=(()=>{if(!a)return[];const u={};return a.songs.forEach(T=>{T.writers.forEach(I=>{u[I.name]||(u[I.name]={name:I.name,role:I.role,phone:I.phone,bank_name:I.bank_name,bank_account_number:I.bank_account_number,bank_account_name:I.bank_account_name,payment_status:I.payment_status,payment_proof:I.payment_proof,total_amount:0,songs:[]}),u[I.name].total_amount+=I.amount,u[I.name].songs.push({title:T.title,song_id:T.song_id,share_percent:I.share_percent,amount:I.amount,role:I.role,creators:T.writers.map(W=>`${W.name} (${W.share_percent}%)`).join(", ")})})}),Object.values(u)})();return n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):a?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Ht,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:"Detail Pembayaran"}),e.jsxs("p",{className:"text-gray-500",children:["Periode: ",R==="all"?"Semua Bulan":new Date(0,R-1).toLocaleString("default",{month:"long"})," ",w==="all"?"Semua Tahun":w]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-purple-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-50 rounded-full -mr-16 -mt-16 z-0"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600",children:e.jsx(Se,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:a.user_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["User ID: #",a.user_id]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Total Revenue"}),e.jsx("span",{className:"font-bold text-gray-800",children:_(a.total_revenue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500 text-sm",children:["Royalti Share (",a.user_percentage,"%)"]}),e.jsxs("span",{className:"font-bold text-red-500",children:["-",_(a.admin_share)]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-200 my-2 pt-2 flex justify-between",children:[e.jsx("span",{className:"text-gray-800 font-medium",children:"Net Payable"}),e.jsx("span",{className:"font-bold text-xl text-green-600",children:_(a.net_share)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Fe,{size:18})," Status Transfer"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Saat Ini"}),e.jsxs("select",{value:p,onChange:u=>x(u.target.value),className:"glass-input w-full",children:[e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsx("button",{onClick:B,disabled:c,className:"w-full btn-primary flex items-center justify-center gap-2",children:c?"Menyimpan...":e.jsxs(e.Fragment,{children:[e.jsx(Oe,{size:18})," Simpan Status"]})})]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ae,{size:20})," Rincian Pencipta"]}),e.jsx("div",{className:"space-y-4",children:$.map((u,T)=>{var I;return e.jsxs("div",{className:"bg-white rounded-lg border border-purple-100 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-purple-50/30 transition-colors",onClick:()=>F(u.name),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1 rounded-full ${o.includes(u.name)?"bg-purple-100 text-purple-600":"text-gray-400"}`,children:o.includes(u.name)?e.jsx(Kt,{size:20}):e.jsx(Ce,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:u.name}),e.jsx("p",{className:"text-xs text-gray-500",children:u.role})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Diterima"}),e.jsx("p",{className:"font-bold text-green-600 text-lg",children:_(u.total_amount)})]})]}),o.includes(u.name)&&e.jsxs("div",{className:"bg-gray-50 border-t border-gray-100 p-4",children:[(u.bank_name||u.bank_account_number)&&e.jsxs("div",{className:"mb-4 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[e.jsxs("h5",{className:"text-xs font-semibold text-blue-700 uppercase mb-2 flex items-center gap-2",children:[e.jsx(As,{size:14})," Data Rekening"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Bank"}),e.jsx("span",{className:"font-medium text-gray-800",children:u.bank_name||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"No. Rekening"}),e.jsx("span",{className:"font-medium text-gray-800",children:u.bank_account_number||"-"})]}),u.bank_account_name&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Atas Nama"}),e.jsx("span",{className:"font-medium text-gray-800",children:u.bank_account_name})]})]})]}),e.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg border border-purple-100 shadow-sm",children:[e.jsxs("h5",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Fe,{size:16,className:"text-purple-600"})," Status Pembayaran & Bukti Transfer"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:k[u.name]||"pending",onChange:W=>y(K=>({...K,[u.name]:W.target.value})),className:"glass-input w-full text-sm py-2",children:[e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bukti Transfer"}),k[u.name]==="success"?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 border border-gray-300 rounded px-3 py-1.5 bg-gray-50 hover:bg-white transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:W=>j(K=>({...K,[u.name]:W.target.files?W.target.files[0]:null})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 truncate",children:[e.jsx(ie,{size:14}),e.jsx("span",{className:"text-xs truncate",children:b[u.name]?(I=b[u.name])==null?void 0:I.name:u.payment_proof?"Ganti File":"Upload Bukti"})]})]}),u.payment_proof&&e.jsx("button",{onClick:()=>{const W=u.payment_proof.startsWith("http")||u.payment_proof.startsWith("/uploads/")?u.payment_proof:`/uploads/proof/${u.payment_proof}`;d(W),v(!0)},className:"p-2 bg-purple-50 text-purple-600 rounded border border-purple-100 hover:bg-purple-100",title:"Lihat Bukti",children:e.jsx(_e,{size:16})})]}):e.jsx("p",{className:"text-xs text-gray-400 italic py-2",children:"Pilih status Success untuk upload bukti"})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[u.phone&&e.jsxs("a",{href:`https://wa.me/${u.phone.replace(/^0/,"62").replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-green-600 hover:text-green-700 text-sm font-medium px-3 py-1.5 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(_a,{size:16})," WhatsApp"]}),e.jsx("button",{onClick:()=>D(u.name),disabled:g===u.name,className:"btn-primary text-sm py-1.5 px-4 flex items-center gap-2 ml-auto",children:g===u.name?"Menyimpan...":e.jsxs(e.Fragment,{children:[e.jsx(Oe,{size:14})," Simpan"]})})]})]}),e.jsx("h5",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"Rincian Lagu"}),e.jsx("div",{className:"space-y-2",children:u.songs.map((W,K)=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded border border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[W.title,e.jsxs("span",{className:"ml-1 text-xs text-gray-500 font-normal",children:["(",W.creators,")"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Share: ",W.share_percent,"%"]})]}),e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:_(W.amount)})]},K))})]})]},T)})})]})]}),L&&P&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"relative max-w-2xl w-full bg-white rounded-xl overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"Bukti Transfer"}),e.jsx("button",{onClick:()=>v(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(oe,{size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"p-4 bg-gray-100 flex justify-center",children:e.jsx("img",{src:P,alt:"Bukti Transfer",className:"max-h-[70vh] object-contain rounded-lg shadow-sm"})}),e.jsx("div",{className:"p-4 border-t border-gray-100 flex justify-end",children:e.jsxs("a",{href:P,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:[e.jsx(lt,{size:16})," Buka Original"]})})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500",children:"Data tidak ditemukan."}),e.jsx("button",{onClick:()=>s(-1),className:"mt-4 text-purple-600 hover:underline",children:"Kembali"})]})},Zr=()=>{var d,S;const{userId:r}=it(),t=Yt(),s=be(),[a,l]=m.useState(null),[n,i]=m.useState(!0),[o,h]=m.useState([]),[p,x]=m.useState(!1),[c,f]=m.useState(null),k=new URLSearchParams(t.search),y=(N,R)=>{if(R!==void 0)return R;const w=k.get(N);return w==="all"?"all":w?Number(w):N==="year"?new Date().getFullYear():new Date().getMonth()+1},b=y("month",(d=t.state)==null?void 0:d.month)??"all",j=y("year",(S=t.state)==null?void 0:S.year)??"all";m.useEffect(()=>{g()},[r,b,j]);const g=async()=>{i(!0);try{const N={};b!=="all"&&(N.month=b),j!=="all"&&(N.year=j);const w=(await O.get("/payments/calculate",{params:N})).data.find(z=>z.user_id===Number(r));l(w)}catch(N){console.error("Failed to fetch payment details",N)}finally{i(!1)}},C=N=>{h(R=>R.includes(N)?R.filter(w=>w!==N):[...R,N])},L=N=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(N),P=(()=>{if(!a)return[];const N={};return a.songs.forEach(R=>{R.writers.forEach(w=>{N[w.name]||(N[w.name]={name:w.name,role:w.role,phone:w.phone,bank_name:w.bank_name,bank_account_number:w.bank_account_number,bank_account_name:w.bank_account_name,payment_status:w.payment_status,payment_proof:w.payment_proof,total_amount:0,songs:[]}),N[w.name].total_amount+=w.amount,N[w.name].songs.push({title:R.title,song_id:R.song_id,share_percent:w.share_percent,amount:w.amount,role:w.role,creators:R.writers.map(z=>`${z.name} (${z.share_percent}%)`).join(", ")})})}),Object.values(N)})();return n?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):a?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(Ht,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:"Detail Pembayaran Saya"}),e.jsxs("p",{className:"text-gray-500",children:["Periode: ",b==="all"?"Semua Bulan":new Date(0,b-1).toLocaleString("default",{month:"long"})," ",j==="all"?"Semua Tahun":j]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-purple-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-50 rounded-full -mr-16 -mt-16 z-0"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600",children:e.jsx(Se,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:a.user_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["User ID: #",a.user_id]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Total Revenue"}),e.jsx("span",{className:"font-bold text-gray-800",children:L(a.total_revenue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500 text-sm",children:["Royalti Share (",a.user_percentage,"%)"]}),e.jsxs("span",{className:"font-bold text-red-500",children:["-",L(a.admin_share)]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-200 my-2 pt-2 flex justify-between",children:[e.jsx("span",{className:"text-gray-800 font-medium",children:"Net Payable"}),e.jsx("span",{className:"font-bold text-xl text-green-600",children:L(a.net_share)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Fe,{size:18})," Status Transfer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${a.payment_status==="success"?"bg-green-500":a.payment_status==="process"?"bg-blue-500":"bg-gray-300"}`}),e.jsx("span",{className:"font-medium text-gray-700 capitalize",children:a.payment_status==="success"?"Sudah Ditransfer":a.payment_status==="process"?"Sedang Diproses":"Belum Ditransfer"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ae,{size:20})," Rincian Pencipta"]}),e.jsx("div",{className:"space-y-4",children:P.map((N,R)=>e.jsxs("div",{className:"bg-white rounded-lg border border-purple-100 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-purple-50/30 transition-colors",onClick:()=>C(N.name),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1 rounded-full ${o.includes(N.name)?"bg-purple-100 text-purple-600":"text-gray-400"}`,children:o.includes(N.name)?e.jsx(Kt,{size:20}):e.jsx(Ce,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:N.name}),e.jsx("p",{className:"text-xs text-gray-500",children:N.role})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Diterima"}),e.jsx("p",{className:"font-bold text-green-600 text-lg",children:L(N.total_amount)})]})]}),o.includes(N.name)&&e.jsxs("div",{className:"bg-gray-50 border-t border-gray-100 p-4",children:[(N.bank_name||N.bank_account_number)&&e.jsxs("div",{className:"mb-4 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[e.jsxs("h5",{className:"text-xs font-semibold text-blue-700 uppercase mb-2 flex items-center gap-2",children:[e.jsx(As,{size:14})," Data Rekening"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Bank"}),e.jsx("span",{className:"font-medium text-gray-800",children:N.bank_name||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"No. Rekening"}),e.jsx("span",{className:"font-medium text-gray-800",children:N.bank_account_number||"-"})]}),N.bank_account_name&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Atas Nama"}),e.jsx("span",{className:"font-medium text-gray-800",children:N.bank_account_name})]})]})]}),e.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg border border-purple-100 shadow-sm",children:[e.jsxs("h5",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Fe,{size:16,className:"text-purple-600"})," Status Pembayaran"]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold uppercase ${N.payment_status==="success"?"bg-green-100 text-green-800":N.payment_status==="process"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:N.payment_status==="success"?"Sudah Ditransfer":N.payment_status==="process"?"Sedang Diproses":"Belum Ditransfer"}),N.payment_proof&&e.jsxs("button",{onClick:()=>{const w=N.payment_proof.startsWith("http")||N.payment_proof.startsWith("/uploads/")?N.payment_proof:`/uploads/proof/${N.payment_proof}`;f(w),x(!0)},className:"flex items-center gap-2 px-3 py-1.5 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 text-xs font-medium",children:[e.jsx(_e,{size:14})," Lihat Bukti Transfer"]})]})]}),e.jsx("h5",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"Rincian Lagu"}),e.jsx("div",{className:"space-y-2",children:N.songs.map((w,z)=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded border border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[w.title,e.jsxs("span",{className:"ml-1 text-xs text-gray-500 font-normal",children:["(",w.creators,")"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Share: ",w.share_percent,"%"]})]}),e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:L(w.amount)})]},z))})]})]},R))})]})]}),p&&c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"relative max-w-2xl w-full bg-white rounded-xl overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"Bukti Transfer"}),e.jsx("button",{onClick:()=>x(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(oe,{size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"p-4 bg-gray-100 flex justify-center",children:e.jsx("img",{src:c,alt:"Bukti Transfer",className:"max-h-[70vh] object-contain rounded-lg shadow-sm"})}),e.jsx("div",{className:"p-4 border-t border-gray-100 flex justify-end",children:e.jsxs("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:[e.jsx(lt,{size:16})," Buka Original"]})})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500",children:"Data tidak ditemukan."}),e.jsx("button",{onClick:()=>s(-1),className:"mt-4 text-purple-600 hover:underline",children:"Kembali"})]})},ei=()=>{const r=be(),[t,s]=m.useState([]),[a,l]=m.useState(!1),[n,i]=m.useState("all"),[o,h]=m.useState("all"),[p,x]=m.useState("all");m.useEffect(()=>{c()},[n,o]);const c=async()=>{l(!0);try{const v={};n!=="all"&&(v.month=n),o!=="all"&&(v.year=o);const P=await O.get("/payments/calculate",{params:v});s(P.data)}catch(v){console.error("Failed to fetch payment calculations",v)}finally{l(!1)}},f=t.filter(v=>p==="all"?!0:(v.payment_status||"pending")===p),k=f.reduce((v,P)=>v+(Number(P.total_revenue)||0),0),y=f.reduce((v,P)=>v+(Number(P.admin_share)||0),0),b=f.reduce((v,P)=>v+(Number(P.net_share)||0),0),j=(v,P,d)=>{r(`/user/payments/${v}`,{state:{month:P||n,year:d||o}})},g=v=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(v),C=v=>{switch(v){case"success":return e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold border border-green-200",children:"SUDAH DITRANSFER"});case"process":return e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-bold border border-yellow-200",children:"PROSES"});default:return e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-bold border border-gray-200",children:"BELUM DITRANSFER"})}},L=v=>new Date(0,v-1).toLocaleString("default",{month:"long"});return e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(at,{size:24}),"Perhitungan Pembayaran Saya"]}),e.jsxs("div",{className:"glass-panel p-6 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 border-b border-gray-100 pb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-purple-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-full mr-4",children:e.jsx(tt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Pendapatan"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g(k)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-red-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-full mr-4",children:e.jsx(dt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Potongan Admin"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g(y)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-green-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-full mr-4",children:e.jsx(Te,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Pendapatan Bersih"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:g(b)})]})]})]}),e.jsxs("div",{className:"flex gap-4 items-end mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),e.jsxs("select",{value:n,onChange:v=>i(v.target.value==="all"?"all":Number(v.target.value)),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),Array.from({length:12},(v,P)=>e.jsx("option",{value:P+1,children:new Date(0,P).toLocaleString("default",{month:"long"})},P+1))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),e.jsxs("select",{value:o,onChange:v=>h(v.target.value==="all"?"all":Number(v.target.value)),className:"glass-input w-32",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),Array.from({length:5},(v,P)=>{const d=new Date().getFullYear()-2+P;return e.jsx("option",{value:d,children:d},d)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:p,onChange:v=>x(v.target.value),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsxs("button",{onClick:c,className:"btn-primary flex items-center gap-2",children:[e.jsx(at,{size:18})," Refresh Data"]})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Memuat data..."})]}):f.length===0?e.jsx("div",{className:"text-center py-12 bg-white/50 rounded-lg border border-dashed border-gray-300",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada data transaksi untuk kriteria ini."})}):e.jsx("div",{className:"space-y-4",children:f.map((v,P)=>e.jsxs("div",{onClick:()=>j(v.user_id,v.month,v.year),className:"glass-panel p-6 flex flex-col md:flex-row items-center justify-between gap-4 cursor-pointer hover:border-purple-300 transition-all group hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold text-xl group-hover:bg-purple-600 group-hover:text-white transition-colors",children:v.user_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg group-hover:text-purple-700 transition-colors",children:v.user_name}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:e.jsxs("span",{className:"font-medium text-gray-700",children:[L(v.month)," ",v.year]})})]})]}),e.jsxs("div",{className:"flex items-center gap-8 text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Net Payable"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:g(v.net_share)})]}),e.jsxs("div",{className:"pl-4 border-l border-gray-100 flex flex-col items-center justify-center gap-2",children:[C(v.payment_status),e.jsxs("button",{className:"px-4 py-1.5 bg-purple-50 hover:bg-purple-100 text-purple-600 rounded-md text-xs font-semibold border border-purple-200 transition-colors flex items-center gap-1 group-hover:bg-purple-600 group-hover:text-white group-hover:border-purple-600",children:["Lihat Detail ",e.jsx(Ce,{size:14})]})]})]})]},`${v.user_id}-${v.month}-${v.year}-${P}`))})]})]})},ti=()=>{const[r,t]=m.useState([]),[s,a]=m.useState(""),[l,n]=m.useState(!0),[i,o]=m.useState(null);m.useEffect(()=>{h()},[]);const h=async()=>{n(!0);try{const x=await O.get("/creators");Array.isArray(x.data)?t(x.data):x.data&&x.data.data&&t(x.data.data)}catch(x){console.error("Failed to fetch creators",x)}finally{n(!1)}},p=r.filter(x=>x.name.toLowerCase().includes(s.toLowerCase())||x.nik&&x.nik.includes(s));return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Pencipta Saya"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(me,{to:"/user/creators/add",className:"glass-button flex items-center",children:[e.jsx(ot,{size:20,className:"mr-2"}),"Tambah Pencipta"]})})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"p-4 border-b border-white/30",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari nama atau NIK...",className:"glass-input pl-10",value:s,onChange:x=>a(x.target.value)}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NIK"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tgl Lahir"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alamat"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No creators found"})}):p.map((x,c)=>e.jsxs("tr",{className:c%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:x.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.nik||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x.birth_date?new Date(x.birth_date).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:x.address||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"Lihat Data",onClick:()=>o(x),children:e.jsx(_e,{size:18})})})})]},x.id))})]})})]}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detail Pencipta"}),e.jsx("button",{onClick:()=>o(null),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(oe,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wider mb-4",children:"Informasi Pribadi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Nama Lengkap"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"NIK"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.nik||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Tempat, Tanggal Lahir"}),e.jsxs("p",{className:"font-medium text-gray-800",children:[i.birth_place?`${i.birth_place}, `:"",i.birth_date?new Date(i.birth_date).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}):"-"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Kewarganegaraan"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.nationality||"WNI"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Agama"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.religion||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Status Perkawinan"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.marital_status||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Pekerjaan"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.occupation||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Alamat"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.address||"-"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wider mb-4",children:"Informasi Bank"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Nama Bank"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.bank_name||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Nomor Rekening"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.bank_account_number||"-"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Nama Pemilik Rekening"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.bank_account_name||"-"})]})]})]}),(i.ktp_path||i.npwp_path)&&e.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wider mb-4",children:"Dokumen"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.ktp_path&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"File KTP"}),e.jsx("a",{href:`undefined${i.ktp_path}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-purple-600 hover:underline flex items-center gap-1",children:"Lihat KTP"})]}),i.npwp_path&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"File NPWP"}),e.jsx("a",{href:`undefined${i.npwp_path}`,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-purple-600 hover:underline flex items-center gap-1",children:"Lihat NPWP"})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100 bg-gray-50 rounded-b-xl flex justify-end",children:e.jsx("button",{onClick:()=>o(null),className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Tutup"})})]})})]})},si=()=>{const[r,t]=m.useState([]),[s,a]=m.useState(!0),[l,n]=m.useState(""),[i,o]=m.useState(null),[h,p]=m.useState(1),[x,c]=m.useState(20);m.useEffect(()=>{f()},[]);const f=async()=>{a(!0);try{const g=await O.get("/songs");Array.isArray(g.data)?t(g.data):g.data&&g.data.data&&t(g.data.data)}catch(g){console.error("Failed to fetch songs",g)}finally{a(!1)}},k=r.filter(g=>g.title.toLowerCase().includes(l.toLowerCase())||g.performer&&g.performer.toLowerCase().includes(l.toLowerCase())),y=Math.ceil(k.length/x),b=(h-1)*x,j=k.slice(b,b+x);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Lagu Saya"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(me,{to:"/user/songs/create",className:"glass-button flex items-center",children:[e.jsx(ot,{size:20,className:"mr-2"}),"Tambah Lagu"]})})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsxs("div",{className:"p-4 border-b border-white/30 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Cari lagu...",className:"glass-input pl-10 w-full",value:l,onChange:g=>{n(g.target.value),p(1)}}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),e.jsxs("select",{value:x,onChange:g=>{c(Number(g.target.value)),p(1)},className:"glass-input py-1 px-2 text-sm w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Artis"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pencipta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:s?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):j.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Tidak ada lagu ditemukan"})}):j.map((g,C)=>e.jsxs("tr",{className:C%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.performer||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:g.writers&&g.writers.length>0?g.writers.map(L=>L.name).join(", "):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full uppercase
                          ${(g.status||"pending")==="accepted"?"bg-green-100 text-green-800":(g.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(g.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-orange-100 text-orange-800"}`,children:g.status||"pending"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"Lihat Detail",onClick:()=>o(g),children:e.jsx(_e,{size:18})})})})]},g.id))})]})}),y>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-white/30 flex items-center justify-between bg-white/20",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:b+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(b+x,k.length)})," of ",e.jsx("span",{className:"font-medium",children:k.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>p(g=>Math.max(g-1,1)),disabled:h===1,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,y)},(g,C)=>C+1).map(g=>e.jsx("button",{onClick:()=>p(g),className:`px-3 py-1 border rounded-md ${h===g?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:g},g)),e.jsx("button",{onClick:()=>p(g=>Math.min(g+1,y)),disabled:h===y,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),i&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center sticky top-0 bg-white z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detail Lagu"}),e.jsx("button",{onClick:()=>o(null),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(oe,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wider mb-4",children:"Informasi Lagu"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Judul Lagu"}),e.jsx("p",{className:"text-lg font-bold text-gray-800",children:i.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Artis / Performer"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.performer||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Status"}),e.jsx("span",{className:`px-2 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full uppercase
                          ${(i.status||"pending")==="accepted"?"bg-green-100 text-green-800":(i.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(i.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-orange-100 text-orange-800"}`,children:i.status||"pending"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"ISRC"}),e.jsx("p",{className:"font-medium text-gray-800 font-mono",children:i.isrc||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"ISWC"}),e.jsx("p",{className:"font-medium text-gray-800 font-mono",children:i.iswc||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Genre"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.genre||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 block mb-1",children:"Bahasa"}),e.jsx("p",{className:"font-medium text-gray-800",children:i.language||"-"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wider mb-4",children:"Pencipta (Writer/Composer)"}),i.writers&&i.writers.length>0?e.jsx("div",{className:"overflow-hidden border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Nama"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Peran"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Share (%)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:i.writers.map((g,C)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:g.name}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:g.role}),e.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:[g.share_percent,"%"]})]},C))})]})}):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"Tidak ada data pencipta"})]}),i.note&&e.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wider mb-2",children:"Catatan"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg",children:i.note})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100 bg-gray-50 rounded-b-xl flex justify-end",children:e.jsx("button",{onClick:()=>o(null),className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Tutup"})})]})})]})},ai=()=>{var k;const[r,t]=m.useState(null),[s,a]=m.useState(!0),[l,n]=m.useState(!1),[i,o]=m.useState({email:"",password:"",confirmPassword:""}),[h,p]=m.useState(null);m.useEffect(()=>{x()},[]);const x=async()=>{try{const y=await O.get("/auth/me");t(y.data),o(b=>({...b,email:y.data.email}))}catch(y){console.error("Failed to fetch user",y)}finally{a(!1)}},c=y=>{o({...i,[y.target.name]:y.target.value})},f=async y=>{var b,j;if(y.preventDefault(),p(null),i.password&&i.password!==i.confirmPassword){p({type:"error",text:"Password confirmation does not match"});return}n(!0);try{const g={email:i.email};i.password&&(g.password=i.password),await O.put("/auth/update-profile",g),p({type:"success",text:"Profile updated successfully"}),x(),o(C=>({...C,password:"",confirmPassword:""}))}catch(g){p({type:"error",text:((j=(b=g.response)==null?void 0:b.data)==null?void 0:j.message)||"Failed to update profile"})}finally{n(!1)}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(Lt,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Akun Saya"})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-2xl font-bold",children:(k=r==null?void 0:r.name)==null?void 0:k.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r==null?void 0:r.name}),e.jsx("p",{className:"text-gray-500 capitalize",children:r==null?void 0:r.role})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:f,className:"space-y-6 max-w-2xl",children:[h&&e.jsx("div",{className:`p-4 rounded-lg ${h.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:h.text}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-600 capitalize",children:r==null?void 0:r.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Percentage Share"}),e.jsxs("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-600",children:[r==null?void 0:r.percentage_share,"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Joined Date"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-600",children:new Date(r==null?void 0:r.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsx("hr",{className:"border-gray-100"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Profile"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ks,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",name:"email",value:i.email,onChange:c,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(is,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"password",name:"password",value:i.password,onChange:c,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Leave blank to keep current"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(is,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"password",name:"confirmPassword",value:i.confirmPassword,onChange:c,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm new password"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:l,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})})]})})]})]})},ri=()=>{const[r,t]=m.useState([]),[s,a]=m.useState({total_client_share:0,total_admin_share:0,total_sub_pub_share:0}),[l,n]=m.useState(!0),[i,o]=m.useState(""),[h,p]=m.useState(1),[x,c]=m.useState(20),[f,k]=m.useState(""),[y,b]=m.useState("");m.useEffect(()=>{j()},[f,y]);const j=async()=>{n(!0);try{const d={};f&&(d.month=f),y&&(d.year=y);const S=await O.get("/reports",{params:d});t(S.data.reports),a(S.data.summary||{total_client_share:0,total_admin_share:0,total_sub_pub_share:0})}catch(d){console.error("Failed to fetch reports",d)}finally{n(!1)}},g=r.filter(d=>d.title&&d.title.toLowerCase().includes(i.toLowerCase())||d.custom_id&&d.custom_id.toLowerCase().includes(i.toLowerCase())||d.writer&&d.writer.toLowerCase().includes(i.toLowerCase())),C=Math.ceil(g.length/x),L=(h-1)*x,v=g.slice(L,L+x),P=d=>d==null||isNaN(d)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(d);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Laporan Saya"}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-white p-2 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 text-gray-500",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),e.jsxs("select",{value:f,onChange:d=>k(d.target.value?Number(d.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),Array.from({length:12},(d,S)=>e.jsx("option",{value:S+1,children:new Date(0,S).toLocaleString("default",{month:"long"})},S+1))]}),e.jsxs("select",{value:y,onChange:d=>b(d.target.value?Number(d.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),Array.from({length:5},(d,S)=>{const N=new Date().getFullYear()-2+S;return e.jsx("option",{value:N,children:N},N)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"glass-panel p-6 flex items-center col-span-1 md:col-span-1",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600 mr-4",children:e.jsx(Xt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Revenue"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:P(s.total_sub_pub_share)})]})]}),e.jsxs("div",{className:"glass-panel p-6 flex items-center col-span-1 md:col-span-1",children:[e.jsx("div",{className:"p-3 rounded-full bg-orange-100 text-orange-600 mr-4",children:e.jsx(Ps,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Share Revenue"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:P(s.total_admin_share)})]})]}),e.jsxs("div",{className:"glass-panel p-6 flex items-center col-span-1 md:col-span-1",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-600 mr-4",children:e.jsx(Ds,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Revenue saya"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:P(s.total_client_share)})]})]})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"p-4 border-b border-white/30 flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 md:max-w-md relative",children:[e.jsx("input",{type:"text",placeholder:"Cari ID, Judul, atau Pencipta...",className:"glass-input pl-10 w-full",value:i,onChange:d=>{o(d.target.value),p(1)}}),e.jsx(ne,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),e.jsxs("select",{value:x,onChange:d=>{c(Number(d.target.value)),p(1)},className:"glass-input py-1 px-2 text-sm w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Periode"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Custom ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pencipta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Asal Report"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Revenue saya"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center",children:"Loading..."})}):v.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"Tidak ada data report"})}):v.map((d,S)=>e.jsxs("tr",{className:S%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.month&&d.year?`${new Date(0,d.month-1).toLocaleString("default",{month:"short"})} ${d.year}`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d.custom_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.writer}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.source}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:P(d.sub_pub_share)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right font-semibold text-green-600",children:P(d.user_net_revenue)})]},S))})]})}),C>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-white/30 flex items-center justify-between bg-white/20",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:L+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(L+x,g.length)})," of ",e.jsx("span",{className:"font-medium",children:g.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>p(d=>Math.max(d-1,1)),disabled:h===1,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,C)},(d,S)=>{let N=S+1;return C>5&&(h>3&&(N=h-2+S),N>C&&(N=C-(4-S))),e.jsx("button",{onClick:()=>p(N),className:`px-3 py-1 border rounded-md ${h===N?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:N},N)}),e.jsx("button",{onClick:()=>p(d=>Math.min(d+1,C)),disabled:h===C,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},ii=()=>{const[r,t]=m.useState([]),[s,a]=m.useState(null),[l,n]=m.useState(!0),[i,o]=m.useState(""),[h,p]=m.useState("");m.useEffect(()=>{x()},[i,h]);const x=async()=>{n(!0);try{const b={};i&&(b.month=i),h&&(b.year=h);const j=await O.get("/reports/analytics",{params:b});t(j.data);const g={};i&&(g.month=i),h&&(g.year=h);const C=await O.get("/reports",{params:g});C.data&&C.data.summary&&a(C.data.summary)}catch(b){console.error("Failed to fetch analytics",b)}finally{n(!1)}},c=b=>b==null||isNaN(b)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),f=["#7A4A88","#9B5DE5","#D689FF","#F15BB5","#00BBF9","#00F5D4","#8338EC","#3A86FF","#FF006E","#FB5607","#FFBE0B","#FFD166"],k=[{value:1,label:"Januari"},{value:2,label:"Februari"},{value:3,label:"Maret"},{value:4,label:"April"},{value:5,label:"Mei"},{value:6,label:"Juni"},{value:7,label:"Juli"},{value:8,label:"Agustus"},{value:9,label:"September"},{value:10,label:"Oktober"},{value:11,label:"November"},{value:12,label:"Desember"}],y=Array.from({length:5},(b,j)=>new Date().getFullYear()-j);return l&&!s?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Analitik Saya"}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-white p-2 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 text-gray-500",children:[e.jsx(ct,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),e.jsxs("select",{value:i,onChange:b=>o(b.target.value?Number(b.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),k.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))]}),e.jsxs("select",{value:h,onChange:b=>p(b.target.value?Number(b.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),y.map(b=>e.jsx("option",{value:b,children:b},b))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-full mr-4",children:e.jsx(Xt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Revenue"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((s==null?void 0:s.total_sub_pub_share)||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-orange-50 text-orange-600 rounded-full mr-4",children:e.jsx(Ps,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Share Revenue"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((s==null?void 0:s.total_admin_share)||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-full mr-4",children:e.jsx(dt,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Revenue saya"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((s==null?void 0:s.total_client_share)||0)})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:e.jsxs("div",{className:"lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Tren Pendapatan (Bulanan)"}),e.jsx("div",{className:"h-80",children:e.jsx(qe,{width:"100%",height:"100%",children:e.jsxs(mt,{data:r,barGap:0,barCategoryGap:"20%",children:[e.jsx("defs",{children:f.map((b,j)=>e.jsxs("linearGradient",{id:`gradient-${j}`,x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:b,stopOpacity:.8}),e.jsx("stop",{offset:"100%",stopColor:b,stopOpacity:1})]},`gradient-${j}`))}),e.jsx(xt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(ht,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},dy:10,tickFormatter:b=>new Date(0,b-1).toLocaleString("default",{month:"short"})}),e.jsx(pt,{axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12}}),e.jsx(ut,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:b=>c(b)}),e.jsx(gt,{dataKey:"revenue",radius:[4,4,0,0],children:r.map((b,j)=>e.jsx(ft,{fill:`url(#gradient-${j%f.length})`,stroke:f[j%f.length],strokeWidth:1},`cell-${j}`))})]})})})]})})]})},ws=({title:r})=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-[calc(100vh-10rem)] text-center p-6",children:[e.jsx("div",{className:"bg-purple-50 p-6 rounded-full mb-6 animate-pulse",children:e.jsx(Da,{size:64,className:"text-[#7A4A88]"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:r}),e.jsx("p",{className:"text-gray-500 max-w-md",children:"Fitur ini sedang dalam tahap pengembangan (Under Construction). Kami sedang bekerja keras untuk segera menghadirkan fitur ini."}),e.jsxs("div",{className:"mt-8 flex gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-300 animate-bounce",style:{animationDelay:"0s"}}),e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-300 animate-bounce",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-300 animate-bounce",style:{animationDelay:"0.4s"}})]})]}),ni=()=>{const r=()=>{window.location.href="/"};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-lg rounded-2xl p-8 text-center shadow-2xl border border-white/20",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"p-4 bg-red-500/20 rounded-full animate-pulse",children:e.jsx(Aa,{size:48,className:"text-red-400"})})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"System Offline"}),e.jsx("p",{className:"text-gray-300 mb-8 leading-relaxed",children:"We're currently unable to connect to our servers. This could be due to scheduled maintenance or a temporary network issue."}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 mb-8 text-left border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400 mb-2",children:[e.jsx(Dt,{size:16}),e.jsx("span",{children:"Connection Status:"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-ping"}),e.jsx("span",{className:"text-red-400 font-medium",children:"Disconnected"})]})]}),e.jsxs("button",{onClick:r,className:"w-full bg-blue-600 hover:bg-blue-500 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 flex items-center justify-center gap-2 group shadow-lg shadow-blue-500/20",children:[e.jsx(Pa,{size:20,className:"group-hover:rotate-180 transition-transform duration-500"}),"Try Again"]}),e.jsx("p",{className:"mt-6 text-xs text-gray-500",children:"If the problem persists, please contact support."})]})})},li=()=>{const{user:r,logout:t}=De();if(!r)return e.jsx(we,{to:"/login",replace:!0});if(r.status==="accepted")return e.jsx(we,{to:"/user",replace:!0});const a=(()=>{switch(r.status){case"rejected":return{icon:e.jsx(Rt,{className:"w-16 h-16 text-red-500"}),title:"Account Blocked",message:"Your account has been blocked by the administrator. You cannot access the platform.",bgColor:"bg-red-500",lightBg:"bg-red-50"};case"review":return{icon:e.jsx(At,{className:"w-16 h-16 text-blue-500"}),title:"Under Review",message:"Your account is currently being reviewed by our team. You will be notified once the process is complete.",bgColor:"bg-blue-500",lightBg:"bg-blue-50"};default:return{icon:e.jsx(At,{className:"w-16 h-16 text-yellow-500"}),title:"Waiting for Approval",message:"Thank you for registering! Your account is currently pending approval from the administrator. Please check back later.",bgColor:"bg-yellow-500",lightBg:"bg-yellow-50"}}})();return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:e.jsxs("div",{className:"glass-panel w-full max-w-lg p-8 text-center relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-2 ${a.bgColor} opacity-80`}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:`p-4 ${a.lightBg} rounded-full animate-bounce-slow`,children:a.icon})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:a.title}),e.jsx("p",{className:"text-gray-600 mb-8 leading-relaxed",children:a.message}),e.jsxs("div",{className:"border-t border-gray-100 pt-6",children:[e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Logged in as ",e.jsx("span",{className:"font-medium text-gray-900",children:r.email})]}),e.jsxs("button",{onClick:t,className:"inline-flex items-center gap-2 px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 hover:text-red-600 transition-colors text-sm font-medium",children:[e.jsx(Cs,{size:16}),"Sign Out"]})]})]})})};function oi(){return m.useEffect(()=>{(async()=>{try{const t=await O.get("/settings");if(t.data){if(t.data.seo_title?document.title=t.data.seo_title:t.data.company_name&&(document.title=t.data.company_name),t.data.seo_description){let o=document.querySelector("meta[name='description']");o||(o=document.createElement("meta"),o.setAttribute("name","description"),document.head.appendChild(o)),o.setAttribute("content",t.data.seo_description)}const s=(o,h,p)=>{let x=document.querySelector(`meta[${o}='${h}']`);x||(x=document.createElement("meta"),x.setAttribute(o,h),document.head.appendChild(x)),x.setAttribute("content",p)},a=t.data.seo_title||t.data.company_name||document.title,l=t.data.seo_description||"";s("property","og:type","website"),s("property","og:url",window.location.href),s("property","og:title",a),s("property","og:description",l),s("name","twitter:card","summary_large_image"),s("property","twitter:url",window.location.href),s("name","twitter:title",a),s("name","twitter:description",l);let n="";const i=window.location.origin;if(t.data.social_image){const o=t.data.social_image.replace(/\\/g,"/");if(o.startsWith("http"))n=o;else{const h=o.startsWith("/")?o:`/${o}`;n=`${i}${h}`}}else if(t.data.app_icon){const o=t.data.app_icon.replace(/\\/g,"/");if(o.startsWith("http"))n=o;else{const h=o.startsWith("uploads/")?`/${o}`:`/uploads/${o}`;n=`${i}${h}`}}if(n&&(s("property","og:image",n),s("name","twitter:image",n)),t.data.app_icon){const o=document.querySelector("link[rel*='icon']")||document.createElement("link");if(o.type="image/x-icon",o.rel="shortcut icon",t.data.app_icon.startsWith("http"))o.href=t.data.app_icon;else{const h=t.data.app_icon.replace(/\\/g,"/");o.href=h.startsWith("uploads/")?`/${h}`:`/uploads/${h}`}document.getElementsByTagName("head")[0].appendChild(o)}}}catch(t){console.error("Failed to fetch settings for title/icon",t)}})()},[]),e.jsxs(na,{children:[e.jsx(H,{path:"/maintenance",element:e.jsx(ni,{})}),e.jsx(H,{path:"/status",element:e.jsx(li,{})}),e.jsx(H,{path:"/login",element:e.jsx(Ua,{})}),e.jsx(H,{path:"/register",element:e.jsx($a,{})}),e.jsxs(H,{path:"/admin",element:e.jsx(Ya,{}),children:[e.jsx(H,{index:!0,element:e.jsx(Ka,{})}),e.jsx(H,{path:"songs",element:e.jsx(Xa,{})}),e.jsx(H,{path:"songs/create",element:e.jsx(Ve,{})}),e.jsx(H,{path:"songs/edit/:id",element:e.jsx(Ve,{})}),e.jsx(H,{path:"creators",element:e.jsx(Ja,{})}),e.jsx(H,{path:"creators/add",element:e.jsx(Ze,{})}),e.jsx(H,{path:"creators/edit/:id",element:e.jsx(Ze,{})}),e.jsx(H,{path:"analytics",element:e.jsx(qr,{})}),e.jsx(H,{path:"reports",element:e.jsx(Xr,{})}),e.jsx(H,{path:"reports/import",element:e.jsx(Gr,{})}),e.jsx(H,{path:"payments",element:e.jsx(Jr,{})}),e.jsx(H,{path:"payments/:userId",element:e.jsx(Qr,{})}),e.jsx(H,{path:"contracts",element:e.jsx(ws,{title:"Kontrak User"})}),e.jsx(H,{path:"users",element:e.jsx(Vr,{})}),e.jsx(H,{path:"settings",element:e.jsx(Kr,{})})]}),e.jsxs(H,{path:"/user",element:e.jsx(Ha,{}),children:[e.jsx(H,{index:!0,element:e.jsx(Yr,{})}),e.jsx(H,{path:"creators",element:e.jsx(ti,{})}),e.jsx(H,{path:"songs",element:e.jsx(si,{})}),e.jsx(H,{path:"songs/create",element:e.jsx(Ve,{})}),e.jsx(H,{path:"songs/edit/:id",element:e.jsx(Ve,{})}),e.jsx(H,{path:"creators/add",element:e.jsx(Ze,{})}),e.jsx(H,{path:"creators/edit/:id",element:e.jsx(Ze,{})}),e.jsx(H,{path:"analytics",element:e.jsx(ii,{})}),e.jsx(H,{path:"reports",element:e.jsx(ri,{})}),e.jsx(H,{path:"payments",element:e.jsx(ei,{})}),e.jsx(H,{path:"payments/:userId",element:e.jsx(Zr,{})}),e.jsx(H,{path:"contracts",element:e.jsx(ws,{title:"Kontrak"})}),e.jsx(H,{path:"account",element:e.jsx(ai,{})})]}),e.jsx(H,{path:"/",element:e.jsx(we,{to:"/login",replace:!0})})]})}Et.createRoot(document.getElementById("root")).render(e.jsx(He.StrictMode,{children:e.jsx(la,{children:e.jsx(Oa,{children:e.jsx(oi,{})})})}));
