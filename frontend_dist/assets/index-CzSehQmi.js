import{r as h,a as ts,u as be,L as ge,b as Dt,N as Ve,O as fa,d as et,R as $e,e as as,f as $,B as ss}from"./vendor-DYwYEH-H.js";import{j as rs,a as is}from"./utils-DvjEGWJZ.js";import{L as nt,W as Ht,a as xt,b as Xt,U as we,M as Pe,B as ns,F as ae,D as Je,d as Kt,e as Le,S as ls,C as _t,f as ke,c as lt,g as os,h as le,i as cs,j as ds,k as ms,l as ba,m as hs,X as fe,n as ya,o as Ee,p as tt,q as ne,P as ja,E as ze,r as pt,T as va,A as Ye,s as xs,t as ps,u as Re,v as us,w as Na,x as gs,R as fs,y as bs,z as wa,G as Sa,H as ys,I as js,J as At,K as vs,N as ut,O as Ns,Q as ws,V as Ss,Y as ks,Z as Cs,_ as Qe,$ as ka,a0 as Ca,a1 as Ds,a2 as Gt,a3 as _s,a4 as As,a5 as Ps}from"./ui-DADaPm-A.js";import{R as at,A as Ls,a as Ts,B as Pt,C as Lt,X as Tt,Y as Mt,T as Et,b as Rt,c as zt}from"./charts-Dbl-4sXn.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&s(n)}).observe(document,{childList:!0,subtree:!0});function a(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(l){if(l.ep)return;l.ep=!0;const i=a(l);fetch(l.href,i)}})();var Da={exports:{}},st={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ms=h,Es=Symbol.for("react.element"),Rs=Symbol.for("react.fragment"),zs=Object.prototype.hasOwnProperty,Is=Ms.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Os={key:!0,ref:!0,__self:!0,__source:!0};function _a(r,t,a){var s,l={},i=null,n=null;a!==void 0&&(i=""+a),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(n=t.ref);for(s in t)zs.call(t,s)&&!Os.hasOwnProperty(s)&&(l[s]=t[s]);if(r&&r.defaultProps)for(s in t=r.defaultProps,t)l[s]===void 0&&(l[s]=t[s]);return{$$typeof:Es,type:r,key:i,ref:n,props:l,_owner:Is.current}}st.Fragment=Rs;st.jsx=_a;st.jsxs=_a;Da.exports=st;var e=Da.exports,gt={},qt=ts;gt.createRoot=qt.createRoot,gt.hydrateRoot=qt.hydrateRoot;const Aa=h.createContext(void 0),Fs=({children:r})=>{const[t,a]=h.useState(null),[s,l]=h.useState(!0);h.useEffect(()=>{const o=localStorage.getItem("token"),d=localStorage.getItem("user");if(o&&d)try{rs(o);const p=JSON.parse(d);a(p)}catch{localStorage.removeItem("token"),localStorage.removeItem("user")}l(!1)},[]);const i=(o,d)=>{localStorage.setItem("token",o),localStorage.setItem("user",JSON.stringify(d)),a(d)},n=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a(null)};return e.jsx(Aa.Provider,{value:{user:t,login:i,logout:n,isAuthenticated:!!t,isLoading:s},children:r})},Ie=()=>{const r=h.useContext(Aa);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r},Bs=()=>window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?"http://localhost:5000/api":"/api",R=is.create({baseURL:Bs()});R.interceptors.request.use(r=>{const t=localStorage.getItem("token");return t&&(r.headers.Authorization=`Bearer ${t}`),r});R.interceptors.response.use(r=>r,r=>{const t=r.code==="ERR_NETWORK"||r.message==="Network Error",a=r.response&&(r.response.status===500||r.response.status===503),s=window.location.pathname==="/maintenance";return(t||a)&&!s&&(window.location.href="/maintenance"),Promise.reject(r)});const Us=()=>{const[r,t]=h.useState(""),[a,s]=h.useState(""),[l,i]=h.useState(""),[n,o]=h.useState(null),[d,p]=h.useState(null),[m,c]=h.useState("CMS Publishing RuangMusik"),[x,k]=h.useState("checking"),[N,g]=h.useState("checking"),{login:y}=Ie(),w=be();h.useEffect(()=>{(async()=>{g("checking"),k("checking");try{const S=await R.get("/health");g("connected"),S.status===200&&S.data.status==="connected"?k("connected"):k("disconnected")}catch(S){S.response?(g("connected"),k("disconnected")):(g("disconnected"),k("disconnected"))}})(),(async()=>{try{const S=await R.get("/settings");if(S.data){const M="http://localhost:5000/api".replace("/api","");if(S.data.logo){const f=S.data.logo.replace(/\\/g,"/"),P=f.startsWith("http")?f:f.startsWith("uploads/")?`/${f}`:`/uploads/${f}`;o(P)}if(S.data.login_background){const f=S.data.login_background.replace(/\\/g,"/"),P=f.startsWith("http")?f:f.startsWith("uploads/")?`/${f}`:`/uploads/${f}`;p(P)}S.data.company_name&&c(S.data.company_name)}}catch(S){console.error("Failed to fetch settings:",S)}})()},[]);const[A,v]=h.useState({show:!1,status:"",detail:""}),b=async _=>{var u,S,j,M,f;_.preventDefault();try{const P=await R.post("/auth/login",{email:r,password:a});y(P.data.token,P.data.user),P.data.user.role==="admin"?w("/admin"):w("/user")}catch(P){((u=P.response)==null?void 0:u.status)===403&&((j=(S=P.response)==null?void 0:S.data)!=null&&j.status)?(v({show:!0,status:P.response.data.status,detail:P.response.data.detail}),i("")):i(((f=(M=P.response)==null?void 0:M.data)==null?void 0:f.message)||"Login failed")}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center relative bg-gray-50 overflow-hidden",children:[d&&e.jsx("div",{className:"absolute inset-0 z-0 bg-black",children:e.jsx("img",{src:d,alt:"Background",className:"w-full h-full object-cover opacity-60"})}),e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-2 z-20",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/80 backdrop-blur-sm shadow-sm border border-gray-200",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Backend:"}),N==="checking"&&e.jsx(nt,{size:14,className:"animate-spin text-blue-500"}),N==="connected"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(Ht,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Online"})]}),N==="disconnected"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-500",children:[e.jsx(xt,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Offline"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/80 backdrop-blur-sm shadow-sm border border-gray-200",children:[e.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Database:"}),x==="checking"&&e.jsx(nt,{size:14,className:"animate-spin text-blue-500"}),x==="connected"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(Ht,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Connected"})]}),x==="disconnected"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-500",children:[e.jsx(xt,{size:14}),e.jsx("span",{className:"text-xs font-bold",children:"Disconnected"})]})]})]}),A.show&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsx("div",{className:"bg-white rounded-xl shadow-xl p-6 w-96 max-w-[90%] transform transition-all scale-100",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:`p-4 rounded-full mb-4 ${A.status==="review"?"bg-yellow-100 text-yellow-600":A.status==="rejected"?"bg-red-100 text-red-600":"bg-blue-100 text-blue-600"}`,children:e.jsx(nt,{size:32,className:A.status==="review"?"animate-spin-slow":""})}),e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-2 capitalize",children:["Status: ",A.status]}),e.jsx("p",{className:"text-gray-500 mb-6",children:A.detail}),e.jsx("button",{onClick:()=>v({...A,show:!1}),className:"glass-button w-full",children:"Close"})]})})}),e.jsxs("div",{className:"glass-panel p-8 w-96 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[n&&e.jsx("img",{src:n,alt:"Logo",className:"h-24 mb-4 object-contain"}),e.jsx("h1",{className:"text-lg font-bold text-[#7A4A88] text-center mb-1",children:m}),e.jsx("h3",{className:"text-xs uppercase tracking-[0.2em] text-gray-400 font-semibold mb-2 mt-1",children:"System Publishing"}),e.jsx("h2",{className:"text-2xl font-bold text-center text-[#7A4A88]",children:"Login"})]}),l&&e.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4 text-sm",children:l}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",value:r,onChange:_=>t(_.target.value),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("input",{type:"password",value:a,onChange:_=>s(_.target.value),className:"mt-1 block glass-input",required:!0})]}),e.jsx("button",{type:"submit",className:"glass-button w-full",children:"Sign In"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:["Don't have an account? ",e.jsx(ge,{to:"/register",className:"text-[#7A4A88] hover:text-purple-600",children:"Register"})]})]})]})},Ws=()=>{const[r,t]=h.useState(""),[a,s]=h.useState(""),[l,i]=h.useState(""),[n,o]=h.useState(""),d=be(),p=async m=>{var c,x;m.preventDefault();try{await R.post("/auth/register",{name:r,email:a,password:l}),d("/login")}catch(k){o(((x=(c=k.response)==null?void 0:c.data)==null?void 0:x.message)||"Registration failed")}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"glass-panel p-8 w-96",children:[e.jsx("h2",{className:"text-2xl font-bold text-center text-[#7A4A88] mb-6",children:"Register"}),n&&e.jsx("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4 text-sm",children:n}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",value:r,onChange:m=>t(m.target.value),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",value:a,onChange:m=>s(m.target.value),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),e.jsx("input",{type:"password",value:l,onChange:m=>i(m.target.value),className:"mt-1 block glass-input",required:!0})]}),e.jsx("button",{type:"submit",className:"glass-button w-full",children:"Sign Up"})]}),e.jsxs("div",{className:"mt-4 text-center text-sm",children:["Already have an account? ",e.jsx(ge,{to:"/login",className:"text-[#7A4A88] hover:text-purple-600",children:"Login"})]})]})})},Pa=()=>{const{user:r}=Ie(),t=Dt(),[a,s]=h.useState(!0),[l,i]=h.useState(!1),[n,o]=h.useState("Mendy"),[d,p]=h.useState(null);h.useEffect(()=>{(async()=>{try{const N=await R.get("/settings");if(N.data&&(N.data.company_name&&o(N.data.company_name),N.data.logo)){const g=N.data.logo.replace(/\\/g,"/"),y=g.startsWith("http")?g:g.startsWith("uploads/")?`/${g}`:`/uploads/${g}`;p(y)}}catch(N){console.error("Failed to fetch settings",N)}})()},[]);const m=[{path:"/admin",label:"Dashboard",icon:Xt},{label:"Publishing",icon:ns,isGroup:!0,isOpen:a,toggle:()=>s(!a),children:[{path:"/admin/creators",label:"Data Pencipta",icon:we},{path:"/admin/songs",label:"Data Lagu",icon:Pe}]},{label:"Data Report",icon:ae,isGroup:!0,isOpen:l,toggle:()=>i(!l),children:[{path:"/admin/analytics",label:"Analitik",icon:ae},{path:"/admin/reports",label:"Report",icon:ae},{path:"/admin/reports/import",label:"Import",icon:ae}]},{path:"/admin/payments",label:"Pembayaran",icon:Je},{path:"/admin/contracts",label:"Kontrak User",icon:Kt},{path:"/admin/users",label:"User Management",icon:Le},{path:"/admin/settings",label:"Setting",icon:ls}],c=[{path:"/user",label:"Dashboard",icon:Xt},{label:"Lagu Saya",icon:Pe,isGroup:!0,isOpen:a,toggle:()=>s(!a),children:[{path:"/user/creators",label:"Data Pencipta",icon:we},{path:"/user/songs",label:"Data Lagu",icon:Pe}]},{label:"Report Saya",icon:ae,isGroup:!0,isOpen:l,toggle:()=>i(!l),children:[{path:"/user/analytics",label:"Analitik",icon:ae},{path:"/user/reports",label:"Report Lagu",icon:ae},{path:"/user/payments",label:"Pembayaran",icon:Je}]},{path:"/user/contracts",label:"Kontrak",icon:Kt},{path:"/user/account",label:"Akun Saya",icon:we}],x=(r==null?void 0:r.role)==="admin"?m:c;return e.jsxs("div",{className:"w-64 bg-sidebar h-screen shadow-xl flex flex-col fixed overflow-y-auto z-20 text-gray-400 font-sans",children:[e.jsxs("div",{className:"p-6 flex items-center space-x-3 mb-2",children:[d?e.jsx("img",{src:d,alt:"Logo",className:"w-10 h-10 object-contain rounded-lg bg-white/10 p-1"}):e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center text-white font-bold text-xl shadow-lg",children:n.charAt(0)}),e.jsx("h1",{className:"text-2xl font-bold text-white tracking-wide",children:n})]}),e.jsx("nav",{className:"flex-1 px-4 space-y-2",children:x.map(k=>{if(k.isGroup)return e.jsxs("div",{children:[e.jsxs("button",{onClick:k.toggle,className:"w-full flex items-center justify-between px-4 py-3 text-sm font-medium rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(k.icon,{className:"w-5 h-5 mr-3"}),k.label]}),k.isOpen?e.jsx(_t,{size:16}):e.jsx(ke,{size:16})]}),k.isOpen&&e.jsx("div",{className:"mt-1 space-y-1",children:k.children.map(y=>{const w=t.pathname===y.path;return e.jsxs(ge,{to:y.path,className:lt("flex items-center px-4 py-2 text-sm font-medium rounded-lg transition-all ml-4 border-l border-gray-700 pl-4",w?"text-white border-l-2 border-accent-pink pl-[15px]":"text-gray-500 hover:text-gray-300"),children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-current mr-3 opacity-50"}),y.label]},y.path)})})]},k.label);const N=k.icon,g=t.pathname===k.path;return e.jsxs(ge,{to:k.path,className:lt("flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all relative overflow-hidden group",g?"text-white bg-sidebar-active":"text-gray-400 hover:text-white hover:bg-white/5"),children:[g&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-accent-pink rounded-r-full"}),e.jsx(N,{className:lt("w-5 h-5 mr-3 transition-colors",g?"text-accent-pink":"group-hover:text-white")}),k.label]},k.path)})})]})},La=()=>{const{user:r,logout:t}=Ie(),[a,s]=h.useState("offline"),[l,i]=h.useState("offline");return h.useEffect(()=>{const n=async()=>{try{const d=await R.get("/health");d.status===200&&(s("online"),d.data.status==="connected"?i("online"):i("offline"))}catch{s("offline"),i("offline")}};n();const o=setInterval(n,3e4);return()=>clearInterval(o)},[]),e.jsxs("header",{className:"bg-white h-20 flex items-center justify-between px-8 ml-64 sticky top-0 z-50 shadow-sm",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx("button",{className:"text-gray-400 hover:text-gray-600 lg:hidden",children:e.jsx(os,{size:24})}),e.jsxs("div",{className:"relative hidden md:block",children:[e.jsx(le,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search...",className:"pl-10 pr-4 py-2.5 rounded-full bg-gray-50 border border-gray-100 focus:outline-none focus:bg-white focus:ring-2 focus:ring-purple-100 text-sm w-64 transition-all"})]})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"hidden md:flex items-center gap-4 mr-4 bg-gray-50 px-3 py-1.5 rounded-full border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2",title:"Server Status",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${a==="online"?"bg-green-500 animate-pulse shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500 animate-pulse shadow-[0_0_8px_rgba(239,68,68,0.6)]"}`}),e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center gap-1",children:[e.jsx(cs,{size:12}),"Server"]})]}),e.jsx("div",{className:"w-px h-3 bg-gray-300"}),e.jsxs("div",{className:"flex items-center gap-2",title:"Database Status",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${l==="online"?"bg-green-500 animate-pulse shadow-[0_0_8px_rgba(34,197,94,0.6)]":"bg-red-500 animate-pulse shadow-[0_0_8px_rgba(239,68,68,0.6)]"}`}),e.jsxs("span",{className:"text-xs font-semibold text-gray-500 flex items-center gap-1",children:[e.jsx(ds,{size:12}),"DB"]})]})]}),e.jsxs("button",{className:"relative text-gray-400 hover:text-purple-600 transition-colors",children:[e.jsx(ms,{size:20}),e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-red-500 rounded-full border-2 border-white"})]}),e.jsxs("button",{className:"relative text-gray-400 hover:text-purple-600 transition-colors",children:[e.jsx(ba,{size:20}),e.jsx("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full border-2 border-white"})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200 mx-2"}),e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer group relative",children:[e.jsx("div",{className:"text-right hidden md:block",children:e.jsxs("p",{className:"text-sm font-semibold text-gray-700 group-hover:text-purple-700 transition-colors",children:["Hello, ",r==null?void 0:r.name]})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-tr from-purple-500 to-pink-500 p-0.5",children:e.jsx("div",{className:"w-full h-full rounded-full bg-white flex items-center justify-center overflow-hidden",children:e.jsx(we,{size:20,className:"text-gray-600"})})}),e.jsx("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-100 py-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform origin-top-right z-50",children:e.jsxs("button",{onClick:t,className:"w-full text-left px-4 py-2 text-sm text-gray-600 hover:bg-gray-50 hover:text-red-500 flex items-center",children:[e.jsx(hs,{size:16,className:"mr-2"}),"Logout"]})})]})]})]})},$s=({isOpen:r,onClose:t,content:a})=>r?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white/80 backdrop-blur-md rounded-lg shadow-2xl w-full max-w-lg p-6 border border-white/40 m-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b border-gray-200 pb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-[#7A4A88]",children:"Data Pembaruan Aplikasi"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-red-500 transition-colors",children:e.jsx(fe,{size:24})})]}),e.jsx("div",{className:"prose max-w-none text-gray-700 whitespace-pre-wrap max-h-[60vh] overflow-y-auto",children:a||"Tidak ada data pembaruan."}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-[#7A4A88] text-white rounded-md hover:bg-purple-700 transition-colors",children:"Tutup"})})]})}):null,Ta=()=>{const[r,t]=h.useState("1.0.0"),[a,s]=h.useState(""),[l,i]=h.useState(!1);h.useEffect(()=>{fetch("/ver.txt").then(o=>o.text()).then(o=>t(o.trim())).catch(o=>console.error("Failed to load version",o)),fetch("/pembaruan.txt").then(o=>o.text()).then(o=>s(o)).catch(o=>console.error("Failed to load update content",o))},[]);const n=new Date().getFullYear();return e.jsxs(e.Fragment,{children:[e.jsx("footer",{className:"bg-white/30 backdrop-blur-md border-t border-white/20 py-4 px-6 ml-64 mt-auto",children:e.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsxs("span",{children:["Copyright © ",n," RuangMusik Publishing"]}),e.jsx("span",{children:"•"}),e.jsxs("button",{onClick:()=>i(!0),className:"hover:text-[#7A4A88] hover:underline font-medium transition-colors focus:outline-none",children:["Versi ",r]})]}),e.jsxs("div",{children:["Build By ",e.jsx("span",{className:"font-semibold text-[#7A4A88]",children:"Garuda Server"})]})]})}),e.jsx($s,{isOpen:l,onClose:()=>i(!1),content:a})]})},Ys=()=>{const{user:r,isLoading:t}=Ie();return t?e.jsx("div",{children:"Loading..."}):!r||r.role!=="admin"?e.jsx(Ve,{to:"/login",replace:!0}):e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Pa,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative z-0",children:[e.jsx(La,{}),e.jsx("main",{className:"flex-1 p-6 ml-64 overflow-auto",children:e.jsx(fa,{})}),e.jsx(Ta,{})]})]})},Hs=()=>{const{user:r,isLoading:t}=Ie();return t?e.jsx("div",{children:"Loading..."}):r?r.role==="admin"?e.jsx(Ve,{to:"/admin",replace:!0}):e.jsxs("div",{className:"flex min-h-screen",children:[e.jsx(Pa,{}),e.jsxs("div",{className:"flex-1 flex flex-col relative z-0",children:[e.jsx(La,{}),e.jsx("main",{className:"flex-1 p-6 ml-64 overflow-auto",children:e.jsx(fa,{})}),e.jsx(Ta,{})]})]}):e.jsx(Ve,{to:"/login",replace:!0})},ot=({title:r,value:t,icon:a,trend:s,trendUp:l,chartData:i,chartColor:n="#8884d8"})=>e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 flex flex-col justify-between h-40 relative overflow-hidden group hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium mb-1",children:r}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:t})]}),e.jsx("div",{className:"p-2 rounded-lg bg-gray-50 text-gray-600 group-hover:bg-purple-50 group-hover:text-purple-600 transition-colors",children:a})]}),e.jsx("div",{className:"flex justify-between items-end mt-4 z-10",children:s&&e.jsxs("div",{className:`flex items-center text-xs font-semibold ${l?"text-green-500":"text-red-500"}`,children:[l?"↑":"↓"," ",s,e.jsx("span",{className:"text-gray-400 ml-1 font-normal",children:"vs last month"})]})}),i&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-16 opacity-20",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsx(Ls,{data:i,children:e.jsx(Ts,{type:"monotone",dataKey:"value",stroke:n,fill:n,strokeWidth:2})})})})]}),Xs=()=>{var i;const[r,t]=h.useState(null);h.useEffect(()=>{(async()=>{try{const o=await R.get("/dashboard/stats");t(o.data)}catch(o){console.error(o)}})()},[]);const a=((i=r==null?void 0:r.monthlyData)==null?void 0:i.map(n=>({name:`${new Date(0,n.month-1).toLocaleString("default",{month:"short"})}`,revenue:n.revenue})))||[];if(!r)return e.jsx("div",{className:"p-8 text-center text-gray-500",children:"Loading dashboard data..."});const s=n=>n==null||isNaN(n)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),l=["#7A4A88","#9B5DE5","#D689FF","#F15BB5","#00BBF9","#00F5D4","#8338EC","#3A86FF","#FF006E","#FB5607","#FFBE0B","#FFD166"];return e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard Overview"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Welcome back, here's what's happening today."})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx(ot,{title:"Total Songs",value:r.totalSongs,icon:e.jsx(Pe,{size:20}),trend:"Total Songs",trendUp:!0,chartData:[],chartColor:"#8884d8"}),e.jsx(ot,{title:"Lagu Pending",value:r.pendingSongs,icon:e.jsx(ya,{size:20}),trend:"Pending Approval",trendUp:!0,chartData:[],chartColor:"#ffc658"}),e.jsx(ot,{title:"Lagu Diterima",value:r.approvedSongs,icon:e.jsx(Ee,{size:20}),trend:"Approved Songs",trendUp:!0,chartData:[],chartColor:"#82ca9d"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:e.jsxs("div",{className:"lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Monthly Revenue Analytics"})}),e.jsx("div",{className:"h-80",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(Pt,{data:a,margin:{top:10,right:30,left:0,bottom:0},children:[e.jsx(Lt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(Tt,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},dy:10}),e.jsx(Mt,{axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},tickFormatter:n=>`Rp ${(n/1e6).toFixed(1)}M`}),e.jsx(Et,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:n=>s(n)}),e.jsx(Rt,{dataKey:"revenue",radius:[4,4,0,0],children:a.map((n,o)=>e.jsx(zt,{fill:l[o%l.length]},`cell-${o}`))})]})})})]})})]})},Ks=()=>{const{user:r}=Ie(),[t,a]=h.useState([]),[s,l]=h.useState(!0),[i,n]=h.useState(""),[o,d]=h.useState(1),[p,m]=h.useState(20),[c,x]=h.useState(null),[k,N]=h.useState(!1),[g,y]=h.useState(""),[w,A]=h.useState(""),[v,b]=h.useState(""),[_,u]=h.useState(!1),S=h.useRef(null);h.useEffect(()=>{j()},[]);const j=async()=>{try{const T=await R.get("/songs");Array.isArray(T.data)?a(T.data):T.data&&T.data.data&&a(T.data.data)}catch(T){console.error(T),T.response&&T.response.status===401&&alert("Session expired. Please login again.")}finally{l(!1)}},M=async()=>{var T;try{const C=await R.get("/songs/export",{responseType:"blob"}),I=window.URL.createObjectURL(new Blob([C.data])),O=document.createElement("a");O.href=I,O.setAttribute("download","songs.xlsx"),document.body.appendChild(O),O.click(),(T=O.parentNode)==null||T.removeChild(O)}catch(C){console.error("Export failed",C),alert("Failed to export data")}},f=()=>{var T;(T=S.current)==null||T.click()},P=async T=>{var O,W,Y,ee,me;const C=(O=T.target.files)==null?void 0:O[0];if(!C)return;const I=new FormData;I.append("file",C);try{const oe=await R.post("/songs/import",I,{headers:{"Content-Type":"multipart/form-data"}});alert(oe.data.message),oe.data.errors&&(console.warn("Import errors:",oe.data.errors),alert("Some rows failed to import. Check console for details.")),j()}catch(oe){console.error("Import failed",oe);const it=((Y=(W=oe.response)==null?void 0:W.data)==null?void 0:Y.message)||oe.message||"Failed to import data",Oe=((me=(ee=oe.response)==null?void 0:ee.data)==null?void 0:me.error)||"";alert(`${it}
${Oe}`)}finally{S.current&&(S.current.value="")}},E=async T=>{if(confirm("Are you sure you want to delete this song?"))try{await R.delete(`/songs/${T}`),j()}catch(C){console.error(C)}},z=T=>{x(T),y(T.status||"pending"),A(T.song_id||""),b(T.rejection_reason||""),N(!0)},X=async()=>{if(g==="accepted"&&!w.trim()){alert("Custom ID (Identitas Lagu) wajib diisi jika status Diterima.");return}if(g==="rejected"&&!v.trim()){alert("Alasan penolakan wajib diisi jika status Ditolak.");return}u(!0);try{await R.put(`/songs/${c.id}`,{status:g,song_id:w,rejection_reason:v}),N(!1),j()}catch(T){console.error(T),alert("Failed to update song status")}finally{u(!1)}},D=t.filter(T=>{var C;return T.title.toLowerCase().includes(i.toLowerCase())||((C=T.song_id)==null?void 0:C.toLowerCase().includes(i.toLowerCase()))}),F=Math.ceil(D.length/p),B=(o-1)*p,V=D.slice(B,B+p);return s?e.jsx("div",{children:"Loading..."}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Lagu"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:M,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:[e.jsx(tt,{size:20,className:"mr-2"}),"Export Excel"]}),e.jsxs("button",{onClick:f,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[e.jsx(ne,{size:20,className:"mr-2"}),"Import Excel"]}),e.jsx("input",{type:"file",ref:S,className:"hidden",accept:".xlsx, .xls",onChange:P}),e.jsxs(ge,{to:"/admin/songs/create",className:"glass-button flex items-center",children:[e.jsx(ja,{size:20,className:"mr-2"}),"Tambah Lagu"]})]})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsxs("div",{className:"p-4 border-b border-white/30 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Search songs...",className:"glass-input pl-10 w-full",value:i,onChange:T=>{n(T.target.value),d(1)}}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),e.jsxs("select",{value:p,onChange:T=>{m(Number(T.target.value)),d(1)},className:"glass-input py-1 px-2 text-sm w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Song ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Performer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pencipta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:[V.map((T,C)=>e.jsxs("tr",{className:C%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:T.song_id||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:T.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:T.performer||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:T.writers&&T.writers.length>0?T.writers.map(I=>I.name).join(", "):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:T.user_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full uppercase
                        ${(T.status||"pending")==="accepted"?"bg-green-100 text-green-800":(T.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(T.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-orange-100 text-orange-800"}`,children:T.status||"pending"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>z(T),className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"View Details",children:e.jsx(ze,{size:18})}),e.jsx(ge,{to:`/admin/songs/edit/${T.id}`,className:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50 transition-colors",title:"Edit",children:e.jsx(pt,{size:18})}),e.jsx("button",{onClick:()=>E(T.id),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50 transition-colors",title:"Delete",children:e.jsx(va,{size:18})})]})})]},T.id)),V.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"No songs found"})})]})]})}),F>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-white/30 flex items-center justify-between bg-white/20",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:B+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(B+p,D.length)})," of ",e.jsx("span",{className:"font-medium",children:D.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>d(T=>Math.max(T-1,1)),disabled:o===1,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,F)},(T,C)=>{let I=C+1;return F>5&&(o>3&&(I=o-2+C),I>F&&(I=F-(4-C))),e.jsx("button",{onClick:()=>d(I),className:`px-3 py-1 border rounded-md ${o===I?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:I},I)}),e.jsx("button",{onClick:()=>d(T=>Math.min(T+1,F)),disabled:o===F,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),k&&c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center z-10",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detail Lagu"}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(fe,{size:24})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Judul Lagu"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:c.title})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Artis / Performer"}),e.jsx("p",{className:"text-lg font-medium text-gray-900",children:c.performer||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"User Pengupload"}),e.jsx("p",{className:"text-gray-700",children:c.user_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Status Saat Ini"}),e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full mt-1
                    ${(c.status||"pending")==="accepted"?"bg-green-100 text-green-800":(c.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(c.status||"pending")==="pending"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:c.status||"pending"})]}),c.status==="rejected"&&c.rejection_reason&&e.jsxs("div",{className:"col-span-1 md:col-span-2 bg-red-50 p-3 rounded-lg border border-red-100 mt-2",children:[e.jsxs("label",{className:"text-xs font-semibold text-red-800 uppercase flex items-center mb-1",children:[e.jsx(Ye,{size:14,className:"mr-1"}),"Alasan Penolakan"]}),e.jsx("p",{className:"text-red-900 text-sm",children:c.rejection_reason})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Custom ID (Identitas)"}),e.jsx("p",{className:"text-gray-900 font-mono",children:c.song_id||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 uppercase",children:"ISWC / ISRC"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ISWC: ",c.iswc||"-"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ISRC: ",c.isrc||"-"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-md font-bold text-gray-800 mb-3 border-b pb-2",children:"Writers / Pencipta"}),e.jsx("div",{className:"bg-gray-50 rounded-lg overflow-hidden border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Nama"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-4 py-2 text-right text-xs font-medium text-gray-500 uppercase",children:"Share (%)"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200",children:[c.writers&&c.writers.map((T,C)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:T.name}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-600",children:T.role||"-"}),e.jsxs("td",{className:"px-4 py-2 text-sm text-gray-900 text-right",children:[parseFloat(T.share_percent),"%"]})]},C)),(!c.writers||c.writers.length===0)&&e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-2 text-sm text-gray-500 text-center",children:"No writers data"})})]})]})})]}),(r==null?void 0:r.role)==="admin"&&e.jsxs("div",{className:"bg-purple-50 p-6 rounded-xl border border-purple-100 mt-6",children:[e.jsxs("div",{className:"mb-6 pb-6 border-b border-purple-200",children:[e.jsxs("h4",{className:"text-sm font-bold text-purple-800 mb-3 uppercase tracking-wide flex items-center",children:[e.jsx(ae,{size:16,className:"mr-2"}),"Generate Dokumen"]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("button",{onClick:()=>alert("Fitur Generate Kontrak akan segera hadir!"),className:"flex items-center px-3 py-2 bg-white text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 hover:border-purple-300 transition-all text-sm font-medium shadow-sm",title:"Generate Kontrak",children:[e.jsx(ae,{size:16,className:"mr-2"}),"Generate Kontrak"]}),e.jsxs("button",{onClick:()=>alert("Fitur Generate SKP akan segera hadir!"),className:"flex items-center px-3 py-2 bg-white text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 hover:border-purple-300 transition-all text-sm font-medium shadow-sm",title:"Generate SKP",children:[e.jsx(xs,{size:16,className:"mr-2"}),"Generate SKP"]}),e.jsxs("button",{onClick:()=>alert("Fitur Generate IPL akan segera hadir!"),className:"flex items-center px-3 py-2 bg-white text-purple-700 border border-purple-200 rounded-lg hover:bg-purple-100 hover:border-purple-300 transition-all text-sm font-medium shadow-sm",title:"Generate IPL",children:[e.jsx(ps,{size:16,className:"mr-2"}),"Generate IPL"]})]})]}),e.jsxs("h3",{className:"text-md font-bold text-purple-800 mb-4 flex items-center",children:[e.jsx(pt,{size:18,className:"mr-2"}),"Update Status (Admin/Operator)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:g,onChange:T=>y(T.target.value),className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500 p-2.5 border",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"review",children:"Review"}),e.jsx("option",{value:"accepted",children:"Diterima (Accepted)"}),e.jsx("option",{value:"rejected",children:"Ditolak (Rejected)"})]})]}),g==="accepted"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Custom ID ",e.jsx("span",{className:"text-red-500 ml-1",children:"*Required"})]}),e.jsx("input",{type:"text",value:w,onChange:T=>A(T.target.value),placeholder:"Masukkan Custom ID Lagu",className:`w-full rounded-lg shadow-sm p-2.5 border ${w?"border-gray-300 focus:border-purple-500 focus:ring-purple-500":"border-red-300 focus:border-red-500 focus:ring-red-500 bg-red-50"}`}),!w&&e.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[e.jsx(Ye,{size:12,className:"mr-1"}),"Wajib diisi saat status Diterima"]})]}),g==="rejected"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Alasan Penolakan ",e.jsx("span",{className:"text-red-500 ml-1",children:"*Required"})]}),e.jsx("textarea",{value:v,onChange:T=>b(T.target.value),placeholder:"Masukkan alasan penolakan...",rows:1,className:`w-full rounded-lg shadow-sm p-2.5 border ${v?"border-gray-300 focus:border-purple-500 focus:ring-purple-500":"border-red-300 focus:border-red-500 focus:ring-red-500 bg-red-50"}`}),!v&&e.jsxs("p",{className:"text-red-500 text-xs mt-1 flex items-center",children:[e.jsx(Ye,{size:12,className:"mr-1"}),"Wajib diisi saat status Ditolak"]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs("button",{onClick:X,disabled:_||g==="accepted"&&!w||g==="rejected"&&!v,className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Re,{size:18,className:"mr-2"}),_?"Saving...":"Simpan Perubahan"]})})]})]})]})})]})},Gs=["Pop","Rock","Jazz","Blues","Hip Hop","R&B","Country","Folk","Classical","Electronic","Reggae","Soul","Funk","Disco","Techno","House","Trance","Dubstep","Metal","Punk","Indie","Alternative","Gospel","Latin","K-Pop","J-Pop","Dangdut","Keroncong","Campursari"].sort(),qs=["Indonesia","Malaysia","Singapore","Thailand","Vietnam","Philippines","United States","United Kingdom","Australia","Japan","South Korea","China","India","Canada","Germany","France","Italy","Spain","Netherlands","Brazil","Argentina","Mexico"].sort(),Vt=()=>{const r=be(),{id:t}=et(),[a,s]=h.useState(""),[l,i]=h.useState(""),[n,o]=h.useState(""),[d,p]=h.useState(""),[m,c]=h.useState(""),[x,k]=h.useState(""),[N,g]=h.useState(""),[y,w]=h.useState(""),[A,v]=h.useState(""),[b,_]=h.useState(""),[u,S]=h.useState(""),[j,M]=h.useState(null),[f]=h.useState({synchronization:!0,mechanical:!0,performing:!0,print_right:!0}),[P,E]=h.useState([{name:"",role:"Author & Composer",share_percent:0}]),[z,X]=h.useState([]),[D,F]=h.useState(!1),[B,V]=h.useState([]),[T,C]=h.useState(!1),[I,O]=h.useState(null),[W,Y]=h.useState("");h.useEffect(()=>{me(),t&&ee(t)},[t]);const ee=async L=>{try{const K=(await R.get(`/songs/${L}`)).data;s(K.title),i(K.other_title||""),o(K.performer);const he=parseInt(K.duration);if(p(Math.floor(he/60).toString()),c((he%60).toString()),k(K.genre),g(K.language),w(K.region),v(K.iswc||""),_(K.isrc||""),S(K.note||""),K.writers&&K.writers.length>0&&E(K.writers.map(ye=>({name:ye.name,role:ye.role||"Author & Composer",share_percent:parseFloat(ye.share_percent)}))),K.authorized_rights)try{typeof K.authorized_rights=="string"&&JSON.parse(K.authorized_rights)}catch(ye){console.error("Failed to parse rights",ye)}}catch(H){console.error("Failed to fetch song",H),alert("Failed to fetch song details")}},me=async()=>{try{const L=await R.get("/creators");Array.isArray(L.data)?X(L.data):L.data&&L.data.data&&X(L.data.data)}catch(L){console.error("Failed to fetch creators",L)}},oe=()=>{E([...P,{name:"",role:"Author & Composer",share_percent:0}])},it=L=>{const H=P.filter((K,he)=>he!==L);E(H)},Oe=(L,H,K)=>{const he=[...P];he[L]={...he[L],[H]:K},E(he)},qa=L=>{O(L),Y(""),C(!0)},Va=L=>{I!==null&&(Oe(I,"name",L.name),C(!1),O(null))},Wt=z.filter(L=>L.name.toLowerCase().includes(W.toLowerCase())),Ja=P.reduce((L,H)=>L+Number(H.share_percent||0),0),Qa=async L=>{var $t,Yt;L.preventDefault();const H=[];a.trim()||H.push("Judul Lagu"),n.trim()||H.push("Artis / Performer"),x||H.push("Genre"),N||H.push("Bahasa/Negara"),y||H.push("Region"),!d&&!m&&H.push("Durasi");const K=P.reduce((Ce,es)=>Ce+Number(es.share_percent||0),0);if(K!==100&&H.push(`Total Share Penulis (Saat ini: ${K}%, Wajib: 100%)`),P.some(Ce=>!Ce.name.trim())&&H.push("Nama Penulis (Semua baris penulis wajib diisi)"),H.length>0){V(H),F(!0);return}const ye=parseInt(d||"0")*60+parseInt(m||"0"),Za=JSON.stringify(f),Z=new FormData;Z.append("title",a),Z.append("other_title",l),Z.append("performer",n),Z.append("duration",ye.toString()),Z.append("genre",x),Z.append("language",N),Z.append("region",y),Z.append("iswc",A),Z.append("isrc",b),Z.append("note",u),Z.append("authorized_rights",Za),Z.append("writers",JSON.stringify(P)),j&&Z.append("lyrics",j);try{t?await R.put(`/songs/${t}`,Z,{headers:{"Content-Type":"multipart/form-data"}}):await R.post("/songs",Z,{headers:{"Content-Type":"multipart/form-data"}}),r("/admin/songs")}catch(Ce){console.error(Ce),alert(((Yt=($t=Ce.response)==null?void 0:$t.data)==null?void 0:Yt.message)||"Failed to create song")}};return e.jsxs("div",{className:"bg-white/60 backdrop-blur-md rounded-lg shadow-xl border border-white/40 min-h-[calc(100vh-2rem)]",children:[e.jsx("div",{className:"border-b border-white/30 px-6 py-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:t?"Edit Song":"Add New Song"})}),T&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"bg-purple-50 px-6 py-4 border-b border-purple-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-800 flex items-center",children:[e.jsx(we,{className:"mr-2",size:20}),"Pilih Pencipta (Writer)"]}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(fe,{size:20})})]}),e.jsx("div",{className:"p-4 border-b border-gray-100 bg-gray-50",children:e.jsxs("div",{className:"relative",children:[e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:18}),e.jsx("input",{type:"text",placeholder:"Cari nama pencipta...",className:"w-full pl-10 pr-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",value:W,onChange:L=>Y(L.target.value),autoFocus:!0})]})}),e.jsx("div",{className:"max-h-[300px] overflow-y-auto p-2",children:Wt.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-1",children:Wt.map(L=>e.jsxs("button",{onClick:()=>Va(L),className:"flex items-center w-full px-4 py-3 text-left hover:bg-purple-50 rounded-lg transition-colors group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold mr-3 group-hover:bg-purple-200",children:L.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:L.name}),e.jsx("p",{className:"text-xs text-gray-500",children:L.role||"Writer"})]})]},L.id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"Tidak ada pencipta ditemukan."})})})]})}),D&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"bg-red-50 px-6 py-4 border-b border-red-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-bold text-red-800 flex items-center",children:[e.jsx(us,{className:"mr-2",size:20}),"Data Belum Lengkap"]}),e.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(fe,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-700 mb-4",children:"Mohon lengkapi data berikut sebelum menyimpan:"}),e.jsx("ul",{className:"space-y-2",children:B.map((L,H)=>e.jsxs("li",{className:"flex items-start text-sm text-red-600 bg-red-50 p-2 rounded border border-red-100",children:[e.jsx("span",{className:"mr-2",children:"•"}),L]},H))})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-end",children:e.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium",children:"Saya Mengerti"})})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:Qa,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"glass-input",value:a,onChange:L=>s(L.target.value.toUpperCase()),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Other title"}),e.jsx("input",{type:"text",className:"glass-input",value:l,onChange:L=>i(L.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Authorized Rights"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Synchronization"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Mechanical"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Performing"})]})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:!0,disabled:!0,className:"rounded text-[#7A4A88] focus:ring-[#7A4A88]"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Print right"})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Performer ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"glass-input",value:n,onChange:L=>o(L.target.value.toUpperCase()),required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Duration ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"number",placeholder:"Min",className:"glass-input pr-8",value:d,onChange:L=>p(L.target.value),min:"0",required:!0}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400 text-xs",children:"m"})]}),e.jsx("span",{className:"text-gray-400",children:":"}),e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"number",placeholder:"Sec",className:"glass-input pr-8",value:m,onChange:L=>c(L.target.value),min:"0",max:"59",required:!0}),e.jsx("span",{className:"absolute right-3 top-2.5 text-gray-400 text-xs",children:"s"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Genre ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"glass-input",value:x,onChange:L=>k(L.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Genre"}),Gs.map(L=>e.jsx("option",{value:L,children:L},L))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Language ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"glass-input",value:N,onChange:L=>g(L.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Country/Language"}),qs.map(L=>e.jsx("option",{value:L,children:L},L))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Region ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{className:"glass-input",value:y,onChange:L=>w(L.target.value),required:!0,children:[e.jsx("option",{value:"",children:"Select Region"}),e.jsx("option",{value:"Global",children:"Global"}),e.jsx("option",{value:"Asia",children:"Asia"}),e.jsx("option",{value:"Europe",children:"Europe"}),e.jsx("option",{value:"America",children:"America"}),e.jsx("option",{value:"Oceania",children:"Oceania"}),e.jsx("option",{value:"Africa",children:"Africa"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ISWC"}),e.jsx("input",{type:"text",className:"glass-input",value:A,onChange:L=>v(L.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ISRC"}),e.jsx("input",{type:"text",className:"glass-input",value:b,onChange:L=>_(L.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note"}),e.jsx("textarea",{className:"glass-input",rows:4,value:u,onChange:L=>S(L.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Lyrics & Chord (Doc, Docx, PDF, TXT)"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 flex flex-col items-center justify-center bg-gray-50 hover:bg-gray-100 transition-colors cursor-pointer relative",children:[e.jsx("input",{type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onChange:L=>{L.target.files&&L.target.files[0]&&M(L.target.files[0])},accept:".doc,.docx,.pdf,.txt"}),e.jsx("div",{className:"text-center",children:j?e.jsx("div",{className:"flex items-center text-purple-600",children:e.jsx("span",{className:"font-medium",children:j.name})}):e.jsxs("div",{className:"text-gray-500",children:[e.jsx("p",{className:"font-medium",children:"Click or drag file to upload"}),e.jsx("p",{className:"text-xs mt-1",children:"Supported formats: .doc, .docx, .pdf, .txt"})]})})]})]}),e.jsx("div",{className:"border border-white/40 rounded-md overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/2",children:"Writer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-24",children:"Share"}),e.jsx("th",{className:"px-6 py-3 text-right"})]})}),e.jsxs("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:[P.map((L,H)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{onClick:()=>qa(H),className:"cursor-pointer relative",children:[e.jsx("input",{type:"text",placeholder:"Select Writer",className:"glass-input px-4 py-3 text-base w-full cursor-pointer bg-white/50 hover:bg-white/80 transition-colors",value:L.name,readOnly:!0,required:!0}),e.jsx(le,{size:16,className:"absolute right-3 top-3.5 text-gray-400"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{className:"glass-input px-4 py-3 text-base w-full",value:L.role,onChange:K=>Oe(H,"role",K.target.value),children:[e.jsx("option",{value:"Author & Composer",children:"Author & Composer"}),e.jsx("option",{value:"Author",children:"Author"}),e.jsx("option",{value:"Composer",children:"Composer"}),e.jsx("option",{value:"Arranger",children:"Arranger"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"number",className:"glass-input w-20 px-3 py-3 text-base text-right",value:L.share_percent,onChange:K=>Oe(H,"share_percent",parseFloat(K.target.value)||0)}),e.jsx("span",{className:"ml-2 text-base text-gray-500",children:"%"})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:P.length>1&&e.jsx("button",{type:"button",onClick:()=>it(H),className:"text-red-400 hover:text-red-600 transition-colors",children:e.jsx(Na,{size:18})})})]},H)),e.jsxs("tr",{className:"bg-purple-50/50 font-semibold",children:[e.jsx("td",{colSpan:2,className:"px-6 py-3 text-right",children:"Share Total"}),e.jsxs("td",{className:"px-6 py-3 text-right pr-12 text-[#7A4A88]",children:[Ja,"%"]}),e.jsx("td",{})]})]})]})}),e.jsx("datalist",{id:"creators-list",children:z.map(L=>e.jsx("option",{value:L.name},L.id))}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:oe,className:"glass-button bg-gray-500/50 hover:bg-gray-600/50 text-white text-sm",children:"+ Add Other Writer"})}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",className:"glass-button",children:"Save"})})]})})]})},Vs=({isOpen:r,onClose:t,creator:a})=>{const[s,l]=h.useState([]),[i,n]=h.useState(!1),[o,d]=h.useState(""),[p,m]=h.useState(1),c=10;h.useEffect(()=>{r&&a?(x(),d(""),m(1)):l([])},[r,a]);const x=async()=>{n(!0);try{const w=await R.get(`/songs?writer_name=${encodeURIComponent(a.name)}`);l(w.data)}catch(w){console.error("Failed to fetch songs",w)}finally{n(!1)}},k=s.filter(w=>w.title.toLowerCase().includes(o.toLowerCase())||w.performer&&w.performer.toLowerCase().includes(o.toLowerCase())),N=Math.ceil(k.length/c),g=(p-1)*c,y=k.slice(g,g+c);return!r||!a?null:e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detail Data Pencipta"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-red-500",children:e.jsx(fe,{size:24})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-4 border-b pb-2",children:"Informasi Pribadi"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Nama"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.name]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"NIK"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.nik||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Tgl Lahir"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.birth_date?new Date(a.birth_date).toLocaleDateString("id-ID"):"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Tempat Lahir"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.birth_place||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Alamat"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.address||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Agama"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.religion||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Pekerjaan"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.occupation||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Kewarganegaraan"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.nationality||"-"]})]})]}),e.jsx("h3",{className:"font-semibold text-gray-700 mt-6 mb-4 border-b pb-2",children:"Informasi Bank"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Nama Bank"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.bank_name||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"No. Rekening"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.bank_account_number||"-"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Nama Pemilik"}),e.jsxs("span",{className:"col-span-2 text-gray-900",children:[": ",a.bank_account_name||"-"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-700 mb-4 border-b pb-2",children:"Dokumen"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-gray-600",children:"KTP"}),a.ktp_path?e.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50",children:e.jsx("img",{src:`http://localhost:5000/${a.ktp_path}`,alt:"KTP",className:"w-full h-auto object-contain max-h-64"})}):e.jsx("div",{className:"h-32 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400 text-sm",children:"Tidak ada gambar KTP"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium mb-1 text-gray-600",children:"NPWP"}),a.npwp_path?e.jsx("div",{className:"border rounded-lg overflow-hidden bg-gray-50",children:e.jsx("img",{src:`http://localhost:5000/${a.npwp_path}`,alt:"NPWP",className:"w-full h-auto object-contain max-h-64"})}):e.jsx("div",{className:"h-32 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400 text-sm",children:"Tidak ada gambar NPWP"})]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsxs("h3",{className:"font-semibold text-gray-700",children:["Daftar Lagu (",s.length,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari lagu...",className:"pl-8 pr-3 py-1.5 text-sm border rounded-md focus:ring-purple-500 focus:border-purple-500",value:o,onChange:w=>{d(w.target.value),m(1)}}),e.jsx(le,{className:"absolute left-2.5 top-2 text-gray-400",size:14})]})]}),i?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Memuat lagu..."}):k.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto border rounded-lg mb-3",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Judul"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Artis"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Genre"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map(w=>{var v,b;const A=(b=(v=w.writers)==null?void 0:v.find(_=>_.name===a.name))==null?void 0:b.share_percent;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 text-sm text-gray-900",children:w.title}),e.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:w.performer}),e.jsxs("td",{className:"px-4 py-2 text-sm text-gray-500",children:[w.genre,A&&e.jsxs("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800",children:[A,"%"]})]}),e.jsx("td",{className:"px-4 py-2 text-sm",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold uppercase
                                                    ${w.status==="accepted"?"bg-green-100 text-green-800":w.status==="rejected"?"bg-red-100 text-red-800":w.status==="review"?"bg-orange-100 text-orange-800":"bg-yellow-100 text-yellow-800"}`,children:w.status||"Pending"})})]},w.id)})})]})}),N>1&&e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"text-gray-500",children:["Showing ",g+1," to ",Math.min(g+c,k.length)," of ",k.length," entries"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>m(w=>Math.max(w-1,1)),disabled:p===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:N},(w,A)=>A+1).map(w=>e.jsx("button",{onClick:()=>m(w),className:`px-3 py-1 border rounded ${p===w?"bg-purple-600 text-white border-purple-600":"hover:bg-gray-50"}`,children:w},w)),e.jsx("button",{onClick:()=>m(w=>Math.min(w+1,N)),disabled:p===N,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}):e.jsx("div",{className:"text-center py-4 text-gray-500 bg-gray-50 rounded-lg border border-dashed",children:s.length>0?"Tidak ada lagu yang cocok dengan pencarian.":"Tidak ada lagu yang ditemukan untuk pencipta ini."})]})]}),e.jsx("div",{className:"p-6 border-t bg-gray-50 flex justify-end",children:e.jsx("button",{onClick:t,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300 font-medium",children:"Tutup"})})]})})},Js=()=>{const[r,t]=h.useState([]),[a,s]=h.useState(""),[l,i]=h.useState(null),[n,o]=h.useState(!1),d=h.useRef(null);h.useEffect(()=>{p()},[]);const p=async()=>{try{const y=await R.get("/creators");Array.isArray(y.data)?t(y.data):y.data&&y.data.data&&t(y.data.data)}catch(y){console.error(y),y.response&&y.response.status===401&&alert("Session expired. Please login again.")}},m=async()=>{var y;try{const w=await R.get("/creators/export",{responseType:"blob"}),A=window.URL.createObjectURL(new Blob([w.data])),v=document.createElement("a");v.href=A,v.setAttribute("download","creators.xlsx"),document.body.appendChild(v),v.click(),(y=v.parentNode)==null||y.removeChild(v)}catch(w){console.error("Export failed",w),alert("Failed to export data")}},c=()=>{var y;(y=d.current)==null||y.click()},x=async y=>{var v;const w=(v=y.target.files)==null?void 0:v[0];if(!w)return;const A=new FormData;A.append("file",w);try{const b=await R.post("/creators/import",A,{headers:{"Content-Type":"multipart/form-data"}});alert(b.data.message),b.data.errors&&(console.warn("Import errors:",b.data.errors),alert("Some rows failed to import. Check console for details.")),p()}catch(b){console.error("Import failed",b),alert("Failed to import data")}finally{d.current&&(d.current.value="")}},k=y=>{i(y),o(!0)},N=async y=>{if(confirm("Are you sure you want to delete this creator?"))try{await R.delete(`/creators/${y}`),p()}catch(w){console.error("Failed to delete creator",w),alert("Failed to delete creator")}},g=r.filter(y=>y.name.toLowerCase().includes(a.toLowerCase())||y.nik&&y.nik.includes(a));return e.jsxs("div",{children:[e.jsx(Vs,{isOpen:n,onClose:()=>o(!1),creator:l}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Pencipta"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:m,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors shadow-sm",children:[e.jsx(tt,{size:20,className:"mr-2"}),"Export Excel"]}),e.jsxs("button",{onClick:c,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:[e.jsx(ne,{size:20,className:"mr-2"}),"Import Excel"]}),e.jsx("input",{type:"file",ref:d,className:"hidden",accept:".xlsx, .xls",onChange:x}),e.jsxs(ge,{to:"/admin/creators/add",className:"glass-button flex items-center",children:[e.jsx(ja,{size:20,className:"mr-2"}),"Add Pencipta"]})]})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"p-4 border-b border-white/30",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari nama atau NIK...",className:"glass-input pl-10",value:a,onChange:y=>s(y.target.value)}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Pemilik"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NIK"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tgl Lahir"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alamat"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsxs("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:[g.map((y,w)=>e.jsxs("tr",{className:w%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:y.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.user_name?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:y.user_name}):e.jsx("span",{className:"text-gray-400 italic",children:"Unassigned"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.nik||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:y.birth_date?new Date(y.birth_date).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:y.address||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>k(y),className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"Lihat Data",children:e.jsx(ze,{size:18})}),e.jsx(ge,{to:`/admin/creators/edit/${y.id}`,className:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50 transition-colors",title:"Edit Data",children:e.jsx(pt,{size:18})}),e.jsx("button",{onClick:()=>N(y.id),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50 transition-colors",title:"Delete Data",children:e.jsx(va,{size:18})})]})})]},y.id)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No creators found"})})]})]})})]})]})};/*!
 * Cropper.js v1.6.2
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2024-04-21T07:43:05.335Z
 */function Jt(r,t){var a=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),a.push.apply(a,s)}return a}function Ma(r){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?Jt(Object(a),!0).forEach(function(s){tr(r,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(a)):Jt(Object(a)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(a,s))})}return r}function Qs(r,t){if(typeof r!="object"||!r)return r;var a=r[Symbol.toPrimitive];if(a!==void 0){var s=a.call(r,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}function Ea(r){var t=Qs(r,"string");return typeof t=="symbol"?t:t+""}function ft(r){"@babel/helpers - typeof";return ft=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(r)}function Zs(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Qt(r,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,Ea(s.key),s)}}function er(r,t,a){return t&&Qt(r.prototype,t),a&&Qt(r,a),Object.defineProperty(r,"prototype",{writable:!1}),r}function tr(r,t,a){return t=Ea(t),t in r?Object.defineProperty(r,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[t]=a,r}function Ra(r){return ar(r)||sr(r)||rr(r)||ir()}function ar(r){if(Array.isArray(r))return bt(r)}function sr(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function rr(r,t){if(r){if(typeof r=="string")return bt(r,t);var a=Object.prototype.toString.call(r).slice(8,-1);if(a==="Object"&&r.constructor&&(a=r.constructor.name),a==="Map"||a==="Set")return Array.from(r);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return bt(r,t)}}function bt(r,t){(t==null||t>r.length)&&(t=r.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=r[a];return s}function ir(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var rt=typeof window<"u"&&typeof window.document<"u",de=rt?window:{},It=rt&&de.document.documentElement?"ontouchstart"in de.document.documentElement:!1,Ot=rt?"PointerEvent"in de:!1,G="cropper",Ft="all",za="crop",Ia="move",Oa="zoom",je="e",ve="w",De="s",xe="n",Fe="ne",Be="nw",Ue="se",We="sw",yt="".concat(G,"-crop"),Zt="".concat(G,"-disabled"),se="".concat(G,"-hidden"),ea="".concat(G,"-hide"),nr="".concat(G,"-invisible"),Ze="".concat(G,"-modal"),jt="".concat(G,"-move"),Xe="".concat(G,"Action"),Ge="".concat(G,"Preview"),Bt="crop",Fa="move",Ba="none",vt="crop",Nt="cropend",wt="cropmove",St="cropstart",ta="dblclick",lr=It?"touchstart":"mousedown",or=It?"touchmove":"mousemove",cr=It?"touchend touchcancel":"mouseup",aa=Ot?"pointerdown":lr,sa=Ot?"pointermove":or,ra=Ot?"pointerup pointercancel":cr,ia="ready",na="resize",la="wheel",kt="zoom",oa="image/jpeg",dr=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,mr=/^data:/,hr=/^data:image\/jpeg;base64,/,xr=/^img|canvas$/i,Ua=200,Wa=100,ca={viewMode:0,dragMode:Bt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:Ua,minContainerHeight:Wa,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},pr='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>',ur=Number.isNaN||de.isNaN;function U(r){return typeof r=="number"&&!ur(r)}var da=function(t){return t>0&&t<1/0};function ct(r){return typeof r>"u"}function Se(r){return ft(r)==="object"&&r!==null}var gr=Object.prototype.hasOwnProperty;function _e(r){if(!Se(r))return!1;try{var t=r.constructor,a=t.prototype;return t&&a&&gr.call(a,"isPrototypeOf")}catch{return!1}}function te(r){return typeof r=="function"}var fr=Array.prototype.slice;function $a(r){return Array.from?Array.from(r):fr.call(r)}function J(r,t){return r&&te(t)&&(Array.isArray(r)||U(r.length)?$a(r).forEach(function(a,s){t.call(r,a,s,r)}):Se(r)&&Object.keys(r).forEach(function(a){t.call(r,r[a],a,r)})),r}var q=Object.assign||function(t){for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return Se(t)&&s.length>0&&s.forEach(function(i){Se(i)&&Object.keys(i).forEach(function(n){t[n]=i[n]})}),t},br=/\.\d*(?:0|9){12}\d*$/;function Te(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return br.test(r)?Math.round(r*t)/t:r}var yr=/^width|height|left|top|marginLeft|marginTop$/;function pe(r,t){var a=r.style;J(t,function(s,l){yr.test(l)&&U(s)&&(s="".concat(s,"px")),a[l]=s})}function jr(r,t){return r.classList?r.classList.contains(t):r.className.indexOf(t)>-1}function Q(r,t){if(t){if(U(r.length)){J(r,function(s){Q(s,t)});return}if(r.classList){r.classList.add(t);return}var a=r.className.trim();a?a.indexOf(t)<0&&(r.className="".concat(a," ").concat(t)):r.className=t}}function ce(r,t){if(t){if(U(r.length)){J(r,function(a){ce(a,t)});return}if(r.classList){r.classList.remove(t);return}r.className.indexOf(t)>=0&&(r.className=r.className.replace(t,""))}}function Ae(r,t,a){if(t){if(U(r.length)){J(r,function(s){Ae(s,t,a)});return}a?Q(r,t):ce(r,t)}}var vr=/([a-z\d])([A-Z])/g;function Ut(r){return r.replace(vr,"$1-$2").toLowerCase()}function Ct(r,t){return Se(r[t])?r[t]:r.dataset?r.dataset[t]:r.getAttribute("data-".concat(Ut(t)))}function Ke(r,t,a){Se(a)?r[t]=a:r.dataset?r.dataset[t]=a:r.setAttribute("data-".concat(Ut(t)),a)}function Nr(r,t){if(Se(r[t]))try{delete r[t]}catch{r[t]=void 0}else if(r.dataset)try{delete r.dataset[t]}catch{r.dataset[t]=void 0}else r.removeAttribute("data-".concat(Ut(t)))}var Ya=/\s\s*/,Ha=function(){var r=!1;if(rt){var t=!1,a=function(){},s=Object.defineProperty({},"once",{get:function(){return r=!0,t},set:function(i){t=i}});de.addEventListener("test",a,s),de.removeEventListener("test",a,s)}return r}();function ie(r,t,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=a;t.trim().split(Ya).forEach(function(i){if(!Ha){var n=r.listeners;n&&n[i]&&n[i][a]&&(l=n[i][a],delete n[i][a],Object.keys(n[i]).length===0&&delete n[i],Object.keys(n).length===0&&delete r.listeners)}r.removeEventListener(i,l,s)})}function re(r,t,a){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},l=a;t.trim().split(Ya).forEach(function(i){if(s.once&&!Ha){var n=r.listeners,o=n===void 0?{}:n;l=function(){delete o[i][a],r.removeEventListener(i,l,s);for(var p=arguments.length,m=new Array(p),c=0;c<p;c++)m[c]=arguments[c];a.apply(r,m)},o[i]||(o[i]={}),o[i][a]&&r.removeEventListener(i,o[i][a],s),o[i][a]=l,r.listeners=o}r.addEventListener(i,l,s)})}function Me(r,t,a){var s;return te(Event)&&te(CustomEvent)?s=new CustomEvent(t,{detail:a,bubbles:!0,cancelable:!0}):(s=document.createEvent("CustomEvent"),s.initCustomEvent(t,!0,!0,a)),r.dispatchEvent(s)}function Xa(r){var t=r.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var dt=de.location,wr=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function ma(r){var t=r.match(wr);return t!==null&&(t[1]!==dt.protocol||t[2]!==dt.hostname||t[3]!==dt.port)}function ha(r){var t="timestamp=".concat(new Date().getTime());return r+(r.indexOf("?")===-1?"?":"&")+t}function He(r){var t=r.rotate,a=r.scaleX,s=r.scaleY,l=r.translateX,i=r.translateY,n=[];U(l)&&l!==0&&n.push("translateX(".concat(l,"px)")),U(i)&&i!==0&&n.push("translateY(".concat(i,"px)")),U(t)&&t!==0&&n.push("rotate(".concat(t,"deg)")),U(a)&&a!==1&&n.push("scaleX(".concat(a,")")),U(s)&&s!==1&&n.push("scaleY(".concat(s,")"));var o=n.length?n.join(" "):"none";return{WebkitTransform:o,msTransform:o,transform:o}}function Sr(r){var t=Ma({},r),a=0;return J(r,function(s,l){delete t[l],J(t,function(i){var n=Math.abs(s.startX-i.startX),o=Math.abs(s.startY-i.startY),d=Math.abs(s.endX-i.endX),p=Math.abs(s.endY-i.endY),m=Math.sqrt(n*n+o*o),c=Math.sqrt(d*d+p*p),x=(c-m)/m;Math.abs(x)>Math.abs(a)&&(a=x)})}),a}function qe(r,t){var a=r.pageX,s=r.pageY,l={endX:a,endY:s};return t?l:Ma({startX:a,startY:s},l)}function kr(r){var t=0,a=0,s=0;return J(r,function(l){var i=l.startX,n=l.startY;t+=i,a+=n,s+=1}),t/=s,a/=s,{pageX:t,pageY:a}}function ue(r){var t=r.aspectRatio,a=r.height,s=r.width,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"contain",i=da(s),n=da(a);if(i&&n){var o=a*t;l==="contain"&&o>s||l==="cover"&&o<s?a=s/t:s=a*t}else i?a=s/t:n&&(s=a*t);return{width:s,height:a}}function Cr(r){var t=r.width,a=r.height,s=r.degree;if(s=Math.abs(s)%180,s===90)return{width:a,height:t};var l=s%90*Math.PI/180,i=Math.sin(l),n=Math.cos(l),o=t*n+a*i,d=t*i+a*n;return s>90?{width:d,height:o}:{width:o,height:d}}function Dr(r,t,a,s){var l=t.aspectRatio,i=t.naturalWidth,n=t.naturalHeight,o=t.rotate,d=o===void 0?0:o,p=t.scaleX,m=p===void 0?1:p,c=t.scaleY,x=c===void 0?1:c,k=a.aspectRatio,N=a.naturalWidth,g=a.naturalHeight,y=s.fillColor,w=y===void 0?"transparent":y,A=s.imageSmoothingEnabled,v=A===void 0?!0:A,b=s.imageSmoothingQuality,_=b===void 0?"low":b,u=s.maxWidth,S=u===void 0?1/0:u,j=s.maxHeight,M=j===void 0?1/0:j,f=s.minWidth,P=f===void 0?0:f,E=s.minHeight,z=E===void 0?0:E,X=document.createElement("canvas"),D=X.getContext("2d"),F=ue({aspectRatio:k,width:S,height:M}),B=ue({aspectRatio:k,width:P,height:z},"cover"),V=Math.min(F.width,Math.max(B.width,N)),T=Math.min(F.height,Math.max(B.height,g)),C=ue({aspectRatio:l,width:S,height:M}),I=ue({aspectRatio:l,width:P,height:z},"cover"),O=Math.min(C.width,Math.max(I.width,i)),W=Math.min(C.height,Math.max(I.height,n)),Y=[-O/2,-W/2,O,W];return X.width=Te(V),X.height=Te(T),D.fillStyle=w,D.fillRect(0,0,V,T),D.save(),D.translate(V/2,T/2),D.rotate(d*Math.PI/180),D.scale(m,x),D.imageSmoothingEnabled=v,D.imageSmoothingQuality=_,D.drawImage.apply(D,[r].concat(Ra(Y.map(function(ee){return Math.floor(Te(ee))})))),D.restore(),X}var Ka=String.fromCharCode;function _r(r,t,a){var s="";a+=t;for(var l=t;l<a;l+=1)s+=Ka(r.getUint8(l));return s}var Ar=/^data:.*,/;function Pr(r){var t=r.replace(Ar,""),a=atob(t),s=new ArrayBuffer(a.length),l=new Uint8Array(s);return J(l,function(i,n){l[n]=a.charCodeAt(n)}),s}function Lr(r,t){for(var a=[],s=8192,l=new Uint8Array(r);l.length>0;)a.push(Ka.apply(null,$a(l.subarray(0,s)))),l=l.subarray(s);return"data:".concat(t,";base64,").concat(btoa(a.join("")))}function Tr(r){var t=new DataView(r),a;try{var s,l,i;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(var n=t.byteLength,o=2;o+1<n;){if(t.getUint8(o)===255&&t.getUint8(o+1)===225){l=o;break}o+=1}if(l){var d=l+4,p=l+10;if(_r(t,d,4)==="Exif"){var m=t.getUint16(p);if(s=m===18761,(s||m===19789)&&t.getUint16(p+2,s)===42){var c=t.getUint32(p+4,s);c>=8&&(i=p+c)}}}if(i){var x=t.getUint16(i,s),k,N;for(N=0;N<x;N+=1)if(k=i+N*12+2,t.getUint16(k,s)===274){k+=8,a=t.getUint16(k,s),t.setUint16(k,1,s);break}}}catch{a=1}return a}function Mr(r){var t=0,a=1,s=1;switch(r){case 2:a=-1;break;case 3:t=-180;break;case 4:s=-1;break;case 5:t=90,s=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:a,scaleY:s}}var Er={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,a=this.options,s=this.container,l=this.cropper,i=Number(a.minContainerWidth),n=Number(a.minContainerHeight);Q(l,se),ce(t,se);var o={width:Math.max(s.offsetWidth,i>=0?i:Ua),height:Math.max(s.offsetHeight,n>=0?n:Wa)};this.containerData=o,pe(l,{width:o.width,height:o.height}),Q(t,se),ce(l,se)},initCanvas:function(){var t=this.containerData,a=this.imageData,s=this.options.viewMode,l=Math.abs(a.rotate)%180===90,i=l?a.naturalHeight:a.naturalWidth,n=l?a.naturalWidth:a.naturalHeight,o=i/n,d=t.width,p=t.height;t.height*o>t.width?s===3?d=t.height*o:p=t.width/o:s===3?p=t.width/o:d=t.height*o;var m={aspectRatio:o,naturalWidth:i,naturalHeight:n,width:d,height:p};this.canvasData=m,this.limited=s===1||s===2,this.limitCanvas(!0,!0),m.width=Math.min(Math.max(m.width,m.minWidth),m.maxWidth),m.height=Math.min(Math.max(m.height,m.minHeight),m.maxHeight),m.left=(t.width-m.width)/2,m.top=(t.height-m.height)/2,m.oldLeft=m.left,m.oldTop=m.top,this.initialCanvasData=q({},m)},limitCanvas:function(t,a){var s=this.options,l=this.containerData,i=this.canvasData,n=this.cropBoxData,o=s.viewMode,d=i.aspectRatio,p=this.cropped&&n;if(t){var m=Number(s.minCanvasWidth)||0,c=Number(s.minCanvasHeight)||0;o>1?(m=Math.max(m,l.width),c=Math.max(c,l.height),o===3&&(c*d>m?m=c*d:c=m/d)):o>0&&(m?m=Math.max(m,p?n.width:0):c?c=Math.max(c,p?n.height:0):p&&(m=n.width,c=n.height,c*d>m?m=c*d:c=m/d));var x=ue({aspectRatio:d,width:m,height:c});m=x.width,c=x.height,i.minWidth=m,i.minHeight=c,i.maxWidth=1/0,i.maxHeight=1/0}if(a)if(o>(p?0:1)){var k=l.width-i.width,N=l.height-i.height;i.minLeft=Math.min(0,k),i.minTop=Math.min(0,N),i.maxLeft=Math.max(0,k),i.maxTop=Math.max(0,N),p&&this.limited&&(i.minLeft=Math.min(n.left,n.left+(n.width-i.width)),i.minTop=Math.min(n.top,n.top+(n.height-i.height)),i.maxLeft=n.left,i.maxTop=n.top,o===2&&(i.width>=l.width&&(i.minLeft=Math.min(0,k),i.maxLeft=Math.max(0,k)),i.height>=l.height&&(i.minTop=Math.min(0,N),i.maxTop=Math.max(0,N))))}else i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=l.width,i.maxTop=l.height},renderCanvas:function(t,a){var s=this.canvasData,l=this.imageData;if(a){var i=Cr({width:l.naturalWidth*Math.abs(l.scaleX||1),height:l.naturalHeight*Math.abs(l.scaleY||1),degree:l.rotate||0}),n=i.width,o=i.height,d=s.width*(n/s.naturalWidth),p=s.height*(o/s.naturalHeight);s.left-=(d-s.width)/2,s.top-=(p-s.height)/2,s.width=d,s.height=p,s.aspectRatio=n/o,s.naturalWidth=n,s.naturalHeight=o,this.limitCanvas(!0,!1)}(s.width>s.maxWidth||s.width<s.minWidth)&&(s.left=s.oldLeft),(s.height>s.maxHeight||s.height<s.minHeight)&&(s.top=s.oldTop),s.width=Math.min(Math.max(s.width,s.minWidth),s.maxWidth),s.height=Math.min(Math.max(s.height,s.minHeight),s.maxHeight),this.limitCanvas(!1,!0),s.left=Math.min(Math.max(s.left,s.minLeft),s.maxLeft),s.top=Math.min(Math.max(s.top,s.minTop),s.maxTop),s.oldLeft=s.left,s.oldTop=s.top,pe(this.canvas,q({width:s.width,height:s.height},He({translateX:s.left,translateY:s.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var a=this.canvasData,s=this.imageData,l=s.naturalWidth*(a.width/a.naturalWidth),i=s.naturalHeight*(a.height/a.naturalHeight);q(s,{width:l,height:i,left:(a.width-l)/2,top:(a.height-i)/2}),pe(this.image,q({width:s.width,height:s.height},He(q({translateX:s.left,translateY:s.top},s)))),t&&this.output()},initCropBox:function(){var t=this.options,a=this.canvasData,s=t.aspectRatio||t.initialAspectRatio,l=Number(t.autoCropArea)||.8,i={width:a.width,height:a.height};s&&(a.height*s>a.width?i.height=i.width/s:i.width=i.height*s),this.cropBoxData=i,this.limitCropBox(!0,!0),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),i.width=Math.max(i.minWidth,i.width*l),i.height=Math.max(i.minHeight,i.height*l),i.left=a.left+(a.width-i.width)/2,i.top=a.top+(a.height-i.height)/2,i.oldLeft=i.left,i.oldTop=i.top,this.initialCropBoxData=q({},i)},limitCropBox:function(t,a){var s=this.options,l=this.containerData,i=this.canvasData,n=this.cropBoxData,o=this.limited,d=s.aspectRatio;if(t){var p=Number(s.minCropBoxWidth)||0,m=Number(s.minCropBoxHeight)||0,c=o?Math.min(l.width,i.width,i.width+i.left,l.width-i.left):l.width,x=o?Math.min(l.height,i.height,i.height+i.top,l.height-i.top):l.height;p=Math.min(p,l.width),m=Math.min(m,l.height),d&&(p&&m?m*d>p?m=p/d:p=m*d:p?m=p/d:m&&(p=m*d),x*d>c?x=c/d:c=x*d),n.minWidth=Math.min(p,c),n.minHeight=Math.min(m,x),n.maxWidth=c,n.maxHeight=x}a&&(o?(n.minLeft=Math.max(0,i.left),n.minTop=Math.max(0,i.top),n.maxLeft=Math.min(l.width,i.left+i.width)-n.width,n.maxTop=Math.min(l.height,i.top+i.height)-n.height):(n.minLeft=0,n.minTop=0,n.maxLeft=l.width-n.width,n.maxTop=l.height-n.height))},renderCropBox:function(){var t=this.options,a=this.containerData,s=this.cropBoxData;(s.width>s.maxWidth||s.width<s.minWidth)&&(s.left=s.oldLeft),(s.height>s.maxHeight||s.height<s.minHeight)&&(s.top=s.oldTop),s.width=Math.min(Math.max(s.width,s.minWidth),s.maxWidth),s.height=Math.min(Math.max(s.height,s.minHeight),s.maxHeight),this.limitCropBox(!1,!0),s.left=Math.min(Math.max(s.left,s.minLeft),s.maxLeft),s.top=Math.min(Math.max(s.top,s.minTop),s.maxTop),s.oldLeft=s.left,s.oldTop=s.top,t.movable&&t.cropBoxMovable&&Ke(this.face,Xe,s.width>=a.width&&s.height>=a.height?Ia:Ft),pe(this.cropBox,q({width:s.width,height:s.height},He({translateX:s.left,translateY:s.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Me(this.element,vt,this.getData())}},Rr={initPreview:function(){var t=this.element,a=this.crossOrigin,s=this.options.preview,l=a?this.crossOriginUrl:this.url,i=t.alt||"The image to preview",n=document.createElement("img");if(a&&(n.crossOrigin=a),n.src=l,n.alt=i,this.viewBox.appendChild(n),this.viewBoxImage=n,!!s){var o=s;typeof s=="string"?o=t.ownerDocument.querySelectorAll(s):s.querySelector&&(o=[s]),this.previews=o,J(o,function(d){var p=document.createElement("img");Ke(d,Ge,{width:d.offsetWidth,height:d.offsetHeight,html:d.innerHTML}),a&&(p.crossOrigin=a),p.src=l,p.alt=i,p.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',d.innerHTML="",d.appendChild(p)})}},resetPreview:function(){J(this.previews,function(t){var a=Ct(t,Ge);pe(t,{width:a.width,height:a.height}),t.innerHTML=a.html,Nr(t,Ge)})},preview:function(){var t=this.imageData,a=this.canvasData,s=this.cropBoxData,l=s.width,i=s.height,n=t.width,o=t.height,d=s.left-a.left-t.left,p=s.top-a.top-t.top;!this.cropped||this.disabled||(pe(this.viewBoxImage,q({width:n,height:o},He(q({translateX:-d,translateY:-p},t)))),J(this.previews,function(m){var c=Ct(m,Ge),x=c.width,k=c.height,N=x,g=k,y=1;l&&(y=x/l,g=i*y),i&&g>k&&(y=k/i,N=l*y,g=k),pe(m,{width:N,height:g}),pe(m.getElementsByTagName("img")[0],q({width:n*y,height:o*y},He(q({translateX:-d*y,translateY:-p*y},t))))}))}},zr={bind:function(){var t=this.element,a=this.options,s=this.cropper;te(a.cropstart)&&re(t,St,a.cropstart),te(a.cropmove)&&re(t,wt,a.cropmove),te(a.cropend)&&re(t,Nt,a.cropend),te(a.crop)&&re(t,vt,a.crop),te(a.zoom)&&re(t,kt,a.zoom),re(s,aa,this.onCropStart=this.cropStart.bind(this)),a.zoomable&&a.zoomOnWheel&&re(s,la,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&re(s,ta,this.onDblclick=this.dblclick.bind(this)),re(t.ownerDocument,sa,this.onCropMove=this.cropMove.bind(this)),re(t.ownerDocument,ra,this.onCropEnd=this.cropEnd.bind(this)),a.responsive&&re(window,na,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,a=this.options,s=this.cropper;te(a.cropstart)&&ie(t,St,a.cropstart),te(a.cropmove)&&ie(t,wt,a.cropmove),te(a.cropend)&&ie(t,Nt,a.cropend),te(a.crop)&&ie(t,vt,a.crop),te(a.zoom)&&ie(t,kt,a.zoom),ie(s,aa,this.onCropStart),a.zoomable&&a.zoomOnWheel&&ie(s,la,this.onWheel,{passive:!1,capture:!0}),a.toggleDragModeOnDblclick&&ie(s,ta,this.onDblclick),ie(t.ownerDocument,sa,this.onCropMove),ie(t.ownerDocument,ra,this.onCropEnd),a.responsive&&ie(window,na,this.onResize)}},Ir={resize:function(){if(!this.disabled){var t=this.options,a=this.container,s=this.containerData,l=a.offsetWidth/s.width,i=a.offsetHeight/s.height,n=Math.abs(l-1)>Math.abs(i-1)?l:i;if(n!==1){var o,d;t.restore&&(o=this.getCanvasData(),d=this.getCropBoxData()),this.render(),t.restore&&(this.setCanvasData(J(o,function(p,m){o[m]=p*n})),this.setCropBoxData(J(d,function(p,m){d[m]=p*n})))}}},dblclick:function(){this.disabled||this.options.dragMode===Ba||this.setDragMode(jr(this.dragBox,yt)?Fa:Bt)},wheel:function(t){var a=this,s=Number(this.options.wheelZoomRatio)||.1,l=1;this.disabled||(t.preventDefault(),!this.wheeling&&(this.wheeling=!0,setTimeout(function(){a.wheeling=!1},50),t.deltaY?l=t.deltaY>0?1:-1:t.wheelDelta?l=-t.wheelDelta/120:t.detail&&(l=t.detail>0?1:-1),this.zoom(-l*s,t)))},cropStart:function(t){var a=t.buttons,s=t.button;if(!(this.disabled||(t.type==="mousedown"||t.type==="pointerdown"&&t.pointerType==="mouse")&&(U(a)&&a!==1||U(s)&&s!==0||t.ctrlKey))){var l=this.options,i=this.pointers,n;t.changedTouches?J(t.changedTouches,function(o){i[o.identifier]=qe(o)}):i[t.pointerId||0]=qe(t),Object.keys(i).length>1&&l.zoomable&&l.zoomOnTouch?n=Oa:n=Ct(t.target,Xe),dr.test(n)&&Me(this.element,St,{originalEvent:t,action:n})!==!1&&(t.preventDefault(),this.action=n,this.cropping=!1,n===za&&(this.cropping=!0,Q(this.dragBox,Ze)))}},cropMove:function(t){var a=this.action;if(!(this.disabled||!a)){var s=this.pointers;t.preventDefault(),Me(this.element,wt,{originalEvent:t,action:a})!==!1&&(t.changedTouches?J(t.changedTouches,function(l){q(s[l.identifier]||{},qe(l,!0))}):q(s[t.pointerId||0]||{},qe(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var a=this.action,s=this.pointers;t.changedTouches?J(t.changedTouches,function(l){delete s[l.identifier]}):delete s[t.pointerId||0],a&&(t.preventDefault(),Object.keys(s).length||(this.action=""),this.cropping&&(this.cropping=!1,Ae(this.dragBox,Ze,this.cropped&&this.options.modal)),Me(this.element,Nt,{originalEvent:t,action:a}))}}},Or={change:function(t){var a=this.options,s=this.canvasData,l=this.containerData,i=this.cropBoxData,n=this.pointers,o=this.action,d=a.aspectRatio,p=i.left,m=i.top,c=i.width,x=i.height,k=p+c,N=m+x,g=0,y=0,w=l.width,A=l.height,v=!0,b;!d&&t.shiftKey&&(d=c&&x?c/x:1),this.limited&&(g=i.minLeft,y=i.minTop,w=g+Math.min(l.width,s.width,s.left+s.width),A=y+Math.min(l.height,s.height,s.top+s.height));var _=n[Object.keys(n)[0]],u={x:_.endX-_.startX,y:_.endY-_.startY},S=function(M){switch(M){case je:k+u.x>w&&(u.x=w-k);break;case ve:p+u.x<g&&(u.x=g-p);break;case xe:m+u.y<y&&(u.y=y-m);break;case De:N+u.y>A&&(u.y=A-N);break}};switch(o){case Ft:p+=u.x,m+=u.y;break;case je:if(u.x>=0&&(k>=w||d&&(m<=y||N>=A))){v=!1;break}S(je),c+=u.x,c<0&&(o=ve,c=-c,p-=c),d&&(x=c/d,m+=(i.height-x)/2);break;case xe:if(u.y<=0&&(m<=y||d&&(p<=g||k>=w))){v=!1;break}S(xe),x-=u.y,m+=u.y,x<0&&(o=De,x=-x,m-=x),d&&(c=x*d,p+=(i.width-c)/2);break;case ve:if(u.x<=0&&(p<=g||d&&(m<=y||N>=A))){v=!1;break}S(ve),c-=u.x,p+=u.x,c<0&&(o=je,c=-c,p-=c),d&&(x=c/d,m+=(i.height-x)/2);break;case De:if(u.y>=0&&(N>=A||d&&(p<=g||k>=w))){v=!1;break}S(De),x+=u.y,x<0&&(o=xe,x=-x,m-=x),d&&(c=x*d,p+=(i.width-c)/2);break;case Fe:if(d){if(u.y<=0&&(m<=y||k>=w)){v=!1;break}S(xe),x-=u.y,m+=u.y,c=x*d}else S(xe),S(je),u.x>=0?k<w?c+=u.x:u.y<=0&&m<=y&&(v=!1):c+=u.x,u.y<=0?m>y&&(x-=u.y,m+=u.y):(x-=u.y,m+=u.y);c<0&&x<0?(o=We,x=-x,c=-c,m-=x,p-=c):c<0?(o=Be,c=-c,p-=c):x<0&&(o=Ue,x=-x,m-=x);break;case Be:if(d){if(u.y<=0&&(m<=y||p<=g)){v=!1;break}S(xe),x-=u.y,m+=u.y,c=x*d,p+=i.width-c}else S(xe),S(ve),u.x<=0?p>g?(c-=u.x,p+=u.x):u.y<=0&&m<=y&&(v=!1):(c-=u.x,p+=u.x),u.y<=0?m>y&&(x-=u.y,m+=u.y):(x-=u.y,m+=u.y);c<0&&x<0?(o=Ue,x=-x,c=-c,m-=x,p-=c):c<0?(o=Fe,c=-c,p-=c):x<0&&(o=We,x=-x,m-=x);break;case We:if(d){if(u.x<=0&&(p<=g||N>=A)){v=!1;break}S(ve),c-=u.x,p+=u.x,x=c/d}else S(De),S(ve),u.x<=0?p>g?(c-=u.x,p+=u.x):u.y>=0&&N>=A&&(v=!1):(c-=u.x,p+=u.x),u.y>=0?N<A&&(x+=u.y):x+=u.y;c<0&&x<0?(o=Fe,x=-x,c=-c,m-=x,p-=c):c<0?(o=Ue,c=-c,p-=c):x<0&&(o=Be,x=-x,m-=x);break;case Ue:if(d){if(u.x>=0&&(k>=w||N>=A)){v=!1;break}S(je),c+=u.x,x=c/d}else S(De),S(je),u.x>=0?k<w?c+=u.x:u.y>=0&&N>=A&&(v=!1):c+=u.x,u.y>=0?N<A&&(x+=u.y):x+=u.y;c<0&&x<0?(o=Be,x=-x,c=-c,m-=x,p-=c):c<0?(o=We,c=-c,p-=c):x<0&&(o=Fe,x=-x,m-=x);break;case Ia:this.move(u.x,u.y),v=!1;break;case Oa:this.zoom(Sr(n),t),v=!1;break;case za:if(!u.x||!u.y){v=!1;break}b=Xa(this.cropper),p=_.startX-b.left,m=_.startY-b.top,c=i.minWidth,x=i.minHeight,u.x>0?o=u.y>0?Ue:Fe:u.x<0&&(p-=c,o=u.y>0?We:Be),u.y<0&&(m-=x),this.cropped||(ce(this.cropBox,se),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0));break}v&&(i.width=c,i.height=x,i.left=p,i.top=m,this.action=o,this.renderCropBox()),J(n,function(j){j.startX=j.endX,j.startY=j.endY})}},Fr={crop:function(){return this.ready&&!this.cropped&&!this.disabled&&(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&Q(this.dragBox,Ze),ce(this.cropBox,se),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=q({},this.initialImageData),this.canvasData=q({},this.initialCanvasData),this.cropBoxData=q({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(q(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ce(this.dragBox,Ze),Q(this.cropBox,se)),this},replace:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return!this.disabled&&t&&(this.isImg&&(this.element.src=t),a?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,J(this.previews,function(s){s.getElementsByTagName("img")[0].src=t}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ce(this.cropper,Zt)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,Q(this.cropper,Zt)),this},destroy:function(){var t=this.element;return t[G]?(t[G]=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,s=this.canvasData,l=s.left,i=s.top;return this.moveTo(ct(t)?t:l+Number(t),ct(a)?a:i+Number(a))},moveTo:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,s=this.canvasData,l=!1;return t=Number(t),a=Number(a),this.ready&&!this.disabled&&this.options.movable&&(U(t)&&(s.left=t,l=!0),U(a)&&(s.top=a,l=!0),l&&this.renderCanvas(!0)),this},zoom:function(t,a){var s=this.canvasData;return t=Number(t),t<0?t=1/(1-t):t=1+t,this.zoomTo(s.width*t/s.naturalWidth,null,a)},zoomTo:function(t,a,s){var l=this.options,i=this.canvasData,n=i.width,o=i.height,d=i.naturalWidth,p=i.naturalHeight;if(t=Number(t),t>=0&&this.ready&&!this.disabled&&l.zoomable){var m=d*t,c=p*t;if(Me(this.element,kt,{ratio:t,oldRatio:n/d,originalEvent:s})===!1)return this;if(s){var x=this.pointers,k=Xa(this.cropper),N=x&&Object.keys(x).length?kr(x):{pageX:s.pageX,pageY:s.pageY};i.left-=(m-n)*((N.pageX-k.left-i.left)/n),i.top-=(c-o)*((N.pageY-k.top-i.top)/o)}else _e(a)&&U(a.x)&&U(a.y)?(i.left-=(m-n)*((a.x-i.left)/n),i.top-=(c-o)*((a.y-i.top)/o)):(i.left-=(m-n)/2,i.top-=(c-o)/2);i.width=m,i.height=c,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return t=Number(t),U(t)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var a=this.imageData.scaleY;return this.scale(t,U(a)?a:1)},scaleY:function(t){var a=this.imageData.scaleX;return this.scale(U(a)?a:1,t)},scale:function(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t,s=this.imageData,l=!1;return t=Number(t),a=Number(a),this.ready&&!this.disabled&&this.options.scalable&&(U(t)&&(s.scaleX=t,l=!0),U(a)&&(s.scaleY=a,l=!0),l&&this.renderCanvas(!0,!0)),this},getData:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,a=this.options,s=this.imageData,l=this.canvasData,i=this.cropBoxData,n;if(this.ready&&this.cropped){n={x:i.left-l.left,y:i.top-l.top,width:i.width,height:i.height};var o=s.width/s.naturalWidth;if(J(n,function(m,c){n[c]=m/o}),t){var d=Math.round(n.y+n.height),p=Math.round(n.x+n.width);n.x=Math.round(n.x),n.y=Math.round(n.y),n.width=p-n.x,n.height=d-n.y}}else n={x:0,y:0,width:0,height:0};return a.rotatable&&(n.rotate=s.rotate||0),a.scalable&&(n.scaleX=s.scaleX||1,n.scaleY=s.scaleY||1),n},setData:function(t){var a=this.options,s=this.imageData,l=this.canvasData,i={};if(this.ready&&!this.disabled&&_e(t)){var n=!1;a.rotatable&&U(t.rotate)&&t.rotate!==s.rotate&&(s.rotate=t.rotate,n=!0),a.scalable&&(U(t.scaleX)&&t.scaleX!==s.scaleX&&(s.scaleX=t.scaleX,n=!0),U(t.scaleY)&&t.scaleY!==s.scaleY&&(s.scaleY=t.scaleY,n=!0)),n&&this.renderCanvas(!0,!0);var o=s.width/s.naturalWidth;U(t.x)&&(i.left=t.x*o+l.left),U(t.y)&&(i.top=t.y*o+l.top),U(t.width)&&(i.width=t.width*o),U(t.height)&&(i.height=t.height*o),this.setCropBoxData(i)}return this},getContainerData:function(){return this.ready?q({},this.containerData):{}},getImageData:function(){return this.sized?q({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,a={};return this.ready&&J(["left","top","width","height","naturalWidth","naturalHeight"],function(s){a[s]=t[s]}),a},setCanvasData:function(t){var a=this.canvasData,s=a.aspectRatio;return this.ready&&!this.disabled&&_e(t)&&(U(t.left)&&(a.left=t.left),U(t.top)&&(a.top=t.top),U(t.width)?(a.width=t.width,a.height=t.width/s):U(t.height)&&(a.height=t.height,a.width=t.height*s),this.renderCanvas(!0)),this},getCropBoxData:function(){var t=this.cropBoxData,a;return this.ready&&this.cropped&&(a={left:t.left,top:t.top,width:t.width,height:t.height}),a||{}},setCropBoxData:function(t){var a=this.cropBoxData,s=this.options.aspectRatio,l,i;return this.ready&&this.cropped&&!this.disabled&&_e(t)&&(U(t.left)&&(a.left=t.left),U(t.top)&&(a.top=t.top),U(t.width)&&t.width!==a.width&&(l=!0,a.width=t.width),U(t.height)&&t.height!==a.height&&(i=!0,a.height=t.height),s&&(l?a.height=a.width/s:i&&(a.width=a.height*s)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var a=this.canvasData,s=Dr(this.image,this.imageData,a,t);if(!this.cropped)return s;var l=this.getData(t.rounded),i=l.x,n=l.y,o=l.width,d=l.height,p=s.width/Math.floor(a.naturalWidth);p!==1&&(i*=p,n*=p,o*=p,d*=p);var m=o/d,c=ue({aspectRatio:m,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),x=ue({aspectRatio:m,width:t.minWidth||0,height:t.minHeight||0},"cover"),k=ue({aspectRatio:m,width:t.width||(p!==1?s.width:o),height:t.height||(p!==1?s.height:d)}),N=k.width,g=k.height;N=Math.min(c.width,Math.max(x.width,N)),g=Math.min(c.height,Math.max(x.height,g));var y=document.createElement("canvas"),w=y.getContext("2d");y.width=Te(N),y.height=Te(g),w.fillStyle=t.fillColor||"transparent",w.fillRect(0,0,N,g);var A=t.imageSmoothingEnabled,v=A===void 0?!0:A,b=t.imageSmoothingQuality;w.imageSmoothingEnabled=v,b&&(w.imageSmoothingQuality=b);var _=s.width,u=s.height,S=i,j=n,M,f,P,E,z,X;S<=-o||S>_?(S=0,M=0,P=0,z=0):S<=0?(P=-S,S=0,M=Math.min(_,o+S),z=M):S<=_&&(P=0,M=Math.min(o,_-S),z=M),M<=0||j<=-d||j>u?(j=0,f=0,E=0,X=0):j<=0?(E=-j,j=0,f=Math.min(u,d+j),X=f):j<=u&&(E=0,f=Math.min(d,u-j),X=f);var D=[S,j,M,f];if(z>0&&X>0){var F=N/o;D.push(P*F,E*F,z*F,X*F)}return w.drawImage.apply(w,[s].concat(Ra(D.map(function(B){return Math.floor(Te(B))})))),y},setAspectRatio:function(t){var a=this.options;return!this.disabled&&!ct(t)&&(a.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var a=this.options,s=this.dragBox,l=this.face;if(this.ready&&!this.disabled){var i=t===Bt,n=a.movable&&t===Fa;t=i||n?t:Ba,a.dragMode=t,Ke(s,Xe,t),Ae(s,yt,i),Ae(s,jt,n),a.cropBoxMovable||(Ke(l,Xe,t),Ae(l,yt,i),Ae(l,jt,n))}return this}},Br=de.Cropper,Ga=function(){function r(t){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(Zs(this,r),!t||!xr.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=q({},ca,_e(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return er(r,[{key:"init",value:function(){var a=this.element,s=a.tagName.toLowerCase(),l;if(!a[G]){if(a[G]=this,s==="img"){if(this.isImg=!0,l=a.getAttribute("src")||"",this.originalUrl=l,!l)return;l=a.src}else s==="canvas"&&window.HTMLCanvasElement&&(l=a.toDataURL());this.load(l)}}},{key:"load",value:function(a){var s=this;if(a){this.url=a,this.imageData={};var l=this.element,i=this.options;if(!i.rotatable&&!i.scalable&&(i.checkOrientation=!1),!i.checkOrientation||!window.ArrayBuffer){this.clone();return}if(mr.test(a)){hr.test(a)?this.read(Pr(a)):this.clone();return}var n=new XMLHttpRequest,o=this.clone.bind(this);this.reloading=!0,this.xhr=n,n.onabort=o,n.onerror=o,n.ontimeout=o,n.onprogress=function(){n.getResponseHeader("content-type")!==oa&&n.abort()},n.onload=function(){s.read(n.response)},n.onloadend=function(){s.reloading=!1,s.xhr=null},i.checkCrossOrigin&&ma(a)&&l.crossOrigin&&(a=ha(a)),n.open("GET",a,!0),n.responseType="arraybuffer",n.withCredentials=l.crossOrigin==="use-credentials",n.send()}}},{key:"read",value:function(a){var s=this.options,l=this.imageData,i=Tr(a),n=0,o=1,d=1;if(i>1){this.url=Lr(a,oa);var p=Mr(i);n=p.rotate,o=p.scaleX,d=p.scaleY}s.rotatable&&(l.rotate=n),s.scalable&&(l.scaleX=o,l.scaleY=d),this.clone()}},{key:"clone",value:function(){var a=this.element,s=this.url,l=a.crossOrigin,i=s;this.options.checkCrossOrigin&&ma(s)&&(l||(l="anonymous"),i=ha(s)),this.crossOrigin=l,this.crossOriginUrl=i;var n=document.createElement("img");l&&(n.crossOrigin=l),n.src=i||s,n.alt=a.alt||"The image to crop",this.image=n,n.onload=this.start.bind(this),n.onerror=this.stop.bind(this),Q(n,ea),a.parentNode.insertBefore(n,a.nextSibling)}},{key:"start",value:function(){var a=this,s=this.image;s.onload=null,s.onerror=null,this.sizing=!0;var l=de.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(de.navigator.userAgent),i=function(p,m){q(a.imageData,{naturalWidth:p,naturalHeight:m,aspectRatio:p/m}),a.initialImageData=q({},a.imageData),a.sizing=!1,a.sized=!0,a.build()};if(s.naturalWidth&&!l){i(s.naturalWidth,s.naturalHeight);return}var n=document.createElement("img"),o=document.body||document.documentElement;this.sizingImage=n,n.onload=function(){i(n.width,n.height),l||o.removeChild(n)},n.src=s.src,l||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",o.appendChild(n))}},{key:"stop",value:function(){var a=this.image;a.onload=null,a.onerror=null,a.parentNode.removeChild(a),this.image=null}},{key:"build",value:function(){if(!(!this.sized||this.ready)){var a=this.element,s=this.options,l=this.image,i=a.parentNode,n=document.createElement("div");n.innerHTML=pr;var o=n.querySelector(".".concat(G,"-container")),d=o.querySelector(".".concat(G,"-canvas")),p=o.querySelector(".".concat(G,"-drag-box")),m=o.querySelector(".".concat(G,"-crop-box")),c=m.querySelector(".".concat(G,"-face"));this.container=i,this.cropper=o,this.canvas=d,this.dragBox=p,this.cropBox=m,this.viewBox=o.querySelector(".".concat(G,"-view-box")),this.face=c,d.appendChild(l),Q(a,se),i.insertBefore(o,a.nextSibling),ce(l,ea),this.initPreview(),this.bind(),s.initialAspectRatio=Math.max(0,s.initialAspectRatio)||NaN,s.aspectRatio=Math.max(0,s.aspectRatio)||NaN,s.viewMode=Math.max(0,Math.min(3,Math.round(s.viewMode)))||0,Q(m,se),s.guides||Q(m.getElementsByClassName("".concat(G,"-dashed")),se),s.center||Q(m.getElementsByClassName("".concat(G,"-center")),se),s.background&&Q(o,"".concat(G,"-bg")),s.highlight||Q(c,nr),s.cropBoxMovable&&(Q(c,jt),Ke(c,Xe,Ft)),s.cropBoxResizable||(Q(m.getElementsByClassName("".concat(G,"-line")),se),Q(m.getElementsByClassName("".concat(G,"-point")),se)),this.render(),this.ready=!0,this.setDragMode(s.dragMode),s.autoCrop&&this.crop(),this.setData(s.data),te(s.ready)&&re(a,ia,s.ready,{once:!0}),Me(a,ia)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var a=this.cropper.parentNode;a&&a.removeChild(this.cropper),ce(this.element,se)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=Br,r}},{key:"setDefaults",value:function(a){q(ca,_e(a)&&a)}}])}();q(Ga.prototype,Er,Rr,zr,Ir,Or,Fr);var Ne=function(){return Ne=Object.assign||function(r){for(var t,a=1,s=arguments.length;a<s;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(r[l]=t[l]);return r},Ne.apply(this,arguments)};function mt(r,t){var a={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&t.indexOf(s)<0&&(a[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var l=0;for(s=Object.getOwnPropertySymbols(r);l<s.length;l++)t.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(r,s[l])&&(a[s[l]]=r[s[l]])}return a}var Ur=["aspectRatio","autoCrop","autoCropArea","background","center","checkCrossOrigin","checkOrientation","cropBoxMovable","cropBoxResizable","data","dragMode","guides","highlight","initialAspectRatio","minCanvasHeight","minCanvasWidth","minContainerHeight","minContainerWidth","minCropBoxHeight","minCropBoxWidth","modal","movable","preview","responsive","restore","rotatable","scalable","toggleDragModeOnDblclick","viewMode","wheelZoomRatio","zoomOnTouch","zoomOnWheel","zoomable","cropstart","cropmove","cropend","crop","zoom","ready"],Wr={opacity:0,maxWidth:"100%"},$r=$e.forwardRef(function(r,t){var a=mt(r,[]),s=a.dragMode,l=s===void 0?"crop":s,i=a.src,n=a.style,o=a.className,d=a.crossOrigin,p=a.scaleX,m=a.scaleY,c=a.enable,x=a.zoomTo,k=a.rotateTo,N=a.alt,g=N===void 0?"picture":N,y=a.ready,w=a.onInitialized,A=mt(a,["dragMode","src","style","className","crossOrigin","scaleX","scaleY","enable","zoomTo","rotateTo","alt","ready","onInitialized"]),v={scaleY:m,scaleX:p,enable:c,zoomTo:x,rotateTo:k},b=function(){for(var u=[],S=0;S<arguments.length;S++)u[S]=arguments[S];var j=h.useRef(null);return $e.useEffect(function(){u.forEach(function(M){M&&(typeof M=="function"?M(j.current):M.current=j.current)})},[u]),j}(t,h.useRef(null));h.useEffect(function(){var u;!((u=b.current)===null||u===void 0)&&u.cropper&&typeof x=="number"&&b.current.cropper.zoomTo(x)},[a.zoomTo]),h.useEffect(function(){var u;!((u=b.current)===null||u===void 0)&&u.cropper&&i!==void 0&&b.current.cropper.reset().clear().replace(i)},[i]),h.useEffect(function(){if(b.current!==null){var u=new Ga(b.current,Ne(Ne({dragMode:l},A),{ready:function(S){S.currentTarget!==null&&function(j,M){M===void 0&&(M={});var f=M.enable,P=f===void 0||f,E=M.scaleX,z=E===void 0?1:E,X=M.scaleY,D=X===void 0?1:X,F=M.zoomTo,B=F===void 0?0:F,V=M.rotateTo;P?j.enable():j.disable(),j.scaleX(z),j.scaleY(D),V!==void 0&&j.rotateTo(V),B>0&&j.zoomTo(B)}(S.currentTarget.cropper,v),y&&y(S)}}));w&&w(u)}return function(){var S,j;(j=(S=b.current)===null||S===void 0?void 0:S.cropper)===null||j===void 0||j.destroy()}},[b]);var _=function(u){return Ur.reduce(function(S,j){var M=S,f=j;return M[f],mt(M,[typeof f=="symbol"?f:f+""])},u)}(Ne(Ne({},A),{crossOrigin:d,src:i,alt:g}));return $e.createElement("div",{style:n,className:o},$e.createElement("img",Ne({},_,{style:Wr,ref:b})))});const xa=()=>{const r=be(),{id:t}=et(),[a,s]=h.useState(!1),[l,i]=h.useState(!1),[n,o]=h.useState(null),[d,p]=h.useState(null),m=h.useRef(null),[c,x]=h.useState({name:"",nik:"",birth_place:"",birth_date:"",address:"",religion:"",marital_status:"",occupation:"",nationality:"",bank_name:"",bank_account_name:"",bank_account_number:"",user_id:"",ktp_image:null,npwp_image:null}),[k,N]=h.useState(null),[g,y]=h.useState(null),[w,A]=h.useState([]);h.useEffect(()=>{v(),t&&(console.log("Editing Creator ID:",t),b(t))},[t]);const v=async()=>{try{const f=await R.get("/users");A(f.data)}catch(f){console.error("Failed to fetch users",f)}},b=async f=>{try{console.log("Fetching creator data for ID:",f);const P=await R.get(`/creators/${f}`);if(console.log("Fetched creator data:",P.data),P.data){const E=P.data,z=Array.isArray(E)?E[0]:E;console.log("Processed Creator Data:",z),x({name:z.name||"",nik:z.nik||"",birth_place:z.birth_place||"",birth_date:z.birth_date?z.birth_date.split("T")[0]:"",address:z.address||"",religion:z.religion||"",marital_status:z.marital_status||"",occupation:z.occupation||"",nationality:z.nationality||"",bank_name:z.bank_name||"",bank_account_name:z.bank_account_name||"",bank_account_number:z.bank_account_number||"",user_id:z.user_id||"",ktp_image:null,npwp_image:null}),z.ktp_path&&N(`http://localhost:5000/${z.ktp_path}`),z.npwp_path&&y(`http://localhost:5000/${z.npwp_path}`)}}catch(P){console.error("Failed to fetch creator",P)}},_=f=>{if(f.target.files&&f.target.files[0]){const P=f.target.files[0],E=new FileReader;E.onload=()=>{o(E.result),p("ktp"),i(!0)},E.readAsDataURL(P),f.target.value=""}},u=f=>{if(f.target.files&&f.target.files[0]){const P=f.target.files[0],E=new FileReader;E.onload=()=>{o(E.result),p("npwp"),i(!0)},E.readAsDataURL(P),f.target.value=""}},S=()=>{var P;const f=(P=m.current)==null?void 0:P.cropper;typeof f<"u"&&f.getCroppedCanvas().toBlob(async E=>{if(E){const z=d==="ktp"?"ktp_cropped.jpg":"npwp_cropped.jpg",X=new File([E],z,{type:"image/jpeg"});d==="ktp"?(x({...c,ktp_image:X}),N(URL.createObjectURL(E))):d==="npwp"&&(x({...c,npwp_image:X}),y(URL.createObjectURL(E))),i(!1),p(null)}},"image/jpeg")},j=f=>{var E;const P=(E=m.current)==null?void 0:E.cropper;P&&P.rotate(f)},M=async f=>{f.preventDefault(),s(!0);const P=new FormData;Object.entries(c).forEach(([E,z])=>{E==="ktp_image"?z&&P.append("ktp",z):E==="npwp_image"?z&&P.append("npwp",z):P.append(E,z)});try{t?await R.put(`/creators/${t}`,P):await R.post("/creators",P),r("/admin/creators")}catch(E){console.error(E),alert("Failed to save creator")}finally{s(!1)}};return e.jsxs("div",{className:"glass-panel min-h-[calc(100vh-2rem)]",children:[e.jsx("div",{className:"border-b border-white/30 px-6 py-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:t?"Edit Creator":"Add New Creator"})}),e.jsxs("div",{className:"p-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsxs("div",{className:"glass-card p-4 text-center mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Upload KTP"}),k?e.jsx("img",{src:k,alt:"KTP Preview",className:"w-full h-auto rounded mb-4"}):e.jsxs("div",{className:"h-40 flex flex-col items-center justify-center text-gray-400",children:[e.jsx(ne,{size:40,className:"mb-2"}),e.jsx("p",{children:"Click to Upload KTP"})]}),e.jsxs("label",{className:"block w-full",children:[e.jsx("span",{className:"sr-only",children:"Choose file"}),e.jsx("input",{type:"file",accept:"image/*",onChange:_,className:`block w-full text-sm text-gray-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-purple-50 file:text-purple-700
                  hover:file:bg-purple-100`})]})]}),e.jsxs("div",{className:"glass-card p-4 text-center",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Upload NPWP"}),g?e.jsx("img",{src:g,alt:"NPWP Preview",className:"w-full h-auto rounded mb-4"}):e.jsxs("div",{className:"h-40 flex flex-col items-center justify-center text-gray-400",children:[e.jsx(ne,{size:40,className:"mb-2"}),e.jsx("p",{children:"Click to Upload NPWP"})]}),e.jsxs("label",{className:"block w-full",children:[e.jsx("span",{className:"sr-only",children:"Choose file"}),e.jsx("input",{type:"file",accept:"image/*",onChange:u,className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-full file:border-0
                    file:text-sm file:font-semibold
                    file:bg-purple-50 file:text-purple-700
                    hover:file:bg-purple-100`})]})]})]}),e.jsx("div",{className:"md:col-span-2 glass-panel p-6",children:e.jsxs("form",{onSubmit:M,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"NIK"}),e.jsx("input",{type:"text",value:c.nik,onChange:f=>x({...c,nik:f.target.value}),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pemilik Akun User (Opsional)"}),e.jsxs("select",{value:c.user_id,onChange:f=>x({...c,user_id:f.target.value}),className:"mt-1 block w-full glass-input",children:[e.jsx("option",{value:"",children:"Pilih User"}),w.map(f=>e.jsxs("option",{value:f.id,children:[f.name," (",f.email,")"]},f.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama"}),e.jsx("input",{type:"text",value:c.name,onChange:f=>x({...c,name:f.target.value}),className:"mt-1 block glass-input",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tempat Lahir"}),e.jsx("input",{type:"text",value:c.birth_place,onChange:f=>x({...c,birth_place:f.target.value}),className:"mt-1 block glass-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tanggal Lahir"}),e.jsx("input",{type:"date",value:c.birth_date,onChange:f=>x({...c,birth_date:f.target.value}),className:"mt-1 block glass-input"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Alamat"}),e.jsx("textarea",{value:c.address,onChange:f=>x({...c,address:f.target.value}),className:"mt-1 block glass-input",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Agama"}),e.jsxs("select",{value:c.religion,onChange:f=>x({...c,religion:f.target.value}),className:"mt-1 block w-full glass-input",children:[e.jsx("option",{value:"",children:"Pilih Agama"}),e.jsx("option",{value:"ISLAM",children:"Islam"}),e.jsx("option",{value:"KRISTEN",children:"Kristen"}),e.jsx("option",{value:"KATOLIK",children:"Katolik"}),e.jsx("option",{value:"HINDU",children:"Hindu"}),e.jsx("option",{value:"BUDDHA",children:"Buddha"}),e.jsx("option",{value:"KONGHUCU",children:"Konghucu"}),e.jsx("option",{value:"LAINNYA",children:"Lainnya"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status Perkawinan"}),e.jsx("input",{type:"text",value:c.marital_status,onChange:f=>x({...c,marital_status:f.target.value}),className:"mt-1 block glass-input"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pekerjaan"}),e.jsx("input",{type:"text",value:c.occupation,onChange:f=>x({...c,occupation:f.target.value}),className:"mt-1 block glass-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Kewarganegaraan"}),e.jsxs("select",{value:c.nationality,onChange:f=>x({...c,nationality:f.target.value}),className:"mt-1 block w-full glass-input",children:[e.jsx("option",{value:"",children:"Pilih Kewarganegaraan"}),e.jsx("option",{value:"WNI",children:"WNI"}),e.jsx("option",{value:"WNA",children:"WNA"})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-4",children:"Data Rekening Bank"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama Bank"}),e.jsx("input",{type:"text",value:c.bank_name,onChange:f=>x({...c,bank_name:f.target.value}),className:"mt-1 block glass-input",placeholder:"Contoh: BCA, Mandiri"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nama Pemilik Rekening"}),e.jsx("input",{type:"text",value:c.bank_account_name,onChange:f=>x({...c,bank_account_name:f.target.value}),className:"mt-1 block glass-input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"No. Rekening"}),e.jsx("input",{type:"text",value:c.bank_account_number,onChange:f=>x({...c,bank_account_number:f.target.value}),className:"mt-1 block glass-input"})]})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",disabled:a,className:"glass-button flex items-center disabled:opacity-50",children:a?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:20,className:"mr-2"})," Simpan Pencipta"]})})})]})})]}),l&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 flex items-center",children:[e.jsx(gs,{className:"mr-2",size:20})," Crop & Rotate KTP"]}),e.jsx("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(fe,{size:24})})]}),e.jsx("div",{className:"flex-1 bg-gray-900 p-4 overflow-hidden flex items-center justify-center",children:e.jsx($r,{ref:m,style:{height:"100%",maxHeight:"60vh",width:"100%"},initialAspectRatio:1.58,src:n||"",viewMode:1,guides:!0,minCropBoxHeight:10,minCropBoxWidth:10,background:!1,responsive:!0,autoCropArea:1,checkOrientation:!1})}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t flex flex-wrap gap-4 justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>j(-90),className:"flex items-center px-3 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 text-gray-700",title:"Rotate Left",children:[e.jsx(fs,{size:18,className:"mr-1"})," -90°"]}),e.jsxs("button",{type:"button",onClick:()=>j(90),className:"flex items-center px-3 py-2 bg-white border border-gray-300 rounded hover:bg-gray-100 text-gray-700",title:"Rotate Right",children:[e.jsx(bs,{size:18,className:"mr-1"})," +90°"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-100",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:S,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 flex items-center shadow-sm",children:[e.jsx(wa,{size:18,className:"mr-2"})," Crop & Save"]})]})]})]})})]})},Yr=()=>{const[r,t]=h.useState(null),[a,s]=h.useState([]);h.useEffect(()=>{(async()=>{try{const o=await R.get("/dashboard/stats");if(t(o.data),o.data.monthlyData)s(o.data.monthlyData);else{const d=await R.get("/reports/analytics");s(d.data)}}catch(o){console.error(o)}})()},[]);const l=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(n),i=["#7A4A88","#9B5DE5","#D689FF","#F15BB5","#00BBF9","#00F5D4","#8338EC","#3A86FF","#FF006E","#FB5607","#FFBE0B","#FFD166"];return r?e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Revenue Analytics"}),e.jsx("div",{className:"h-80",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(Pt,{data:a,children:[e.jsx(Lt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(Tt,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},dy:10,tickFormatter:n=>new Date(0,n-1).toLocaleString("default",{month:"short"})}),e.jsx(Mt,{axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12}}),e.jsx(Et,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:n=>l(n)}),e.jsx(Rt,{dataKey:"revenue",radius:[4,4,0,0],children:a.map((n,o)=>e.jsx(zt,{fill:i[o%i.length]},`cell-${o}`))})]})})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Top 5 Songs"}),e.jsxs("div",{className:"space-y-4",children:[r.topSongs&&r.topSongs.map((n,o)=>e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-50 pb-3 last:border-0 last:pb-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold text-sm",children:o+1}),e.jsx("div",{className:"overflow-hidden",children:e.jsx("p",{className:"font-medium text-gray-800 text-sm truncate max-w-[150px]",title:n.title,children:n.title})})]}),e.jsx("span",{className:"font-bold text-green-600 text-sm",children:l(n.revenue)})]},o)),(!r.topSongs||r.topSongs.length===0)&&e.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"Belum ada data"})]})]})]})]}):e.jsx("div",{children:"Loading..."})},Hr=()=>{const[r,t]=h.useState(""),[a,s]=h.useState(null),[l,i]=h.useState(null),[n,o]=h.useState(null),[d,p]=h.useState(null),[m,c]=h.useState(null),[x,k]=h.useState(null),[N,g]=h.useState(!1),[y,w]=h.useState("");h.useEffect(()=>{A()},[]);const A=async()=>{try{const S=await R.get("/settings");if(S.data){t(S.data.company_name||"");const M="/api".replace("/api","");if(S.data.logo){const f=S.data.logo.replace(/\\/g,"/"),P=f.startsWith("http")?f:`${M}/${f}`;i(P)}if(S.data.login_background){const f=S.data.login_background.replace(/\\/g,"/"),P=f.startsWith("http")?f:`${M}/${f}`;p(P)}if(S.data.app_icon){const f=S.data.app_icon.replace(/\\/g,"/"),P=f.startsWith("http")?f:`${M}/${f}`;k(P)}}}catch(S){console.error("Failed to fetch settings",S)}},v=S=>{if(S.target.files&&S.target.files[0]){const j=S.target.files[0];s(j),i(URL.createObjectURL(j))}},b=S=>{if(S.target.files&&S.target.files[0]){const j=S.target.files[0];o(j),p(URL.createObjectURL(j))}},_=S=>{if(S.target.files&&S.target.files[0]){const j=S.target.files[0];c(j),k(URL.createObjectURL(j))}},u=async S=>{S.preventDefault(),g(!0),w("");const j=new FormData;j.append("company_name",r),a&&j.append("logo",a),n&&j.append("login_background",n),m&&j.append("app_icon",m);try{await R.put("/settings",j,{headers:{"Content-Type":"multipart/form-data"}}),w("Settings updated successfully")}catch(M){console.error("Failed to update settings",M),w("Failed to update settings")}finally{g(!1)}};return e.jsxs("div",{className:"glass-panel p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-[#7A4A88]",children:"Settings"}),y&&e.jsx("div",{className:`p-4 rounded-md mb-4 ${y.includes("success")?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:y}),e.jsxs("form",{onSubmit:u,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{type:"text",value:r,onChange:S=>t(S.target.value),className:"glass-input",placeholder:"Enter company name"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logo"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 border border-white/40 rounded-md overflow-hidden flex items-center justify-center bg-white/50 shrink-0",children:l?e.jsx("img",{src:l,alt:"Logo Preview",className:"w-full h-full object-contain"}):e.jsx("span",{className:"text-gray-400 text-xs",children:"No Logo"})}),e.jsxs("label",{className:"cursor-pointer bg-[#7A4A88] text-white px-4 py-2 rounded-md hover:bg-[#6a3d77] transition-colors flex items-center text-sm w-full sm:w-auto justify-center",children:[e.jsx(ne,{size:16,className:"mr-2"}),e.jsx("span",{children:"Upload Logo"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:v})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"App Icon (Favicon)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border border-white/40 rounded-md overflow-hidden flex items-center justify-center bg-white/50 shrink-0",children:x?e.jsx("img",{src:x,alt:"Icon Preview",className:"w-full h-full object-contain"}):e.jsx("span",{className:"text-gray-400 text-[10px]",children:"No Icon"})}),e.jsxs("label",{className:"cursor-pointer bg-[#7A4A88] text-white px-4 py-2 rounded-md hover:bg-[#6a3d77] transition-colors flex items-center text-sm w-full sm:w-auto justify-center",children:[e.jsx(ne,{size:16,className:"mr-2"}),e.jsx("span",{children:"Upload Icon"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:_})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Login Background (Opacity 60%)"}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4",children:[e.jsx("div",{className:"w-full sm:w-64 h-32 border border-white/40 rounded-md overflow-hidden flex items-center justify-center bg-white/50 relative shrink-0",children:d?e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx("img",{src:d,alt:"Bg Preview",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black opacity-40"})]}):e.jsx("span",{className:"text-gray-400 text-xs",children:"No Background"})}),e.jsxs("label",{className:"cursor-pointer bg-[#7A4A88] text-white px-4 py-2 rounded-md hover:bg-[#6a3d77] transition-colors flex items-center text-sm w-full sm:w-auto justify-center",children:[e.jsx(ne,{size:16,className:"mr-2"}),e.jsx("span",{children:"Upload Background"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:b})]})]})]}),e.jsxs("button",{type:"submit",disabled:N,className:"glass-button flex items-center disabled:opacity-50",children:[e.jsx(Re,{size:18,className:"mr-2"}),N?"Saving...":"Save Settings"]})]})]})},pa=()=>{const[r,t]=h.useState([]),[a,s]=h.useState({total_net_revenue:0,total_sub_pub_share:0,total_tbw_share:0}),[l,i]=h.useState(!0),[n,o]=h.useState(""),[d,p]=h.useState(1),[m,c]=h.useState(20),[x,k]=h.useState(""),[N,g]=h.useState("");h.useEffect(()=>{y()},[x,N]);const y=async()=>{i(!0);try{const u={};x&&(u.month=x),N&&(u.year=N);const S=await R.get("/reports",{params:u});t(S.data.reports),s(S.data.summary||{total_net_revenue:0,total_sub_pub_share:0,total_tbw_share:0,total_admin_share:0,total_client_share:0})}catch(u){console.error("Failed to fetch reports",u)}finally{i(!1)}},w=r.filter(u=>u.title&&u.title.toLowerCase().includes(n.toLowerCase())||u.custom_id&&u.custom_id.toLowerCase().includes(n.toLowerCase())||u.writer&&u.writer.toLowerCase().includes(n.toLowerCase())),A=Math.ceil(w.length/m),v=(d-1)*m,b=w.slice(v,v+m),_=u=>u==null||isNaN(u)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(u);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Report"}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-white p-2 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 text-gray-500",children:[e.jsx(Sa,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),e.jsxs("select",{value:x,onChange:u=>k(u.target.value?Number(u.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"All Months"}),Array.from({length:12},(u,S)=>e.jsx("option",{value:S+1,children:new Date(0,S).toLocaleString("default",{month:"long"})},S+1))]}),e.jsxs("select",{value:N,onChange:u=>g(u.target.value?Number(u.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"All Years"}),Array.from({length:5},(u,S)=>{const j=new Date().getFullYear()-2+S;return e.jsx("option",{value:j,children:j},j)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"glass-panel p-6 flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600 mr-4",children:e.jsx(ys,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Net Revenue (Client)"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:_(a.total_client_share||a.total_net_revenue)})]})]}),e.jsxs("div",{className:"glass-panel p-6 flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600 mr-4",children:e.jsx(js,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Sub Publisher Share"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:_(a.total_sub_pub_share)})]})]}),e.jsxs("div",{className:"glass-panel p-6 flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-green-100 text-green-600 mr-4",children:e.jsx(At,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"TBW Share (Publisher Pusat)"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:_(a.total_admin_share||a.total_tbw_share)})]})]})]}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"p-4 border-b border-white/30 flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 md:max-w-md relative",children:[e.jsx("input",{type:"text",placeholder:"Search by Custom ID, Title, or Writer...",className:"glass-input pl-10 w-full",value:n,onChange:u=>{o(u.target.value),p(1)}}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),e.jsxs("select",{value:m,onChange:u=>{c(Number(u.target.value)),p(1)},className:"glass-input py-1 px-2 text-sm w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"}),e.jsx("option",{value:100,children:"100"})]})]})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Periode"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Custom ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pencipta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Asal Report"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sub Publisher Share (Revenue)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center",children:"Loading..."})}):b.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-6 py-4 text-center text-gray-500",children:"No reports found"})}):b.map((u,S)=>e.jsxs("tr",{className:S%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.month&&u.year?`${new Date(0,u.month-1).toLocaleString("default",{month:"short"})} ${u.year}`:"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:u.custom_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.writer}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.source}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:_(u.sub_pub_share)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:u.is_matched?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800",children:"Matched"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800",children:"Unmatched"})})]},S))})]})}),A>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-white/30 flex items-center justify-between bg-white/20",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:v+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(v+m,w.length)})," of ",e.jsx("span",{className:"font-medium",children:w.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>p(u=>Math.max(u-1,1)),disabled:d===1,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,A)},(u,S)=>{let j=S+1;return A>5&&(d>3&&(j=d-2+S),j>A&&(j=A-(4-S))),e.jsx("button",{onClick:()=>p(j),className:`px-3 py-1 border rounded-md ${d===j?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:j},j)}),e.jsx("button",{onClick:()=>p(u=>Math.min(u+1,A)),disabled:d===A,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},Xr=()=>{const[r,t]=h.useState(!1),[a,s]=h.useState(1),[l,i]=h.useState(new Date().getMonth()+1),[n,o]=h.useState(new Date().getFullYear()),[d,p]=h.useState(""),[m,c]=h.useState(null),[x,k]=h.useState([]),[N,g]=h.useState(""),[y,w]=h.useState(1),A=10,v=h.useRef(null);h.useEffect(()=>{b()},[]);const b=async()=>{try{const D=await R.get("/reports/history");k(D.data)}catch(D){console.error("Failed to fetch import history",D)}},_=async D=>{if(confirm("Apakah Anda yakin ingin menghapus riwayat import ini? Data laporan terkait TIDAK akan terhapus, hanya riwayat import saja."))try{await R.delete(`/reports/history/${D}`),k(F=>F.filter(B=>B.id!==D))}catch(F){console.error("Failed to delete history",F),alert("Gagal menghapus riwayat")}},u=()=>{a<3&&s(a+1)},S=()=>{a>1&&s(a-1)},j=D=>{var B;const F=(B=D.target.files)==null?void 0:B[0];F&&c(F)},M=async()=>{var F,B;if(!m)return;t(!0);const D=new FormData;D.append("report",m),D.append("month",l.toString()),D.append("year",n.toString()),D.append("period",d||"");try{const V=await R.post("/reports/import",D,{headers:{"Content-Type":"multipart/form-data"}});alert(`Import successful! Inserted: ${V.data.inserted} records.`),V.data.errors&&V.data.errors.length>0&&alert(`Some warnings:
${V.data.errors.join(`
`)}`),b(),c(null),p(""),s(1),v.current&&(v.current.value="")}catch(V){console.error("Import failed",V),alert(`Import failed: ${((B=(F=V.response)==null?void 0:F.data)==null?void 0:B.message)||V.message}`)}finally{t(!1)}},f=[{id:1,title:"Bulan Laporan",icon:vs},{id:2,title:"Periode Pelaporan",icon:ae},{id:3,title:"Upload Dokumen",icon:ne}],P=x.filter(D=>D.file_name&&D.file_name.toLowerCase().includes(N.toLowerCase())||D.status&&D.status.toLowerCase().includes(N.toLowerCase())),E=Math.ceil(P.length/A),z=(y-1)*A,X=P.slice(z,z+A);return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Import Report"}),e.jsxs("div",{className:"glass-panel p-8 mb-8",children:[e.jsx("div",{className:"flex items-center justify-center mb-8",children:f.map((D,F)=>e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"flex flex-col items-center relative z-10",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center transition-colors duration-300 ${a>=D.id?"bg-purple-600 text-white shadow-lg":"bg-gray-200 text-gray-500"}`,children:a>D.id?e.jsx(wa,{size:20}):e.jsx(D.icon,{size:18})}),e.jsx("span",{className:`text-xs mt-2 font-medium ${a>=D.id?"text-purple-600":"text-gray-400"}`,children:D.title})]}),F<f.length-1&&e.jsx("div",{className:`w-24 h-1 mx-2 rounded -mt-6 transition-colors duration-300 ${a>D.id?"bg-purple-600":"bg-gray-200"}`})]},D.id))}),e.jsxs("div",{className:"max-w-md mx-auto min-h-[200px]",children:[a===1&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-gray-700",children:"Detail Bulan Laporan"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),e.jsx("select",{value:l,onChange:D=>i(Number(D.target.value)),className:"glass-input w-full",children:Array.from({length:12},(D,F)=>e.jsx("option",{value:F+1,children:new Date(0,F).toLocaleString("default",{month:"long"})},F+1))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),e.jsx("select",{value:n,onChange:D=>o(Number(D.target.value)),className:"glass-input w-full",children:Array.from({length:5},(D,F)=>{const B=new Date().getFullYear()-2+F;return e.jsx("option",{value:B,children:B},B)})})]})]})]}),a===2&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-gray-700",children:"Detail Periode Pelaporan"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Keterangan Periode (Opsional)"}),e.jsx("input",{type:"text",value:d,onChange:D=>p(D.target.value),placeholder:"Contoh: Q1 2025, Semester 1",className:"glass-input w-full"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tambahkan catatan khusus untuk periode import ini."})]})]}),a===3&&e.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-4 duration-300",children:[e.jsx("h3",{className:"text-lg font-semibold text-center mb-4 text-gray-700",children:"Upload Dokumen Laporan"}),e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-colors ${m?"border-purple-500 bg-purple-50":"border-gray-300 hover:border-purple-400 hover:bg-gray-50"}`,onClick:()=>{var D;return(D=v.current)==null?void 0:D.click()},children:[e.jsx("input",{type:"file",ref:v,onChange:j,className:"hidden",accept:".xlsx, .xls, .csv"}),m?e.jsxs("div",{className:"flex flex-col items-center text-purple-700",children:[e.jsx(ae,{size:48,className:"mb-2"}),e.jsx("span",{className:"font-medium truncate max-w-full",children:m.name}),e.jsxs("span",{className:"text-xs text-purple-500 mt-1",children:[(m.size/1024).toFixed(2)," KB"]}),e.jsx("button",{className:"mt-4 text-xs bg-white border border-purple-200 px-3 py-1 rounded-full hover:bg-purple-100",children:"Ganti File"})]}):e.jsxs("div",{className:"flex flex-col items-center text-gray-500 cursor-pointer",children:[e.jsx(ne,{size:48,className:"mb-2 text-gray-400"}),e.jsx("span",{className:"font-medium",children:"Klik untuk upload file"}),e.jsx("span",{className:"text-xs mt-1",children:"Format: .xlsx, .xls, .csv"})]})]})]})]}),e.jsxs("div",{className:"flex justify-between mt-8 max-w-md mx-auto border-t border-gray-100 pt-6",children:[e.jsx("button",{onClick:S,disabled:a===1||r,className:`px-6 py-2 rounded-lg text-sm font-medium transition-colors ${a===1?"text-gray-300 cursor-not-allowed":"text-gray-600 hover:bg-gray-100"}`,children:"Kembali"}),a<3?e.jsxs("button",{onClick:u,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 flex items-center gap-2 text-sm font-medium shadow-md transition-transform hover:scale-105",children:["Lanjut ",e.jsx(ke,{size:16})]}):e.jsx("button",{onClick:M,disabled:!m||r,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center gap-2 text-sm font-medium shadow-md transition-transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:r?e.jsxs(e.Fragment,{children:[e.jsx(ut,{className:"animate-spin",size:16})," Importing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{size:16})," Mulai Import"]})})]})]}),e.jsxs("div",{className:"glass-panel p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4 gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Riwayat Import"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Search file name...",className:"pl-10 w-full border rounded-lg py-2 px-3 focus:ring-purple-500 focus:border-purple-500 text-sm",value:N,onChange:D=>{g(D.target.value),w(1)}}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:18})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"File Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Periode"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Records"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date Uploaded"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500",children:"No import history found"})}):X.map(D=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:D.file_name}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[new Date(0,D.month-1).toLocaleString("default",{month:"long"})," ",D.year,D.period&&e.jsx("span",{className:"block text-xs text-gray-400",children:D.period})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:D.total_records}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${D.status==="Success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:D.status})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(D.created_at).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>_(D.id),className:"text-red-600 hover:text-red-900 hover:bg-red-50 p-2 rounded-full transition-colors",title:"Hapus Riwayat",children:e.jsx(Na,{size:18})})})]},D.id))})]})}),E>1&&e.jsxs("div",{className:"mt-4 flex items-center justify-between border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:z+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(z+A,P.length)})," of ",e.jsx("span",{className:"font-medium",children:P.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>w(D=>Math.max(D-1,1)),disabled:y===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 text-sm",children:"Previous"}),Array.from({length:Math.min(5,E)},(D,F)=>{let B=F+1;return E>5&&(y>3&&(B=y-2+F),B>E&&(B=E-(4-F))),e.jsx("button",{onClick:()=>w(B),className:`px-3 py-1 border rounded text-sm ${y===B?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:B},B)}),e.jsx("button",{onClick:()=>w(D=>Math.min(D+1,E)),disabled:y===E,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 text-sm",children:"Next"})]})]})]})]})},ht=({title:r,type:t,icon:a,month:s,year:l})=>{const[i,n]=h.useState([]),[o,d]=h.useState(1),[p,m]=h.useState(!1),c=5;h.useEffect(()=>{x()},[o,s,l]);const x=async()=>{m(!0);try{const N={type:t,page:o,limit:c};s&&(N.month=s),l&&(N.year=l);const g=await R.get("/reports/top-stats",{params:N});n(g.data)}catch(N){console.error("Failed to fetch top stats",N)}finally{m(!1)}},k=N=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(N);return e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg text-purple-600",children:a}),e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:r})]}),e.jsx("div",{className:"flex-1",children:p?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600"})}):e.jsxs("div",{className:"space-y-3",children:[i.map((N,g)=>e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-50 pb-2 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 flex items-center justify-center bg-gray-100 rounded text-xs font-bold text-gray-500",children:(o-1)*c+g+1}),e.jsx("span",{className:"font-medium text-gray-700 text-sm truncate max-w-[150px]",title:N.name,children:N.name||"Unknown"})]}),e.jsx("span",{className:"font-bold text-green-600 text-sm",children:k(N.revenue)})]},g)),i.length===0&&e.jsx("p",{className:"text-center text-gray-400 text-sm py-4",children:"Tidak ada data"})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsx("button",{onClick:()=>d(N=>Math.max(1,N-1)),disabled:o===1||p,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ws,{size:20})}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Halaman ",o]}),e.jsx("button",{onClick:()=>d(N=>N+1),disabled:i.length<c||p,className:"p-1 rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ke,{size:20})})]})]})},ua=()=>{const[r,t]=h.useState([]),[a,s]=h.useState(null),[l,i]=h.useState(!0),[n,o]=h.useState(""),[d,p]=h.useState("");h.useEffect(()=>{m()},[n,d]);const m=async()=>{i(!0);try{const g={};n&&(g.month=n),d&&(g.year=d);const y=await R.get("/reports/analytics",{params:g});t(y.data);const w={};n&&(w.month=n),d&&(w.year=d);const A=await R.get("/reports",{params:w});A.data&&A.data.summary&&s(A.data.summary)}catch(g){console.error("Failed to fetch analytics",g)}finally{i(!1)}},c=g=>g==null||isNaN(g)?"Rp 0":new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(g),x=["#7A4A88","#9B5DE5","#D689FF","#F15BB5","#00BBF9","#00F5D4","#8338EC","#3A86FF","#FF006E","#FB5607","#FFBE0B","#FFD166"],k=[{value:1,label:"Januari"},{value:2,label:"Februari"},{value:3,label:"Maret"},{value:4,label:"April"},{value:5,label:"Mei"},{value:6,label:"Juni"},{value:7,label:"Juli"},{value:8,label:"Agustus"},{value:9,label:"September"},{value:10,label:"Oktober"},{value:11,label:"November"},{value:12,label:"Desember"}],N=Array.from({length:5},(g,y)=>new Date().getFullYear()-y);return l&&!a?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(a&&(Number(a.total_client_share||0),Number(a.total_admin_share||0)),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Analitik (Analytics)"}),e.jsxs("div",{className:"flex flex-wrap gap-3 bg-white p-2 rounded-lg shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 px-2 text-gray-500",children:[e.jsx(Sa,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:"Filter:"})]}),e.jsxs("select",{value:n,onChange:g=>o(g.target.value?Number(g.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Bulan"}),k.map(g=>e.jsx("option",{value:g.value,children:g.label},g.value))]}),e.jsxs("select",{value:d,onChange:g=>p(g.target.value?Number(g.target.value):""),className:"text-sm border-gray-200 rounded-md focus:ring-purple-500 focus:border-purple-500 bg-gray-50 py-1.5",children:[e.jsx("option",{value:"",children:"Semua Tahun"}),N.map(g=>e.jsx("option",{value:g,children:g},g))]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-full mr-4",children:e.jsx(Le,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Net Revenue"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((a==null?void 0:a.total_client_share)||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-full mr-4",children:e.jsx(Ns,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Sub Publisher Share"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((a==null?void 0:a.total_sub_pub_share)||0)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-full mr-4",children:e.jsx(Pe,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"TBW Share"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:c((a==null?void 0:a.total_admin_share)||0)})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:e.jsxs("div",{className:"lg:col-span-3 bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Revenue Trend (Bulanan)"}),e.jsx("div",{className:"h-80",children:e.jsx(at,{width:"100%",height:"100%",children:e.jsxs(Pt,{data:r,barGap:0,barCategoryGap:"20%",children:[e.jsx("defs",{children:x.map((g,y)=>e.jsxs("linearGradient",{id:`gradient-${y}`,x1:"0",y1:"0",x2:"1",y2:"0",children:[e.jsx("stop",{offset:"0%",stopColor:g,stopOpacity:.8}),e.jsx("stop",{offset:"100%",stopColor:g,stopOpacity:1})]},`gradient-${y}`))}),e.jsx(Lt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(Tt,{dataKey:"month",axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12},dy:10,tickFormatter:g=>new Date(0,g-1).toLocaleString("default",{month:"short"})}),e.jsx(Mt,{axisLine:!1,tickLine:!1,tick:{fill:"#9ca3af",fontSize:12}}),e.jsx(Et,{cursor:{fill:"transparent"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},formatter:g=>c(g)}),e.jsx(Rt,{dataKey:"revenue",radius:[4,4,0,0],children:r.map((g,y)=>e.jsx(zt,{fill:`url(#gradient-${y%x.length})`,stroke:x[y%x.length],strokeWidth:1},`cell-${y}`))})]})})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(ht,{title:"Top User Revenue",type:"users",icon:e.jsx(Le,{size:20}),month:n,year:d}),e.jsx(ht,{title:"Top Creator Revenue",type:"creators",icon:e.jsx(Le,{size:20}),month:n,year:d}),e.jsx(ht,{title:"Top Song Revenue",type:"songs",icon:e.jsx(Pe,{size:20}),month:n,year:d})]})]}))},Kr=()=>{const[r,t]=h.useState([]),[a,s]=h.useState(""),[l,i]=h.useState(!0),[n,o]=h.useState(null),[d,p]=h.useState(!1),[m,c]=h.useState("user"),[x,k]=h.useState({status:"",percentage_share:0,role:"user"});h.useEffect(()=>{N()},[]);const N=async()=>{i(!0);try{const v=await R.get("/users");t(v.data)}catch(v){console.error("Failed to fetch users",v)}finally{i(!1)}},g=r.filter(v=>{const b=v.name&&v.name.toLowerCase().includes(a.toLowerCase())||v.email&&v.email.toLowerCase().includes(a.toLowerCase()),_=(v.role||"user")===m;return b&&_}),y=v=>{o(v),k({status:v.status||"pending",percentage_share:v.percentage_share||0,role:v.role||"user"}),p(!0)},w=async()=>{if(n)try{await R.put(`/users/${n.id}`,x),p(!1),N()}catch(v){console.error("Failed to update user",v),alert("Failed to update user status")}},A=async()=>{if(n)try{await R.post(`/users/${n.id}/contract`),alert("Contract generated successfully! (Mock)")}catch(v){console.error("Failed to generate contract",v),alert("Failed to generate contract")}};return e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Manajemen User"})}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"flex border-b border-gray-200",children:["user","admin","operator"].map(v=>e.jsxs("button",{onClick:()=>c(v),className:`px-6 py-3 text-sm font-medium capitalize transition-colors
                        ${m===v?"border-b-2 border-purple-600 text-purple-600 bg-purple-50/50":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[v,"s"]},v))}),e.jsx("div",{className:"p-4 border-b border-white/30",children:e.jsxs("div",{className:"relative max-w-md",children:[e.jsx("input",{type:"text",placeholder:`Cari ${m}...`,className:"glass-input pl-10 w-full",value:a,onChange:v=>s(v.target.value)}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),m==="user"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Share (%)"})]}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:m==="user"?7:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):g.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:m==="user"?7:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:["No ",m,"s found"]})}):g.map((v,b)=>e.jsxs("tr",{className:b%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:v.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:v.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:v.role||"user"}),m==="user"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full
                                    ${(v.status||"pending")==="accepted"?"bg-green-100 text-green-800":(v.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(v.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:v.status||"pending"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[v.percentage_share||0,"%"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:v.created_at?new Date(v.created_at).toLocaleDateString():"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("button",{onClick:()=>y(v),className:"text-purple-600 hover:text-purple-900 flex items-center gap-1 ml-auto",children:[e.jsx(Ss,{size:16})," Manage"]})})]},v.id))})]})})]}),d&&n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl p-6 w-[500px] max-w-[90%]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b pb-4",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900",children:["Manage User: ",n.name]}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(ks,{size:24})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role"}),e.jsx("div",{className:"flex gap-3",children:["user","operator","admin"].map(v=>e.jsx("button",{onClick:()=>k({...x,role:v}),className:`flex-1 px-4 py-2 rounded-lg text-sm font-medium border transition-all capitalize
                                          ${x.role===v?"border-purple-600 bg-purple-50 text-purple-700 ring-1 ring-purple-600":"border-gray-200 hover:bg-gray-50 text-gray-600"}`,children:v},v))})]}),x.role==="user"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Status"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:["pending","review","accepted","rejected"].map(v=>e.jsxs("button",{onClick:()=>k({...x,status:v}),className:`px-4 py-2 rounded-lg text-sm font-medium border transition-all flex items-center justify-center gap-2
                                          ${x.status===v?"border-purple-600 bg-purple-50 text-purple-700 ring-1 ring-purple-600":"border-gray-200 hover:bg-gray-50 text-gray-600"}`,children:[v==="pending"&&e.jsx(ya,{size:16}),v==="review"&&e.jsx(Ye,{size:16}),v==="accepted"&&e.jsx(Ee,{size:16}),v==="rejected"&&e.jsx(Cs,{size:16}),e.jsx("span",{className:"capitalize",children:v})]},v))})]}),x.role==="user"&&x.status==="review"&&e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200 animate-in fade-in slide-in-from-top-2",children:[e.jsxs("h4",{className:"font-semibold text-yellow-800 mb-3 flex items-center gap-2",children:[e.jsx(Ye,{size:18})," Review Process"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-yellow-800 mb-1",children:"Percentage Share (%)"}),e.jsx("input",{type:"number",value:x.percentage_share,onChange:v=>k({...x,percentage_share:Number(v.target.value)}),className:"block w-full rounded-md border-yellow-300 shadow-sm focus:border-yellow-500 focus:ring-yellow-500 sm:text-sm p-2",placeholder:"e.g. 70",min:"0",max:"100"}),e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Potongan untuk user ini."})]}),e.jsxs("button",{onClick:A,className:"w-full flex items-center justify-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[e.jsx(ae,{size:18})," Generate Contract"]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[e.jsx("button",{onClick:()=>p(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 font-medium",children:"Cancel"}),e.jsx("button",{onClick:w,className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 font-medium",children:"Save Changes"})]})]})]})})]})},Gr=()=>{const r=be(),[t,a]=h.useState([]),[s,l]=h.useState(!1),[i,n]=h.useState("all"),[o,d]=h.useState("all"),[p,m]=h.useState("all");h.useEffect(()=>{c()},[i,o]);const c=async()=>{l(!0);try{const b={};i!=="all"&&(b.month=i),o!=="all"&&(b.year=o);const _=await R.get("/payments/calculate",{params:b});a(_.data)}catch(b){console.error("Failed to fetch payment calculations",b)}finally{l(!1)}},x=t.filter(b=>p==="all"?!0:(b.payment_status||"pending")===p),k=x.reduce((b,_)=>b+(Number(_.total_revenue)||0),0),N=x.reduce((b,_)=>b+(Number(_.admin_share)||0),0),g=x.reduce((b,_)=>b+(Number(_.net_share)||0),0),y=(b,_,u)=>{r(`/admin/payments/${b}`,{state:{month:_||i,year:u||o}})},w=b=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),A=b=>{switch(b){case"success":return e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold border border-green-200",children:"SUDAH DITRANSFER"});case"process":return e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-bold border border-yellow-200",children:"PROSES"});default:return e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-bold border border-gray-200",children:"BELUM DITRANSFER"})}},v=b=>new Date(0,b-1).toLocaleString("default",{month:"long"});return e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(Qe,{size:24}),"Perhitungan Pembayaran (Payment Calculation)"]}),e.jsxs("div",{className:"glass-panel p-6 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 border-b border-gray-100 pb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-purple-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-full mr-4",children:e.jsx(Je,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Pendapatan Sub Publisher"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:w(k)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-red-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-full mr-4",children:e.jsx(At,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Pendapatan (Sub Pub - Client)"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:w(N)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-green-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-full mr-4",children:e.jsx(Le,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Share ke Pencipta (Net)"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:w(g)})]})]})]}),e.jsxs("div",{className:"flex gap-4 items-end mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),e.jsxs("select",{value:i,onChange:b=>n(b.target.value==="all"?"all":Number(b.target.value)),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),Array.from({length:12},(b,_)=>e.jsx("option",{value:_+1,children:new Date(0,_).toLocaleString("default",{month:"long"})},_+1))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),e.jsxs("select",{value:o,onChange:b=>d(b.target.value==="all"?"all":Number(b.target.value)),className:"glass-input w-32",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),Array.from({length:5},(b,_)=>{const u=new Date().getFullYear()-2+_;return e.jsx("option",{value:u,children:u},u)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:p,onChange:b=>m(b.target.value),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsxs("button",{onClick:c,className:"btn-primary flex items-center gap-2",children:[e.jsx(Qe,{size:18})," Hitung Ulang"]})]}),s?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Menghitung data pembayaran..."})]}):x.length===0?e.jsx("div",{className:"text-center py-12 bg-white/50 rounded-lg border border-dashed border-gray-300",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada data transaksi untuk kriteria ini."})}):e.jsx("div",{className:"space-y-4",children:x.map((b,_)=>e.jsxs("div",{onClick:()=>y(b.user_id,b.month,b.year),className:"glass-panel p-6 flex flex-col md:flex-row items-center justify-between gap-4 cursor-pointer hover:border-purple-300 transition-all group hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold text-xl group-hover:bg-purple-600 group-hover:text-white transition-colors",children:b.user_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg group-hover:text-purple-700 transition-colors",children:b.user_name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsxs("span",{children:["Potongan Admin: ",e.jsxs("span",{className:"text-purple-600 font-medium",children:[b.user_percentage,"%"]})]}),e.jsx("span",{className:"text-gray-300",children:"|"}),e.jsxs("span",{className:"font-medium text-gray-700",children:[v(b.month)," ",b.year]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-8 text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Total Revenue"}),e.jsx("p",{className:"text-lg font-bold text-gray-800",children:w(b.total_revenue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Admin Share"}),e.jsxs("p",{className:"text-lg font-bold text-red-500",children:["-",w(b.admin_share)]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Net Payable"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:w(b.net_share)})]}),e.jsxs("div",{className:"pl-4 border-l border-gray-100 flex flex-col items-center justify-center gap-2",children:[A(b.payment_status),e.jsxs("button",{className:"px-4 py-1.5 bg-purple-50 hover:bg-purple-100 text-purple-600 rounded-md text-xs font-semibold border border-purple-200 transition-colors flex items-center gap-1 group-hover:bg-purple-600 group-hover:text-white group-hover:border-purple-600",children:["Lihat ",e.jsx(ke,{size:14})]})]})]})]},`${b.user_id}-${b.month}-${b.year}-${_}`))})]})]})},qr=()=>{var V,T;const{userId:r}=et(),t=Dt(),a=be(),[s,l]=h.useState(null),[i,n]=h.useState(!0),[o,d]=h.useState([]),[p,m]=h.useState("pending"),[c,x]=h.useState(!1),[k,N]=h.useState({}),[g,y]=h.useState({}),[w,A]=h.useState(null),[v,b]=h.useState(!1),[_,u]=h.useState(null),S=new URLSearchParams(t.search),j=(C,I)=>{if(I!==void 0)return I;const O=S.get(C);return O==="all"?"all":O?Number(O):C==="year"?new Date().getFullYear():new Date().getMonth()+1},M=j("month",(V=t.state)==null?void 0:V.month)??"all",f=j("year",(T=t.state)==null?void 0:T.year)??"all";h.useEffect(()=>{P()},[r,M,f]);const P=async()=>{var C;n(!0);try{const I={};M!=="all"&&(I.month=M),f!=="all"&&(I.year=f);const W=(await R.get("/payments/calculate",{params:I})).data.find(ee=>ee.user_id===Number(r));l(W),W&&W.payment_status&&m(W.payment_status);const Y={};(C=W==null?void 0:W.songs)==null||C.forEach(ee=>{ee.writers.forEach(me=>{me.payment_status?Y[me.name]=me.payment_status:Y[me.name]="pending"})}),N(Y)}catch(I){console.error("Failed to fetch payment details",I)}finally{n(!1)}},E=async()=>{if(p==="success"){const C=B.filter(I=>(k[I.name]||I.payment_status||"pending")!=="success");if(C.length>0){const I=C.map(O=>O.name).join(", ");alert(`Tidak dapat mengubah status menjadi "Sudah Ditransfer".

Masih ada pencipta yang belum ditransfer:
${I}

Mohon selesaikan pembayaran ke semua pencipta terlebih dahulu.`);return}}x(!0);try{const C=new FormData;C.append("user_id",r),M!=="all"&&C.append("month",M.toString()),f!=="all"&&C.append("year",f.toString()),C.append("status",p),await R.post("/payments/status",C,{headers:{"Content-Type":"multipart/form-data"}}),alert("Status berhasil diperbarui"),P()}catch(C){console.error("Failed to update status",C),alert("Gagal memperbarui status")}finally{x(!1)}},z=async C=>{const I=k[C]||"pending",O=g[C],W=B.find(Y=>Y.name===C);if(I==="success"&&!O&&!(W!=null&&W.payment_proof)){alert("Mohon upload bukti transfer untuk status Success");return}A(C);try{const Y=new FormData;Y.append("user_id",r),M!=="all"&&Y.append("month",M.toString()),f!=="all"&&Y.append("year",f.toString()),Y.append("writer_name",C),Y.append("status",I),O&&Y.append("proof",O),await R.post("/payments/writer-status",Y,{headers:{"Content-Type":"multipart/form-data"}}),alert(`Status pembayaran untuk ${C} berhasil diperbarui`),y(ee=>({...ee,[C]:null})),N(ee=>({...ee,[C]:I})),P()}catch(Y){console.error("Failed to update writer status",Y),alert("Gagal memperbarui status")}finally{A(null)}},X=C=>{d(I=>I.includes(C)?I.filter(O=>O!==C):[...I,C])},D=C=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(C),B=(()=>{if(!s)return[];const C={};return s.songs.forEach(I=>{I.writers.forEach(O=>{C[O.name]||(C[O.name]={name:O.name,role:O.role,phone:O.phone,bank_name:O.bank_name,bank_account_number:O.bank_account_number,bank_account_name:O.bank_account_name,payment_status:O.payment_status,payment_proof:O.payment_proof,total_amount:0,songs:[]}),C[O.name].total_amount+=O.amount,C[O.name].songs.push({title:I.title,song_id:I.song_id,share_percent:O.share_percent,amount:O.amount,role:O.role,creators:I.writers.map(W=>`${W.name} (${W.share_percent}%)`).join(", ")})})}),Object.values(C)})();return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):s?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ka,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:"Detail Pembayaran"}),e.jsxs("p",{className:"text-gray-500",children:["Periode: ",M==="all"?"Semua Bulan":new Date(0,M-1).toLocaleString("default",{month:"long"})," ",f==="all"?"Semua Tahun":f]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-purple-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-50 rounded-full -mr-16 -mt-16 z-0"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600",children:e.jsx(we,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:s.user_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["User ID: #",s.user_id]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Total Revenue"}),e.jsx("span",{className:"font-bold text-gray-800",children:D(s.total_revenue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500 text-sm",children:["Royalti Share (",s.user_percentage,"%)"]}),e.jsxs("span",{className:"font-bold text-red-500",children:["-",D(s.admin_share)]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-200 my-2 pt-2 flex justify-between",children:[e.jsx("span",{className:"text-gray-800 font-medium",children:"Net Payable"}),e.jsx("span",{className:"font-bold text-xl text-green-600",children:D(s.net_share)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ee,{size:18})," Status Transfer"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Saat Ini"}),e.jsxs("select",{value:p,onChange:C=>m(C.target.value),className:"glass-input w-full",children:[e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsx("button",{onClick:E,disabled:c,className:"w-full btn-primary flex items-center justify-center gap-2",children:c?"Menyimpan...":e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:18})," Simpan Status"]})})]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ae,{size:20})," Rincian Pencipta"]}),e.jsx("div",{className:"space-y-4",children:B.map((C,I)=>{var O;return e.jsxs("div",{className:"bg-white rounded-lg border border-purple-100 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-purple-50/30 transition-colors",onClick:()=>X(C.name),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1 rounded-full ${o.includes(C.name)?"bg-purple-100 text-purple-600":"text-gray-400"}`,children:o.includes(C.name)?e.jsx(_t,{size:20}):e.jsx(ke,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:C.name}),e.jsx("p",{className:"text-xs text-gray-500",children:C.role})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Diterima"}),e.jsx("p",{className:"font-bold text-green-600 text-lg",children:D(C.total_amount)})]})]}),o.includes(C.name)&&e.jsxs("div",{className:"bg-gray-50 border-t border-gray-100 p-4",children:[(C.bank_name||C.bank_account_number)&&e.jsxs("div",{className:"mb-4 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[e.jsxs("h5",{className:"text-xs font-semibold text-blue-700 uppercase mb-2 flex items-center gap-2",children:[e.jsx(Ca,{size:14})," Data Rekening"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Bank"}),e.jsx("span",{className:"font-medium text-gray-800",children:C.bank_name||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"No. Rekening"}),e.jsx("span",{className:"font-medium text-gray-800",children:C.bank_account_number||"-"})]}),C.bank_account_name&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Atas Nama"}),e.jsx("span",{className:"font-medium text-gray-800",children:C.bank_account_name})]})]})]}),e.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg border border-purple-100 shadow-sm",children:[e.jsxs("h5",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Ee,{size:16,className:"text-purple-600"})," Status Pembayaran & Bukti Transfer"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:k[C.name]||"pending",onChange:W=>N(Y=>({...Y,[C.name]:W.target.value})),className:"glass-input w-full text-sm py-2",children:[e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Bukti Transfer"}),k[C.name]==="success"?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 border border-gray-300 rounded px-3 py-1.5 bg-gray-50 hover:bg-white transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:W=>y(Y=>({...Y,[C.name]:W.target.files?W.target.files[0]:null})),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 truncate",children:[e.jsx(ne,{size:14}),e.jsx("span",{className:"text-xs truncate",children:g[C.name]?(O=g[C.name])==null?void 0:O.name:C.payment_proof?"Ganti File":"Upload Bukti"})]})]}),C.payment_proof&&e.jsx("button",{onClick:()=>{const W=C.payment_proof.startsWith("http")||C.payment_proof.startsWith("/uploads/")?C.payment_proof:`/uploads/proof/${C.payment_proof}`;u(W),b(!0)},className:"p-2 bg-purple-50 text-purple-600 rounded border border-purple-100 hover:bg-purple-100",title:"Lihat Bukti",children:e.jsx(ze,{size:16})})]}):e.jsx("p",{className:"text-xs text-gray-400 italic py-2",children:"Pilih status Success untuk upload bukti"})]})]}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[C.phone&&e.jsxs("a",{href:`https://wa.me/${C.phone.replace(/^0/,"62").replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1.5 text-green-600 hover:text-green-700 text-sm font-medium px-3 py-1.5 bg-green-50 rounded-lg hover:bg-green-100 transition-colors",children:[e.jsx(Ds,{size:16})," WhatsApp"]}),e.jsx("button",{onClick:()=>z(C.name),disabled:w===C.name,className:"btn-primary text-sm py-1.5 px-4 flex items-center gap-2 ml-auto",children:w===C.name?"Menyimpan...":e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:14})," Simpan"]})})]})]}),e.jsx("h5",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"Rincian Lagu"}),e.jsx("div",{className:"space-y-2",children:C.songs.map((W,Y)=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded border border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[W.title,e.jsxs("span",{className:"ml-1 text-xs text-gray-500 font-normal",children:["(",W.creators,")"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Share: ",W.share_percent,"%"]})]}),e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:D(W.amount)})]},Y))})]})]},I)})})]})]}),v&&_&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"relative max-w-2xl w-full bg-white rounded-xl overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"Bukti Transfer"}),e.jsx("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(fe,{size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"p-4 bg-gray-100 flex justify-center",children:e.jsx("img",{src:_,alt:"Bukti Transfer",className:"max-h-[70vh] object-contain rounded-lg shadow-sm"})}),e.jsx("div",{className:"p-4 border-t border-gray-100 flex justify-end",children:e.jsxs("a",{href:_,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:[e.jsx(tt,{size:16})," Buka Original"]})})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500",children:"Data tidak ditemukan."}),e.jsx("button",{onClick:()=>a(-1),className:"mt-4 text-purple-600 hover:underline",children:"Kembali"})]})},Vr=()=>{var u,S;const{userId:r}=et(),t=Dt(),a=be(),[s,l]=h.useState(null),[i,n]=h.useState(!0),[o,d]=h.useState([]),[p,m]=h.useState(!1),[c,x]=h.useState(null),k=new URLSearchParams(t.search),N=(j,M)=>{if(M!==void 0)return M;const f=k.get(j);return f==="all"?"all":f?Number(f):j==="year"?new Date().getFullYear():new Date().getMonth()+1},g=N("month",(u=t.state)==null?void 0:u.month)??"all",y=N("year",(S=t.state)==null?void 0:S.year)??"all";h.useEffect(()=>{w()},[r,g,y]);const w=async()=>{n(!0);try{const j={};g!=="all"&&(j.month=g),y!=="all"&&(j.year=y);const f=(await R.get("/payments/calculate",{params:j})).data.find(P=>P.user_id===Number(r));l(f)}catch(j){console.error("Failed to fetch payment details",j)}finally{n(!1)}},A=j=>{d(M=>M.includes(j)?M.filter(f=>f!==j):[...M,j])},v=j=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(j),_=(()=>{if(!s)return[];const j={};return s.songs.forEach(M=>{M.writers.forEach(f=>{j[f.name]||(j[f.name]={name:f.name,role:f.role,phone:f.phone,bank_name:f.bank_name,bank_account_number:f.bank_account_number,bank_account_name:f.bank_account_name,payment_status:f.payment_status,payment_proof:f.payment_proof,total_amount:0,songs:[]}),j[f.name].total_amount+=f.amount,j[f.name].songs.push({title:M.title,song_id:M.song_id,share_percent:f.share_percent,amount:f.amount,role:f.role,creators:M.writers.map(P=>`${P.name} (${P.share_percent}%)`).join(", ")})})}),Object.values(j)})();return i?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):s?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>a(-1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ka,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 flex items-center gap-2",children:"Detail Pembayaran Saya"}),e.jsxs("p",{className:"text-gray-500",children:["Periode: ",g==="all"?"Semua Bulan":new Date(0,g-1).toLocaleString("default",{month:"long"})," ",y==="all"?"Semua Tahun":y]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-purple-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-purple-50 rounded-full -mr-16 -mt-16 z-0"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center text-purple-600",children:e.jsx(we,{size:24})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:s.user_name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["User ID: #",s.user_id]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Total Revenue"}),e.jsx("span",{className:"font-bold text-gray-800",children:v(s.total_revenue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-gray-500 text-sm",children:["Royalti Share (",s.user_percentage,"%)"]}),e.jsxs("span",{className:"font-bold text-red-500",children:["-",v(s.admin_share)]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-200 my-2 pt-2 flex justify-between",children:[e.jsx("span",{className:"text-gray-800 font-medium",children:"Net Payable"}),e.jsx("span",{className:"font-bold text-xl text-green-600",children:v(s.net_share)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(Ee,{size:18})," Status Transfer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${s.payment_status==="success"?"bg-green-500":s.payment_status==="process"?"bg-blue-500":"bg-gray-300"}`}),e.jsx("span",{className:"font-medium text-gray-700 capitalize",children:s.payment_status==="success"?"Sudah Ditransfer":s.payment_status==="process"?"Sedang Diproses":"Belum Ditransfer"})]})]})]}),e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ae,{size:20})," Rincian Pencipta"]}),e.jsx("div",{className:"space-y-4",children:_.map((j,M)=>e.jsxs("div",{className:"bg-white rounded-lg border border-purple-100 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-4 flex items-center justify-between cursor-pointer hover:bg-purple-50/30 transition-colors",onClick:()=>A(j.name),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-1 rounded-full ${o.includes(j.name)?"bg-purple-100 text-purple-600":"text-gray-400"}`,children:o.includes(j.name)?e.jsx(_t,{size:20}):e.jsx(ke,{size:20})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-800",children:j.name}),e.jsx("p",{className:"text-xs text-gray-500",children:j.role})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Total Diterima"}),e.jsx("p",{className:"font-bold text-green-600 text-lg",children:v(j.total_amount)})]})]}),o.includes(j.name)&&e.jsxs("div",{className:"bg-gray-50 border-t border-gray-100 p-4",children:[(j.bank_name||j.bank_account_number)&&e.jsxs("div",{className:"mb-4 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[e.jsxs("h5",{className:"text-xs font-semibold text-blue-700 uppercase mb-2 flex items-center gap-2",children:[e.jsx(Ca,{size:14})," Data Rekening"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Bank"}),e.jsx("span",{className:"font-medium text-gray-800",children:j.bank_name||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"No. Rekening"}),e.jsx("span",{className:"font-medium text-gray-800",children:j.bank_account_number||"-"})]}),j.bank_account_name&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-500 text-xs block",children:"Atas Nama"}),e.jsx("span",{className:"font-medium text-gray-800",children:j.bank_account_name})]})]})]}),e.jsxs("div",{className:"mb-6 bg-white p-4 rounded-lg border border-purple-100 shadow-sm",children:[e.jsxs("h5",{className:"text-sm font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx(Ee,{size:16,className:"text-purple-600"})," Status Pembayaran"]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold uppercase ${j.payment_status==="success"?"bg-green-100 text-green-800":j.payment_status==="process"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:j.payment_status==="success"?"Sudah Ditransfer":j.payment_status==="process"?"Sedang Diproses":"Belum Ditransfer"}),j.payment_proof&&e.jsxs("button",{onClick:()=>{const f=j.payment_proof.startsWith("http")||j.payment_proof.startsWith("/uploads/")?j.payment_proof:`/uploads/proof/${j.payment_proof}`;x(f),m(!0)},className:"flex items-center gap-2 px-3 py-1.5 bg-purple-50 text-purple-600 rounded-lg hover:bg-purple-100 text-xs font-medium",children:[e.jsx(ze,{size:14})," Lihat Bukti Transfer"]})]})]}),e.jsx("h5",{className:"text-xs font-semibold text-gray-500 uppercase mb-3",children:"Rincian Lagu"}),e.jsx("div",{className:"space-y-2",children:j.songs.map((f,P)=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded border border-gray-200",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[f.title,e.jsxs("span",{className:"ml-1 text-xs text-gray-500 font-normal",children:["(",f.creators,")"]})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Share: ",f.share_percent,"%"]})]}),e.jsx("span",{className:"font-medium text-gray-700 text-sm",children:v(f.amount)})]},P))})]})]},M))})]})]}),p&&c&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"relative max-w-2xl w-full bg-white rounded-xl overflow-hidden shadow-2xl animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"Bukti Transfer"}),e.jsx("button",{onClick:()=>m(!1),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(fe,{size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"p-4 bg-gray-100 flex justify-center",children:e.jsx("img",{src:c,alt:"Bukti Transfer",className:"max-h-[70vh] object-contain rounded-lg shadow-sm"})}),e.jsx("div",{className:"p-4 border-t border-gray-100 flex justify-end",children:e.jsxs("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium",children:[e.jsx(tt,{size:16})," Buka Original"]})})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-500",children:"Data tidak ditemukan."}),e.jsx("button",{onClick:()=>a(-1),className:"mt-4 text-purple-600 hover:underline",children:"Kembali"})]})},Jr=()=>{const r=be(),[t,a]=h.useState([]),[s,l]=h.useState(!1),[i,n]=h.useState("all"),[o,d]=h.useState("all"),[p,m]=h.useState("all");h.useEffect(()=>{c()},[i,o]);const c=async()=>{l(!0);try{const b={};i!=="all"&&(b.month=i),o!=="all"&&(b.year=o);const _=await R.get("/payments/calculate",{params:b});a(_.data)}catch(b){console.error("Failed to fetch payment calculations",b)}finally{l(!1)}},x=t.filter(b=>p==="all"?!0:(b.payment_status||"pending")===p),k=x.reduce((b,_)=>b+(Number(_.total_revenue)||0),0),N=x.reduce((b,_)=>b+(Number(_.admin_share)||0),0),g=x.reduce((b,_)=>b+(Number(_.net_share)||0),0),y=(b,_,u)=>{r(`/user/payments/${b}`,{state:{month:_||i,year:u||o}})},w=b=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(b),A=b=>{switch(b){case"success":return e.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-xs font-bold border border-green-200",children:"SUDAH DITRANSFER"});case"process":return e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-bold border border-yellow-200",children:"PROSES"});default:return e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-600 rounded-full text-xs font-bold border border-gray-200",children:"BELUM DITRANSFER"})}},v=b=>new Date(0,b-1).toLocaleString("default",{month:"long"});return e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(Qe,{size:24}),"Perhitungan Pembayaran Saya"]}),e.jsxs("div",{className:"glass-panel p-6 mb-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 border-b border-gray-100 pb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-purple-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-purple-50 text-purple-600 rounded-full mr-4",children:e.jsx(Je,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Total Pendapatan"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:w(k)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-red-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded-full mr-4",children:e.jsx(At,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Potongan Admin"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:w(N)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-green-100 flex items-center shadow-sm",children:[e.jsx("div",{className:"p-3 bg-green-50 text-green-600 rounded-full mr-4",children:e.jsx(Le,{size:24})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Pendapatan Bersih"}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:w(g)})]})]})]}),e.jsxs("div",{className:"flex gap-4 items-end mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bulan"}),e.jsxs("select",{value:i,onChange:b=>n(b.target.value==="all"?"all":Number(b.target.value)),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Bulan"}),Array.from({length:12},(b,_)=>e.jsx("option",{value:_+1,children:new Date(0,_).toLocaleString("default",{month:"long"})},_+1))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tahun"}),e.jsxs("select",{value:o,onChange:b=>d(b.target.value==="all"?"all":Number(b.target.value)),className:"glass-input w-32",children:[e.jsx("option",{value:"all",children:"Semua Tahun"}),Array.from({length:5},(b,_)=>{const u=new Date().getFullYear()-2+_;return e.jsx("option",{value:u,children:u},u)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:p,onChange:b=>m(b.target.value),className:"glass-input w-40",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"pending",children:"Belum Ditransfer"}),e.jsx("option",{value:"process",children:"Proses"}),e.jsx("option",{value:"success",children:"Sudah Ditransfer"})]})]}),e.jsxs("button",{onClick:c,className:"btn-primary flex items-center gap-2",children:[e.jsx(Qe,{size:18})," Refresh Data"]})]}),s?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Memuat data..."})]}):x.length===0?e.jsx("div",{className:"text-center py-12 bg-white/50 rounded-lg border border-dashed border-gray-300",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada data transaksi untuk kriteria ini."})}):e.jsx("div",{className:"space-y-4",children:x.map((b,_)=>e.jsxs("div",{onClick:()=>y(b.user_id,b.month,b.year),className:"glass-panel p-6 flex flex-col md:flex-row items-center justify-between gap-4 cursor-pointer hover:border-purple-300 transition-all group hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-100 flex items-center justify-center text-purple-600 font-bold text-xl group-hover:bg-purple-600 group-hover:text-white transition-colors",children:b.user_name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg group-hover:text-purple-700 transition-colors",children:b.user_name}),e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:e.jsxs("span",{className:"font-medium text-gray-700",children:[v(b.month)," ",b.year]})})]})]}),e.jsxs("div",{className:"flex items-center gap-8 text-right",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-medium",children:"Net Payable"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:w(b.net_share)})]}),e.jsxs("div",{className:"pl-4 border-l border-gray-100 flex flex-col items-center justify-center gap-2",children:[A(b.payment_status),e.jsxs("button",{className:"px-4 py-1.5 bg-purple-50 hover:bg-purple-100 text-purple-600 rounded-md text-xs font-semibold border border-purple-200 transition-colors flex items-center gap-1 group-hover:bg-purple-600 group-hover:text-white group-hover:border-purple-600",children:["Lihat Detail ",e.jsx(ke,{size:14})]})]})]})]},`${b.user_id}-${b.month}-${b.year}-${_}`))})]})]})},Qr=()=>{const[r,t]=h.useState([]),[a,s]=h.useState(""),[l,i]=h.useState(!0);h.useEffect(()=>{n()},[]);const n=async()=>{i(!0);try{const d=await R.get("/creators");Array.isArray(d.data)?t(d.data):d.data&&d.data.data&&t(d.data.data)}catch(d){console.error("Failed to fetch creators",d)}finally{i(!1)}},o=r.filter(d=>d.name.toLowerCase().includes(a.toLowerCase())||d.nik&&d.nik.includes(a));return e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Pencipta Saya"})}),e.jsxs("div",{className:"glass-panel",children:[e.jsx("div",{className:"p-4 border-b border-white/30",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari nama atau NIK...",className:"glass-input pl-10",value:a,onChange:d=>s(d.target.value)}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nama"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"NIK"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tgl Lahir"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alamat"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:l?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):o.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"No creators found"})}):o.map((d,p)=>e.jsxs("tr",{className:p%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.nik||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.birth_date?new Date(d.birth_date).toLocaleDateString("en-GB"):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:d.address||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"Lihat Data",children:e.jsx(ze,{size:18})})})})]},d.id))})]})})]})]})},Zr=()=>{const[r,t]=h.useState([]),[a,s]=h.useState(!0),[l,i]=h.useState(""),[n,o]=h.useState(1),[d,p]=h.useState(20);h.useEffect(()=>{m()},[]);const m=async()=>{s(!0);try{const g=await R.get("/songs");Array.isArray(g.data)?t(g.data):g.data&&g.data.data&&t(g.data.data)}catch(g){console.error("Failed to fetch songs",g)}finally{s(!1)}},c=r.filter(g=>g.title.toLowerCase().includes(l.toLowerCase())||g.performer&&g.performer.toLowerCase().includes(l.toLowerCase())),x=Math.ceil(c.length/d),k=(n-1)*d,N=c.slice(k,k+d);return e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Data Lagu Saya"})}),e.jsxs("div",{className:"glass-panel",children:[e.jsxs("div",{className:"p-4 border-b border-white/30 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{type:"text",placeholder:"Cari lagu...",className:"glass-input pl-10 w-full",value:l,onChange:g=>{i(g.target.value),o(1)}}),e.jsx(le,{className:"absolute left-3 top-2.5 text-gray-400",size:20})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Show:"}),e.jsxs("select",{value:d,onChange:g=>{p(Number(g.target.value)),o(1)},className:"glass-input py-1 px-2 text-sm w-20",children:[e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"}),e.jsx("option",{value:50,children:"50"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200/50",children:[e.jsx("thead",{className:"bg-purple-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Judul"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Artis"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pencipta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-transparent divide-y divide-gray-200/50",children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading..."})}):N.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:"Tidak ada lagu ditemukan"})}):N.map((g,y)=>e.jsxs("tr",{className:y%2===0?"bg-white/50":"bg-white/30",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:g.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.performer||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-normal text-sm text-gray-500",children:g.writers&&g.writers.length>0?g.writers.map(w=>w.name).join(", "):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full uppercase
                          ${(g.status||"pending")==="accepted"?"bg-green-100 text-green-800":(g.status||"pending")==="review"?"bg-yellow-100 text-yellow-800":(g.status||"pending")==="rejected"?"bg-red-100 text-red-800":"bg-orange-100 text-orange-800"}`,children:g.status||"pending"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("div",{className:"flex items-center justify-end gap-2",children:e.jsx("button",{className:"text-purple-600 hover:text-purple-900 p-1 rounded-md hover:bg-purple-50 transition-colors",title:"Lihat Detail",children:e.jsx(ze,{size:18})})})})]},g.id))})]})}),x>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-white/30 flex items-center justify-between bg-white/20",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",e.jsx("span",{className:"font-medium",children:k+1})," to ",e.jsx("span",{className:"font-medium",children:Math.min(k+d,c.length)})," of ",e.jsx("span",{className:"font-medium",children:c.length})," results"]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>o(g=>Math.max(g-1,1)),disabled:n===1,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),Array.from({length:Math.min(5,x)},(g,y)=>y+1).map(g=>e.jsx("button",{onClick:()=>o(g),className:`px-3 py-1 border rounded-md ${n===g?"bg-purple-600 text-white border-purple-600":"bg-white text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:g},g)),e.jsx("button",{onClick:()=>o(g=>Math.min(g+1,x)),disabled:n===x,className:"px-3 py-1 border border-gray-300 rounded-md bg-white text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]})]})},ei=()=>{var k;const[r,t]=h.useState(null),[a,s]=h.useState(!0),[l,i]=h.useState(!1),[n,o]=h.useState({email:"",password:"",confirmPassword:""}),[d,p]=h.useState(null);h.useEffect(()=>{m()},[]);const m=async()=>{try{const N=await R.get("/auth/me");t(N.data),o(g=>({...g,email:N.data.email}))}catch(N){console.error("Failed to fetch user",N)}finally{s(!1)}},c=N=>{o({...n,[N.target.name]:N.target.value})},x=async N=>{var g,y;if(N.preventDefault(),p(null),n.password&&n.password!==n.confirmPassword){p({type:"error",text:"Password confirmation does not match"});return}i(!0);try{const w={email:n.email};n.password&&(w.password=n.password),await R.put("/auth/update-profile",w),p({type:"success",text:"Profile updated successfully"}),m(),o(A=>({...A,password:"",confirmPassword:""}))}catch(w){p({type:"error",text:((y=(g=w.response)==null?void 0:g.data)==null?void 0:y.message)||"Failed to update profile"})}finally{i(!1)}};return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(ut,{className:"w-8 h-8 animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Akun Saya"})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-2xl font-bold",children:(k=r==null?void 0:r.name)==null?void 0:k.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:r==null?void 0:r.name}),e.jsx("p",{className:"text-gray-500 capitalize",children:r==null?void 0:r.role})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:x,className:"space-y-6 max-w-2xl",children:[d&&e.jsx("div",{className:`p-4 rounded-lg ${d.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:d.text}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-600 capitalize",children:r==null?void 0:r.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Percentage Share"}),e.jsxs("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-600",children:[r==null?void 0:r.percentage_share,"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Joined Date"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-200 rounded-lg text-gray-600",children:new Date(r==null?void 0:r.created_at).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"})})]})]}),e.jsx("hr",{className:"border-gray-100"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Profile"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ba,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"email",name:"email",value:n.email,onChange:c,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Password ",e.jsx("span",{className:"text-gray-400 font-normal",children:"(Optional)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Gt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"password",name:"password",value:n.password,onChange:c,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Leave blank to keep current"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(Gt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"password",name:"confirmPassword",value:n.confirmPassword,onChange:c,className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Confirm new password"})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{type:"submit",disabled:l,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:l?e.jsxs(e.Fragment,{children:[e.jsx(ut,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})})]})})]})]})},ga=({title:r})=>e.jsxs("div",{className:"flex flex-col items-center justify-center h-[calc(100vh-10rem)] text-center p-6",children:[e.jsx("div",{className:"bg-purple-50 p-6 rounded-full mb-6 animate-pulse",children:e.jsx(_s,{size:64,className:"text-[#7A4A88]"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:r}),e.jsx("p",{className:"text-gray-500 max-w-md",children:"Fitur ini sedang dalam tahap pengembangan (Under Construction). Kami sedang bekerja keras untuk segera menghadirkan fitur ini."}),e.jsxs("div",{className:"mt-8 flex gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-300 animate-bounce",style:{animationDelay:"0s"}}),e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-300 animate-bounce",style:{animationDelay:"0.2s"}}),e.jsx("span",{className:"w-2 h-2 rounded-full bg-purple-300 animate-bounce",style:{animationDelay:"0.4s"}})]})]}),ti=()=>{const r=()=>{window.location.href="/"};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white/10 backdrop-blur-lg rounded-2xl p-8 text-center shadow-2xl border border-white/20",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"p-4 bg-red-500/20 rounded-full animate-pulse",children:e.jsx(As,{size:48,className:"text-red-400"})})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-4",children:"System Offline"}),e.jsx("p",{className:"text-gray-300 mb-8 leading-relaxed",children:"We're currently unable to connect to our servers. This could be due to scheduled maintenance or a temporary network issue."}),e.jsxs("div",{className:"bg-white/5 rounded-lg p-4 mb-8 text-left border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-400 mb-2",children:[e.jsx(xt,{size:16}),e.jsx("span",{children:"Connection Status:"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-ping"}),e.jsx("span",{className:"text-red-400 font-medium",children:"Disconnected"})]})]}),e.jsxs("button",{onClick:r,className:"w-full bg-blue-600 hover:bg-blue-500 text-white font-semibold py-3 px-6 rounded-xl transition-all duration-200 flex items-center justify-center gap-2 group shadow-lg shadow-blue-500/20",children:[e.jsx(Ps,{size:20,className:"group-hover:rotate-180 transition-transform duration-500"}),"Try Again"]}),e.jsx("p",{className:"mt-6 text-xs text-gray-500",children:"If the problem persists, please contact support."})]})})};function ai(){return h.useEffect(()=>{(async()=>{try{const t=await R.get("/settings");if(t.data&&(t.data.company_name&&(document.title=t.data.company_name),t.data.app_icon)){const a=document.querySelector("link[rel*='icon']")||document.createElement("link");a.type="image/x-icon",a.rel="shortcut icon";const l="http://localhost:5000/api".replace("/api","");if(t.data.app_icon.startsWith("http"))a.href=t.data.app_icon;else{const i=t.data.app_icon.replace(/\\/g,"/");a.href=i.startsWith("uploads/")?`/${i}`:`/uploads/${i}`}document.getElementsByTagName("head")[0].appendChild(a)}}catch(t){console.error("Failed to fetch settings for title/icon",t)}})()},[]),e.jsxs(as,{children:[e.jsx($,{path:"/maintenance",element:e.jsx(ti,{})}),e.jsx($,{path:"/login",element:e.jsx(Us,{})}),e.jsx($,{path:"/register",element:e.jsx(Ws,{})}),e.jsxs($,{path:"/admin",element:e.jsx(Ys,{}),children:[e.jsx($,{index:!0,element:e.jsx(Xs,{})}),e.jsx($,{path:"songs",element:e.jsx(Ks,{})}),e.jsx($,{path:"songs/create",element:e.jsx(Vt,{})}),e.jsx($,{path:"songs/edit/:id",element:e.jsx(Vt,{})}),e.jsx($,{path:"creators",element:e.jsx(Js,{})}),e.jsx($,{path:"creators/add",element:e.jsx(xa,{})}),e.jsx($,{path:"creators/edit/:id",element:e.jsx(xa,{})}),e.jsx($,{path:"analytics",element:e.jsx(ua,{})}),e.jsx($,{path:"reports",element:e.jsx(pa,{})}),e.jsx($,{path:"reports/import",element:e.jsx(Xr,{})}),e.jsx($,{path:"payments",element:e.jsx(Gr,{})}),e.jsx($,{path:"payments/:userId",element:e.jsx(qr,{})}),e.jsx($,{path:"contracts",element:e.jsx(ga,{title:"Kontrak User"})}),e.jsx($,{path:"users",element:e.jsx(Kr,{})}),e.jsx($,{path:"settings",element:e.jsx(Hr,{})})]}),e.jsxs($,{path:"/user",element:e.jsx(Hs,{}),children:[e.jsx($,{index:!0,element:e.jsx(Yr,{})}),e.jsx($,{path:"creators",element:e.jsx(Qr,{})}),e.jsx($,{path:"songs",element:e.jsx(Zr,{})}),e.jsx($,{path:"analytics",element:e.jsx(ua,{})}),e.jsx($,{path:"reports",element:e.jsx(pa,{})}),e.jsx($,{path:"payments",element:e.jsx(Jr,{})}),e.jsx($,{path:"payments/:userId",element:e.jsx(Vr,{})}),e.jsx($,{path:"contracts",element:e.jsx(ga,{title:"Kontrak"})}),e.jsx($,{path:"account",element:e.jsx(ei,{})})]}),e.jsx($,{path:"/",element:e.jsx(Ve,{to:"/login",replace:!0})})]})}gt.createRoot(document.getElementById("root")).render(e.jsx($e.StrictMode,{children:e.jsx(ss,{children:e.jsx(Fs,{children:e.jsx(ai,{})})})}));
